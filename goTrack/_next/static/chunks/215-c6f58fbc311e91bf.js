(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[215],{285:(e,t,a)=>{"use strict";a.d(t,{$:()=>d});var s=a(5155),n=a(2115),r=a(9708),l=a(2085),i=a(9434);let o=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),d=n.forwardRef((e,t)=>{let{className:a,variant:n,size:l,asChild:d=!1,...c}=e,u=d?r.DX:"button";return(0,s.jsx)(u,{className:(0,i.cn)(o({variant:n,size:l,className:a})),ref:t,...c})});d.displayName="Button"},1593:(e,t,a)=>{"use strict";async function s(e,t,a){if(!t)throw Error("API key is required");let s=[...a,{role:"user",parts:[{text:e}]}];try{var n,r,l,i,o,d;let e=await fetch("https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=".concat(t),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:s})}),a=await e.json();if(!e.ok){let e=(null==a||null==(o=a.error)?void 0:o.message)||"An unknown API error occurred.";if(e.includes("API key not valid"))throw Error("Invalid API Key. Please check it in the settings.");throw Error("API Error: ".concat(e))}let c=null==a||null==(r=a.candidates)||null==(n=r[0])?void 0:n.content;if(!c){let e=null==a||null==(d=a.promptFeedback)?void 0:d.blockReason;if(e)throw Error("Content blocked by API for reason: ".concat(e,"."));throw console.error("Invalid API response format:",a),Error("The AI did not return a valid response. Please try again.")}let u=null==(i=c.parts)||null==(l=i[0])?void 0:l.text;if(!u)return console.error("No text found in response parts:",c),null;return u}catch(e){throw console.error("Error calling Gemini API:",e),e}}async function n(e,t){if(!t)throw Error("API key is required");let a='You are an AI task planner.\n**Output rules:**\n- Use a hierarchical JSON structure.\n- Maximum depth: **{N} level(s)**.\n  - Level 1: Direct subtasks of the main task.\n  - Each subtask may have its own `"subtasks"` array containing further breakdowns.\n  - Continue breaking down subtasks until the maximum depth is reached.\n- If depth is not specified, max depth is 1.\n- Any task at the maximum depth must have `"subtasks": []`.\n- Do **not** repeat the main task as a subtask.\n- The output must start with a `"tasks"` array — do not wrap the main task in it.\n- **Output valid JSON only** — no markdown or commentary. Do not wrap your answer with ```json.\n\n**Example structure (generic for depth = 3):**\n{\n  "tasks": [\n    {\n      "title": "Subtask 1",\n      "subtasks": [\n        {\n          "title": "Sub-subtask 1.1",\n          "subtasks": [\n            {\n              "title": "Sub-sub-subtask 1.1.1",\n              "subtasks": []\n            }\n          ]\n        }\n      ]\n    }\n  ]\n} \n'.concat(e,"\n");console.log(a);try{var s,n,r,l,i,o;let e=await fetch("https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=".concat(t),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:a}]}],generationConfig:{temperature:.7,topK:40,topP:.95}})}),d=await e.json();if(!e.ok){let e=(null==d||null==(i=d.error)?void 0:i.message)||"An unknown API error occurred.";if(e.includes("API key not valid"))throw Error("Invalid API Key. Please check it in the settings.");throw Error("API Error: ".concat(e))}let c=null==d||null==(n=d.candidates)||null==(s=n[0])?void 0:s.content;if(!c){let e=null==d||null==(o=d.promptFeedback)?void 0:o.blockReason;if(e)throw Error("Content blocked by API for reason: ".concat(e,"."));throw console.error("Invalid API response format:",d),Error("The AI did not return a valid response. Please try again.")}let u=null==(l=c.parts)||null==(r=l[0])?void 0:r.text;if(!u)return console.error("No text found in response parts:",c),null;try{let e=u.match(/(\{[\s\S]*\})/),t=e?e[1]:u;return JSON.parse(t)}catch(e){return console.error("Failed to parse JSON from response:",u,e),null}}catch(e){throw console.error("Error calling Gemini API:",e),e}}async function r(e){if(!e)return!1;try{var t;let a=await fetch("https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=".concat(e),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:"Hello"}]}]})}),s=await a.json();if(a.ok)return!0;return((null==s||null==(t=s.error)?void 0:t.message)||"").includes("API key not valid"),!1}catch(e){return console.error("Error verifying API key:",e),!1}}a.d(t,{N3:()=>r,s$:()=>n,zv:()=>s})},2523:(e,t,a)=>{"use strict";a.d(t,{p:()=>l});var s=a(5155),n=a(2115),r=a(9434);let l=n.forwardRef((e,t)=>{let{className:a,type:n,...l}=e;return(0,s.jsx)("input",{type:n,className:(0,r.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...l})});l.displayName="Input"},2730:(e,t,a)=>{"use strict";a.d(t,{r:()=>f});var s=a(5453),n=a(6786),r=a(1368),l=a(1593);let i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a="  ".repeat(t),s="".concat(a,"- ").concat(e.title,"\n");for(let a of e.children)s+=i(a,t+1);return s},o=(e,t)=>{for(let a of e){if(a.id===t)return a;if(a.children.length>0){let e=o(a.children,t);if(e)return e}}return null},d=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;for(let s of e){if(s.id===t)return{task:s,parent:a};if(s.children.length>0){let e=d(s.children,t,s);if(e)return e}}return null},c=(e,t)=>{if(!t.parentId)return t;let a=t;for(;a.parentId;){let t=d(e,a.parentId);if(!t)break;if(!t.parent)return t.task;a=t.parent}return a},u=(e,t)=>e.filter(e=>e.id!==t&&(e.children=u(e.children,t),!0)),h={"Learn a Programming Language":[{id:(0,r.A)(),title:"Learn the Basics",status:"pending",collapsed:!1,createdAt:new Date,updatedAt:new Date,children:[{id:(0,r.A)(),title:"Set up development environment",status:"pending",collapsed:!1,createdAt:new Date,updatedAt:new Date,children:[]},{id:(0,r.A)(),title:"Learn syntax fundamentals",status:"pending",collapsed:!1,createdAt:new Date,updatedAt:new Date,children:[]}]},{id:(0,r.A)(),title:"Build Projects",status:"pending",collapsed:!1,createdAt:new Date,updatedAt:new Date,children:[{id:(0,r.A)(),title:"Simple utility program",status:"pending",collapsed:!1,createdAt:new Date,updatedAt:new Date,children:[]},{id:(0,r.A)(),title:"Small application",status:"pending",collapsed:!1,createdAt:new Date,updatedAt:new Date,children:[]}]}],"Start a Fitness Routine":[{id:(0,r.A)(),title:"Set Fitness Goals",status:"pending",collapsed:!1,createdAt:new Date,updatedAt:new Date,children:[{id:(0,r.A)(),title:"Define specific measurable targets",status:"pending",collapsed:!1,createdAt:new Date,updatedAt:new Date,children:[]},{id:(0,r.A)(),title:"Set realistic timeline",status:"pending",collapsed:!1,createdAt:new Date,updatedAt:new Date,children:[]}]},{id:(0,r.A)(),title:"Create Workout Plan",status:"pending",collapsed:!1,createdAt:new Date,updatedAt:new Date,children:[{id:(0,r.A)(),title:"Choose exercise types",status:"pending",collapsed:!1,createdAt:new Date,updatedAt:new Date,children:[]},{id:(0,r.A)(),title:"Schedule workout days",status:"pending",collapsed:!1,createdAt:new Date,updatedAt:new Date,children:[]}]}]},f=(0,s.v)()((0,n.Zr)((e,t)=>({tasks:[],templates:h,collapsedState:{},apiKey:"",lastBreakdown:null,recentlyAddedTaskIds:[],scrollToTaskId:null,activeChatTask:null,chatConversations:{},deletedTasksHistory:[],setActiveChatTask:t=>e({activeChatTask:t}),setChatConversation:(t,a)=>{e(e=>({chatConversations:{...e.chatConversations,[t]:a}}))},setRecentlyAddedTaskIds:t=>{e({recentlyAddedTaskIds:t})},setScrollToTaskId:t=>e({scrollToTaskId:t}),addTask:t=>{let a={id:(0,r.A)(),...t,children:[],collapsed:!1,createdAt:new Date,updatedAt:new Date};e(e=>({tasks:[...e.tasks,a],lastBreakdown:null,recentlyAddedTaskIds:[a.id]}))},addSubtask:(t,a)=>{let s={id:(0,r.A)(),...a,children:[],collapsed:!1,parentId:t,createdAt:new Date,updatedAt:new Date};return e(e=>{let a=e=>e.map(e=>e.id===t?{...e,children:[...e.children,s]}:e.children.length>0?{...e,children:a(e.children)}:e);return{tasks:a(e.tasks),lastBreakdown:null,recentlyAddedTaskIds:[s.id]}}),s},updateTask:(t,a)=>{e(e=>{let s=e=>e.map(e=>e.id===t?{...e,...a,updatedAt:new Date}:e.children.length>0?{...e,children:s(e.children)}:e);return{tasks:s(e.tasks),lastBreakdown:null}})},deleteTask:t=>{e(e=>{let a=o(e.tasks,t),s=null;a&&a.parentId&&(s=a.parentId);let n=u(e.tasks,t),r=e.activeChatTask;return e.activeChatTask&&e.activeChatTask.id===t&&(r=null),{tasks:n,lastBreakdown:null,activeChatTask:r,deletedTasksHistory:a?[...e.deletedTasksHistory,{task:a,parentId:s}]:e.deletedTasksHistory}})},toggleTaskStatus:e=>{let{findTask:a}=t(),s=a(e);if(s){let a="completed"===s.status?"pending":"completed";t().updateTask(e,{status:a})}},toggleCollapsed:t=>{e(e=>{let a=e=>e.map(e=>e.id===t?{...e,collapsed:!e.collapsed}:e.children.length>0?{...e,children:a(e.children)}:e);return{tasks:a(e.tasks)}})},reorderTasks:t=>{e(()=>({tasks:t,lastBreakdown:null}))},moveTask:(a,s,n)=>{e(e=>{let r=t().findTaskAndParent(a);if(!r)return e;let{task:l,parent:i}=r,o={...l},d=u(e.tasks,a);if(!s)return{tasks:d=[...d.slice(0,n),o,...d.slice(n)],lastBreakdown:null};let c=e=>e.map(e=>{if(e.id===s){o.parentId=e.id;let t=[...e.children.slice(0,n),o,...e.children.slice(n)];return{...e,children:t}}return e.children.length>0?{...e,children:c(e.children)}:e});return{tasks:c(d),lastBreakdown:null}})},setApiKey:t=>{e({apiKey:t})},findTask:e=>o(t().tasks,e),findTaskAndParent:e=>d(t().tasks,e),getTaskBreadcrumb:e=>{let a=(e,t,s)=>{for(let n of e){let e=[...s,n.title];if(n.id===t)return e;if(n.children.length>0){let s=a(n.children,t,e);if(s)return s}}return null},s=a(t().tasks,e,[]);return s?s.join(" > "):""},getMainTask:e=>c(t().tasks,e),setLastBreakdown:(t,a)=>{e({lastBreakdown:{parentId:t,addedIds:a}})},clearLastBreakdown:()=>{e({lastBreakdown:null})},undoLastBreakdown:()=>{e(e=>{if(!e.lastBreakdown)return e;let{parentId:t,addedIds:a}=e.lastBreakdown,s=e=>e.map(e=>e.id===t?{...e,children:e.children.filter(e=>!a.includes(e.id))}:e.children.length>0?{...e,children:s(e.children)}:e);return{tasks:s(e.tasks),lastBreakdown:null}})},undoLastDeletion:()=>{e(e=>{let t=e.deletedTasksHistory.pop();if(!t)return e;let{task:a,parentId:s}=t,n=e=>null===s?[...e,a]:e.map(e=>e.id===s?{...e,children:[...e.children,a]}:e.children.length>0?{...e,children:n(e.children)}:e);return{tasks:n(e.tasks),deletedTasksHistory:[...e.deletedTasksHistory],activeChatTask:a}})},breakdownTaskWithAI:async(e,a)=>{let{apiKey:s,findTask:n,getTaskBreadcrumb:r,addSubtask:o,setLastBreakdown:d,setRecentlyAddedTaskIds:c,getMainTask:u,chatConversations:h}=t(),f=n(e);if(!s)return{success:!1,message:"Please add an API key in the settings to use AI features."};if(!f)return{success:!1,message:"Task not found."};let p=u(f);if(!p)return{success:!1,message:"Could not find the main task."};let m="For context, here is the entire task tree that the current task belongs to:\n".concat(i(p)," \n\nDo not repeat tasks already mentioned, If you must repeat for clarity, make the subtask more specific or add new details.\n\n"),g="This is the task or goal : ".concat(r(e)),x=f.children.length>0?"Please do not generate the following tasks as they already exist: ".concat(f.children.map(e=>'"'.concat(e.title,'"')).join(", "),"."):"",k=u(f),v=k?h[k.id]:[],y=null==v?void 0:v.map(e=>"".concat(e.role,": ").concat(e.text)).join("\n"),w="".concat(m).concat("Break down the following goal or task into clear, actionable subtasks. Make the subtasks as detailed as needed to complete the goal. Subtasks should be specific actions, not vague ideas. Avoid repeating tasks at different levels. Use concise phrasing."," ").concat(g,". ").concat(a?"(Additional Context: ".concat(a,")."):""," ").concat(y?"(Chat History: ".concat(y,")."):""," ").concat(x," Use the same language as the task.");try{let t=await (0,l.s$)(w,s);if(!t||!(t.tasks.length>0))return{success:!0,message:"The AI didn't generate any tasks for \"".concat(f.title,'".')};{console.log(t);let a=new Set(f.children.map(e=>e.title.trim().toLowerCase())),s=t.tasks.filter(e=>!a.has(e.title.trim().toLowerCase()));if(0===s.length)return{success:!0,message:'No new unique tasks were generated for "'.concat(f.title,'".')};let n=[],r=(e,t)=>{for(let a of t){let t=o(e,{title:a.title,status:"pending"});n.push(t.id),a.subtasks&&a.subtasks.length>0&&r(t.id,a.subtasks)}};return r(e,s),d(e,n),c(n),{success:!0,message:'Generated new subtasks for "'.concat(f.title,'".')}}}catch(e){if(console.error("AI generation failed:",e),e instanceof Error)return{success:!1,message:e.message};return{success:!1,message:"An unknown error occurred. Please try again."}}}}),{name:"todo-storage"}))},4165:(e,t,a)=>{"use strict";a.d(t,{Cf:()=>h,Es:()=>p,L3:()=>m,c7:()=>f,lG:()=>o,rr:()=>g,zM:()=>d});var s=a(5155),n=a(2115),r=a(5452),l=a(5318),i=a(9434);let o=r.bL,d=r.l9,c=r.ZL;r.bm;let u=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(r.hJ,{ref:t,className:(0,i.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...n})});u.displayName=r.hJ.displayName;let h=n.forwardRef((e,t)=>{let{className:a,children:n,...o}=e;return(0,s.jsxs)(c,{children:[(0,s.jsx)(u,{}),(0,s.jsxs)(r.UC,{ref:t,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...o,children:[n,(0,s.jsxs)(r.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(l.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});h.displayName=r.UC.displayName;let f=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...a})};f.displayName="DialogHeader";let p=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};p.displayName="DialogFooter";let m=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(r.hE,{ref:t,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",a),...n})});m.displayName=r.hE.displayName;let g=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(r.VY,{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",a),...n})});g.displayName=r.VY.displayName},7313:(e,t,a)=>{"use strict";a.d(t,{Xi:()=>d,av:()=>c,j7:()=>o,tU:()=>i});var s=a(5155),n=a(2115),r=a(9669),l=a(9434);let i=r.bL,o=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(r.B8,{ref:t,className:(0,l.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a),...n})});o.displayName=r.B8.displayName;let d=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(r.l9,{ref:t,className:(0,l.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a),...n})});d.displayName=r.l9.displayName;let c=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(r.UC,{ref:t,className:(0,l.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),...n})});c.displayName=r.UC.displayName},7528:()=>{},9215:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>U});var s=a(5155),n=a(2115),r=a(9434);let l=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,r.cn)("rounded-xl border bg-card text-card-foreground shadow",a),...n})});l.displayName="Card";let i=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",a),...n})});i.displayName="CardHeader";let o=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,r.cn)("font-semibold leading-none tracking-tight",a),...n})});o.displayName="CardTitle",n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,r.cn)("text-sm text-muted-foreground",a),...n})}).displayName="CardDescription";let d=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,r.cn)("p-6 pt-0",a),...n})});d.displayName="CardContent",n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,r.cn)("flex items-center p-6 pt-0",a),...n})}).displayName="CardFooter";var c=a(285),u=a(2523),h=a(2730);function f(){let{addTask:e}=(0,h.r)(),[t,a]=(0,n.useState)(""),r=()=>{t.trim()&&(e({title:t,status:"pending"}),a(""))};return(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(u.p,{placeholder:"Enter a new goal...",value:t,onChange:e=>a(e.target.value),onKeyDown:e=>{"Enter"===e.key&&r()},className:"flex-1"}),(0,s.jsx)(c.$,{onClick:r,disabled:!t.trim(),children:"Create Goal"})]})}var p=a(5143),m=a(402),g=a(1206),x=a(8266),k=a(7820),v=a(518);let y=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)(k.bL,{ref:t,className:(0,r.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...n,children:(0,s.jsx)(k.C1,{className:(0,r.cn)("flex items-center justify-center text-current"),children:(0,s.jsx)(v.A,{className:"h-4 w-4"})})})});y.displayName=k.bL.displayName;var w=a(3096),b=a(295),j=a(3158),A=a(9556),N=a(5943),C=a(8046),T=a(9829),I=a(7223),S=a(1593),D=a(4165);let P=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("textarea",{className:(0,r.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...n})});P.displayName="Textarea";var E=a(6671);function R(e){let{task:t,level:a,addSubtask:l,aiBreakdown:i,setActiveTab:o}=e,{toggleTaskStatus:d,toggleCollapsed:f,updateTask:p,deleteTask:g,apiKey:k,recentlyAddedTaskIds:v,setRecentlyAddedTaskIds:R,setActiveChatTask:B,undoLastDeletion:$}=(0,h.r)(),[z,L]=(0,n.useState)(!1),[F,O]=(0,n.useState)(t.title),[U,G]=(0,n.useState)(!1),[K,H]=(0,n.useState)(""),[J,M]=(0,n.useState)(!1),[_,q]=(0,n.useState)(!1),[V,W]=(0,n.useState)("");(0,n.useEffect)(()=>{if(v.includes(t.id)){let e=setTimeout(()=>{R([])},2e3);return()=>clearTimeout(e)}},[v,t.id,R]);let{attributes:Y,listeners:X,setNodeRef:Z,transform:Q,transition:ee,isDragging:et}=(0,m.gl)({id:t.id}),ea={transform:x.Ks.Transform.toString(Q),transition:ee,opacity:et?.5:1},es=()=>{F.trim()&&p(t.id,{title:F}),L(!1)},en=()=>{K.trim()&&(l(t.id,K),H(""),G(!1),t.collapsed&&f(t.id))},er=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!k)return void E.oR.error("Please add an API key in the settings to use AI features.");try{M(!0),q(!1);let a=e?V.trim():void 0;if(i)await i(t.id,t.title,a);else try{let e=a?"".concat(t.title," (Context: ").concat(a,")"):t.title,s=await (0,S.s$)(e,k);s&&s.tasks.length>0?(s.tasks.forEach(e=>{l(t.id,e.title)}),E.oR.success('Generated new subtasks for "'.concat(t.title,'".'))):E.oR.info("The AI didn't generate any tasks for \"".concat(t.title,'".'))}catch(e){console.error("AI generation failed:",e),e instanceof Error?E.oR.error(e.message):E.oR.error("An unknown error occurred. Please try again.")}t.collapsed&&f(t.id)}finally{M(!1)}},el=t.children.length>0,ei="completed"===t.status,eo=24*a;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(D.lG,{open:_,onOpenChange:q,children:(0,s.jsxs)(D.Cf,{className:"sm:max-w-md",children:[(0,s.jsxs)(D.c7,{children:[(0,s.jsx)(D.L3,{children:"Add Context for AI"}),(0,s.jsxs)(D.rr,{children:['Provide any additional context for "',t.title,'" to help the AI generate more relevant tasks. This is optional.']})]}),(0,s.jsx)("div",{className:"grid gap-4 py-4",children:(0,s.jsx)(P,{placeholder:"e.g., This is for a personal fitness plan\nI prefer home workouts and have limited equipment...\n2 levels with 3 tasks each",className:"min-h-[100px]",value:V,onChange:e=>W(e.target.value)})}),(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsx)(c.$,{variant:"outline",onClick:()=>W(e=>e.includes("Use multiple levels")?e:e+"\nUse multiple levels if necessary — up to N levels deep with 2–4 branches per level."),children:"Multi level and branches"})}),(0,s.jsxs)(D.Es,{children:[(0,s.jsx)(c.$,{variant:"outline",onClick:()=>er(!1),disabled:J,children:"Skip Context"}),(0,s.jsx)(c.$,{onClick:()=>er(!0),disabled:J,children:"Use Context"})]})]})}),(0,s.jsxs)("div",{ref:Z,style:ea,className:(0,r.cn)("group relative mb-1 rounded-md",et&&"z-10",v.includes(t.id)&&"bg-yellow-100 dark:bg-yellow-900/50 animate-pulse"),children:[(0,s.jsxs)("div",{className:(0,r.cn)("flex items-center gap-2 rounded-md border p-2 transition-colors hover:bg-muted/40",ei&&"bg-muted/30",0===a&&"bg-blue-100 dark:bg-blue-900/50"),style:{paddingLeft:"".concat(eo+8,"px")},children:[(0,s.jsx)("button",{className:"cursor-grab opacity-0 group-hover:opacity-100 focus:opacity-100",...Y,...X,children:(0,s.jsx)(b.A,{className:"h-4 w-4 text-muted-foreground"})}),el?(0,s.jsx)("button",{onClick:()=>{f(t.id)},className:"flex h-5 w-5 items-center justify-center rounded-sm hover:bg-muted",children:t.collapsed?(0,s.jsx)(j.A,{className:"h-4 w-4"}):(0,s.jsx)(A.A,{className:"h-4 w-4"})}):(0,s.jsx)("div",{className:"w-5"}),(0,s.jsx)(y,{id:"task-".concat(t.id),checked:ei,onCheckedChange:()=>{d(t.id)}}),z?(0,s.jsxs)("div",{className:"flex flex-1 items-center gap-2",children:[(0,s.jsx)(u.p,{value:F,onChange:e=>O(e.target.value),onKeyDown:e=>{"Enter"===e.key?es():"Escape"===e.key&&L(!1)},className:"flex-1",autoFocus:!0}),(0,s.jsx)(c.$,{size:"sm",onClick:es,children:"Save"}),(0,s.jsx)(c.$,{size:"sm",variant:"ghost",onClick:()=>L(!1),children:"Cancel"})]}):(0,s.jsx)("label",{htmlFor:"task-".concat(t.id),className:(0,r.cn)("flex-1 cursor-pointer select-none",ei&&"text-muted-foreground line-through"),children:t.title}),!z&&(0,s.jsxs)("div",{className:"flex gap-1 opacity-0 transition-opacity group-hover:opacity-100",children:[(0,s.jsx)(c.$,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>{L(!0),O(t.title)},title:"Edit",children:(0,s.jsx)(N.A,{className:"h-4 w-4"})}),(0,s.jsx)(c.$,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>G(!0),title:"Add subtask",children:(0,s.jsx)(C.A,{className:"h-4 w-4"})}),(0,s.jsx)(c.$,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>{B(t),o("chat")},title:"Start Chat",children:(0,s.jsx)(w.ywh,{className:"h-4 w-4"})}),(0,s.jsx)(c.$,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>{if(!k)return void E.oR.error("Please add an API key in the settings to use AI features.");W(""),q(!0)},disabled:J||!k,title:"AI breakdown",children:(0,s.jsx)(T.A,{className:(0,r.cn)("h-4 w-4",J&&"animate-pulse")})}),(0,s.jsx)(c.$,{variant:"ghost",size:"icon",className:"h-7 w-7 text-destructive hover:bg-destructive/10",onClick:()=>{g(t.id),(0,E.oR)('Task "'.concat(t.title,'" deleted.'),{action:{label:"Undo",onClick:()=>$()},duration:5e3})},title:"Delete",children:(0,s.jsx)(I.A,{className:"h-4 w-4"})})]})]}),U&&(0,s.jsxs)("div",{className:"ml-14 mt-1 flex items-center gap-2 rounded-md border p-2",style:{marginLeft:"".concat(eo+56,"px")},children:[(0,s.jsx)(u.p,{placeholder:"Enter subtask name...",value:K,onChange:e=>H(e.target.value),onKeyDown:e=>{"Enter"===e.key?en():"Escape"===e.key&&G(!1)},className:"flex-1",autoFocus:!0}),(0,s.jsx)(c.$,{size:"sm",onClick:en,children:"Add"}),(0,s.jsx)(c.$,{size:"sm",variant:"ghost",onClick:()=>G(!1),children:"Cancel"})]})]})]})}var B=a(172);function $(e){let{setActiveTab:t}=e,{tasks:a,addSubtask:r,reorderTasks:l,breakdownTaskWithAI:i,findTask:o,clearLastBreakdown:d,setRecentlyAddedTaskIds:c,scrollToTaskId:u,setScrollToTaskId:f}=(0,h.r)(),[x,k]=(0,n.useState)(null),[v,y]=(0,n.useState)(!1),w=(0,n.useRef)({});(0,n.useEffect)(()=>{if(u){let e=w.current[u];e&&(e.scrollIntoView({behavior:"auto",block:"center"}),f(null))}},[u,f]);let b=(0,p.FR)((0,p.MS)(p.AN,{activationConstraint:{distance:8}})),j=async(e,t,a)=>{y(!0);let s=await i(e,a);s.success?E.oR.success(s.message):E.oR.error(s.message),y(!1)},A=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.map(e=>(0,s.jsxs)("div",{style:{marginTop:0===a?"2rem":0},ref:t=>{t&&(w.current[e.id]=t)},children:[(0,s.jsx)(R,{task:e,level:a,addSubtask:(e,t)=>{"string"==typeof t?r(e,{title:t,status:"pending"}):r(e,t)},aiBreakdown:j,setActiveTab:t}),!e.collapsed&&e.children.length>0&&(0,s.jsx)("div",{children:(0,s.jsx)(m.gB,{items:e.children.map(e=>e.id),strategy:m._G,children:A(e.children,a+1)})})]},e.id))},N=x?o(x):null,C=a.map(e=>e.id);return(0,s.jsxs)(s.Fragment,{children:[v&&(0,s.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-background/80 z-50",children:(0,s.jsxs)("div",{className:"flex flex-col items-center gap-2 p-4 rounded-md bg-card border shadow-md",children:[(0,s.jsx)(B.A,{className:"h-8 w-8 animate-spin text-primary"}),(0,s.jsx)("p",{children:"Generating tasks with AI..."})]})}),(0,s.jsxs)(p.Mp,{sensors:b,collisionDetection:p.fp,onDragStart:e=>{k(e.active.id)},onDragOver:e=>{let{active:t,over:a}=e;if(!a||t.id===a.id)return;let s=t.id,n=a.id,r=o(s),l=o(n);if(!r||!l)return;let i=(e,t)=>e.id===t||e.children.some(e=>i(e,t));if(i(r,n))return},onDragEnd:e=>{k(null);let{active:t,over:s}=e;if(s){if(t.id!==s.id){let e=t.id,n=s.id,r=o(e),i=o(n);if(!r||!i)return;let d=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;for(let s=0;s<t.length;s++){if(t[s].id===e)return{parent:a,index:s};if(t[s].children.length>0){let a=d(e,t[s].children,t[s]);if(null!==a.parent)return a}}return{parent:null,index:-1}},{parent:c,index:u}=d(e,a),{parent:h,index:f}=d(n,a);if(c===h)if(null===c)l((0,m.be)(a,u,f));else{let e=(0,m.be)(c.children,u,f),t=(e,a,s)=>e.map(e=>e.id===a?{...e,children:s}:e.children&&e.children.length>0?{...e,children:t(e.children,a,s)}:e);l(t(a,c.id,e))}}d()}},modifiers:[g.FN],children:[(0,s.jsx)("div",{className:"space-y-1",children:0===a.length?(0,s.jsx)("div",{className:"rounded-md border border-dashed p-6 text-center text-muted-foreground",children:"No tasks yet. Create your first task below."}):(0,s.jsx)(m.gB,{items:C,strategy:m._G,children:A(a)})}),(0,s.jsx)(p.Hd,{children:x&&N&&(0,s.jsx)("div",{className:"w-full opacity-70",children:(0,s.jsx)(R,{task:N,level:0,addSubtask:()=>{}})})})]})]})}var z=a(7313),L=a(8240),F=a(4823);function O(e){let{setActiveTab:t}=e,[a,r]=(0,n.useState)(""),[u,f]=(0,n.useState)(!1),[p,m]=(0,n.useState)(!1),[g,x]=(0,n.useState)(!1),[k,v]=(0,n.useState)(""),y=(0,h.r)(e=>e.apiKey),w=(0,h.r)(e=>e.activeChatTask),b=(0,h.r)(e=>e.setActiveChatTask),j=(0,h.r)(e=>e.getMainTask),A=(0,h.r)(e=>e.chatConversations),N=(0,h.r)(e=>e.setChatConversation),C=(0,h.r)(e=>e.setScrollToTaskId),{breakdownTaskWithAI:T}=(0,h.r)(),I=(0,n.useRef)(null),R=()=>{var e;null==(e=I.current)||e.scrollIntoView({behavior:"auto"})};(0,n.useEffect)(()=>{R()},[A,w]);let $=async()=>{if(a.trim()&&w){let e=j(w);if(!e)return;let t=[...A[e.id]||[],{text:a,role:"user"}];N(e.id,t),r(""),f(!0);let s=t.map(e=>({role:e.role,parts:[{text:e.text}]}));try{let n=await (0,S.zv)(a,y,s);n&&N(e.id,[...t,{text:n,role:"model"}])}catch(a){console.error("Error chatting with AI:",a),N(e.id,[...t,{text:"Error: Could not connect to the AI.",role:"model"}])}finally{f(!1)}}},z=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!w)return;m(!0),x(!1);let a=e?k.trim():void 0,s=await T(w.id,a);s.success?(E.oR.success(s.message),t("tasks"),C(w.id)):E.oR.error(s.message),m(!1)},O=w?j(w):null,U=O&&A[O.id]||[];return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(D.lG,{open:g,onOpenChange:x,children:(0,s.jsxs)(D.Cf,{className:"sm:max-w-md",children:[(0,s.jsxs)(D.c7,{children:[(0,s.jsx)(D.L3,{children:"Add Context for AI"}),(0,s.jsxs)(D.rr,{children:['Provide any additional context for "',null==O?void 0:O.title,'" to help the AI generate more relevant tasks. This is optional.']})]}),(0,s.jsx)("div",{className:"grid gap-4 py-4",children:(0,s.jsx)(P,{placeholder:"e.g., This is for a personal fitness plan\nI prefer home workouts and have limited equipment...\n2 levels with 3 tasks each",className:"min-h-[100px]",value:k,onChange:e=>v(e.target.value)})}),(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsx)(c.$,{variant:"outline",onClick:()=>v(e=>e.includes("Use multiple levels")?e:e+"\nUse multiple levels if necessary — up to N levels deep with 2–4 branches per level."),children:"Multi level and branches"})}),(0,s.jsxs)(D.Es,{children:[(0,s.jsx)(c.$,{variant:"outline",onClick:()=>z(!1),disabled:p,children:"Skip Context"}),(0,s.jsx)(c.$,{onClick:()=>z(!0),disabled:p,children:"Use Context"})]})]})}),(0,s.jsxs)(l,{children:[(0,s.jsxs)(i,{className:"flex flex-row items-center justify-between",children:[(0,s.jsx)(o,{children:w?"Let's talk about the task: \"".concat(w.title,'". What would you like to discuss?'):"Chat with AI"}),w&&(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(c.$,{variant:"outline",onClick:()=>{if(!y)return void E.oR.error("Please add an API key in the settings to use AI features.");v(""),x(!0)},disabled:p,children:[p?(0,s.jsx)(B.A,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Breakdown Task"]}),(0,s.jsx)(c.$,{variant:"outline",onClick:()=>{if(w){let e=j(w);e&&N(e.id,[])}b(null)},children:"Clear Context"})]})]}),(0,s.jsxs)(d,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"h-96 overflow-y-auto rounded-md border p-4 space-y-2",children:[U.map((e,t)=>(0,s.jsx)("div",{className:"flex ".concat("user"===e.role?"justify-end":"justify-start"),children:(0,s.jsx)("div",{className:"rounded-lg px-4 py-2 ".concat("user"===e.role?"bg-primary text-primary-foreground":"bg-muted"),children:"user"===e.role?e.text:(0,s.jsx)(L.oz,{remarkPlugins:[F.A],children:e.text})})},t)),u&&(0,s.jsx)("div",{className:"flex justify-start",children:(0,s.jsx)("div",{className:"rounded-lg px-4 py-2 bg-muted",children:(0,s.jsxs)("div",{className:"typing-indicator",children:[(0,s.jsx)("span",{}),(0,s.jsx)("span",{}),(0,s.jsx)("span",{})]})})}),(0,s.jsx)("div",{ref:I})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(P,{value:a,onChange:e=>r(e.target.value),placeholder:"Type your message... (use Ctrl+Enter or Cmd+Enter to send)",onKeyDown:e=>{(e.ctrlKey||e.metaKey)&&"Enter"===e.key&&$()}}),(0,s.jsx)(c.$,{onClick:$,children:"Send"})]})]})]})]})}function U(e){let{activeTab:t,setActiveTab:a}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(z.av,{value:"tasks",style:{display:"tasks"===t?"block":"none"},children:(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)($,{setActiveTab:a}),(0,s.jsxs)(l,{children:[(0,s.jsx)(i,{children:(0,s.jsx)(o,{children:"Add a New Goal"})}),(0,s.jsx)(d,{children:(0,s.jsx)(f,{})})]})]})}),(0,s.jsx)(z.av,{value:"chat",style:{display:"chat"===t?"block":"none"},children:(0,s.jsx)(O,{setActiveTab:a})})]})}a(7528)},9434:(e,t,a)=>{"use strict";a.d(t,{cn:()=>r});var s=a(2596),n=a(9688);function r(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,n.QP)((0,s.$)(t))}}}]);