(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{5406:(e,t,s)=>{Promise.resolve().then(s.bind(s,9223))},9223:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>z});var a=s(5155),n=s(2115),r=s(9434);let i=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("rounded-xl border bg-card text-card-foreground shadow",s),...n})});i.displayName="Card";let l=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",s),...n})});l.displayName="CardHeader";let d=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("font-semibold leading-none tracking-tight",s),...n})});d.displayName="CardTitle",n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("text-sm text-muted-foreground",s),...n})}).displayName="CardDescription";let o=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("p-6 pt-0",s),...n})});o.displayName="CardContent",n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("flex items-center p-6 pt-0",s),...n})}).displayName="CardFooter";var c=s(285),u=s(2523),h=s(2730);function f(){let{addTask:e}=(0,h.r)(),[t,s]=(0,n.useState)(""),r=()=>{t.trim()&&(e({title:t,status:"pending"}),s(""))};return(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(u.p,{placeholder:"Enter a new goal...",value:t,onChange:e=>s(e.target.value),onKeyDown:e=>{"Enter"===e.key&&r()},className:"flex-1"}),(0,a.jsx)(c.$,{onClick:r,disabled:!t.trim(),children:"Create Goal"})]})}var m=s(5143),x=s(402),p=s(1206),g=s(8266),v=s(7820),j=s(518);let k=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)(v.bL,{ref:t,className:(0,r.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...n,children:(0,a.jsx)(v.C1,{className:(0,r.cn)("flex items-center justify-center text-current"),children:(0,a.jsx)(j.A,{className:"h-4 w-4"})})})});k.displayName=v.bL.displayName;var b=s(295),y=s(3158),N=s(9556),w=s(5943),C=s(8046),A=s(9829),S=s(7223);async function I(e,t){if(!t)throw Error("API key is required");try{var s,a,n,r;let i=await fetch("https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=".concat(t),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:'I need a breakdown for this goal: "'.concat(e,'".\n                  Create a structured task list with 2-4 main tasks, each with 2-3 subtasks.\n                  Format your response as JSON with this exact structure:\n                  {\n                    "tasks": [\n                      {\n                        "title": "Main task 1",\n                        "subtasks": [\n                          {\n                            "title": "Subtask 1.1",\n                            "subtasks": [\n                              { "title": "Sub-subtask 1.1.1" },\n                              { "title": "Sub-subtask 1.1.2" }\n                            ]\n                          },\n                          {\n                            "title": "Subtask 1.2",\n                            "subtasks": []\n                          }\n                        ]\n                      }\n                    ]\n                  }\n                  Only return valid JSON. No other text before or after.')}]}],generationConfig:{temperature:.7,topK:40,topP:.95,maxOutputTokens:1024}})}),l=await i.json(),d=null==l||null==(a=l.candidates)||null==(s=a[0])?void 0:s.content;if(!d)return console.error("Invalid API response format:",l),null;let o=null==(r=d.parts)||null==(n=r[0])?void 0:n.text;if(!o)return console.error("No text found in response parts:",d),null;try{let e=o.match(/(\{[\s\S]*\})/),t=e?e[1]:o;return JSON.parse(t)}catch(e){return console.error("Failed to parse JSON from response:",o,e),null}}catch(e){throw console.error("Error calling Gemini API:",e),e}}var E=s(4165);let P=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("textarea",{className:(0,r.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...n})});function F(e){let{task:t,level:s,addSubtask:i,aiBreakdown:l}=e,{toggleTaskStatus:d,toggleCollapsed:o,updateTask:f,deleteTask:m,apiKey:p}=(0,h.r)(),[v,j]=(0,n.useState)(!1),[F,O]=(0,n.useState)(t.title),[$,z]=(0,n.useState)(!1),[D,R]=(0,n.useState)(""),[T,_]=(0,n.useState)(!1),[G,J]=(0,n.useState)(!1),[K,L]=(0,n.useState)(""),{attributes:B,listeners:M,setNodeRef:q,transform:H,transition:U,isDragging:Q}=(0,x.gl)({id:t.id}),V={transform:g.Ks.Transform.toString(H),transition:U,opacity:Q?.5:1},W=()=>{F.trim()&&f(t.id,{title:F}),j(!1)},X=()=>{D.trim()&&(i(t.id,D),R(""),z(!1),t.collapsed&&o(t.id))},Y=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!p)return void alert("Please add an API key in the settings to use AI features.");try{_(!0),J(!1);let s=e?K.trim():void 0;if(l)await l(t.id,t.title,s);else try{let e=s?"".concat(t.title," (Context: ").concat(s,")"):t.title,a=await I(e,p);a&&a.tasks.length>0&&a.tasks.forEach(e=>{i(t.id,e.title)})}catch(e){console.error("AI generation failed:",e),alert("Failed to generate tasks. Please try again.")}t.collapsed&&o(t.id)}finally{_(!1)}},Z=t.children.length>0,ee="completed"===t.status,et=24*s;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(E.lG,{open:G,onOpenChange:J,children:(0,a.jsxs)(E.Cf,{className:"sm:max-w-md",children:[(0,a.jsxs)(E.c7,{children:[(0,a.jsx)(E.L3,{children:"Add Context for AI"}),(0,a.jsxs)(E.rr,{children:['Provide any additional context for "',t.title,'" to help the AI generate more relevant tasks. This is optional.']})]}),(0,a.jsx)("div",{className:"grid gap-4 py-4",children:(0,a.jsx)(P,{placeholder:"e.g., This is for a personal fitness plan; I prefer home workouts and have limited equipment...",className:"min-h-[100px]",value:K,onChange:e=>L(e.target.value)})}),(0,a.jsxs)(E.Es,{children:[(0,a.jsx)(c.$,{variant:"outline",onClick:()=>Y(!1),disabled:T,children:"Skip Context"}),(0,a.jsx)(c.$,{onClick:()=>Y(!0),disabled:T,children:"Use Context"})]})]})}),(0,a.jsxs)("div",{ref:q,style:V,className:(0,r.cn)("group relative mb-1 rounded-md",Q&&"z-10"),children:[(0,a.jsxs)("div",{className:(0,r.cn)("flex items-center gap-2 rounded-md border p-2 transition-colors hover:bg-muted/40",ee&&"bg-muted/30"),style:{paddingLeft:"".concat(et+8,"px")},children:[(0,a.jsx)("button",{className:"cursor-grab opacity-0 group-hover:opacity-100 focus:opacity-100",...B,...M,children:(0,a.jsx)(b.A,{className:"h-4 w-4 text-muted-foreground"})}),Z?(0,a.jsx)("button",{onClick:()=>{o(t.id)},className:"flex h-5 w-5 items-center justify-center rounded-sm hover:bg-muted",children:t.collapsed?(0,a.jsx)(y.A,{className:"h-4 w-4"}):(0,a.jsx)(N.A,{className:"h-4 w-4"})}):(0,a.jsx)("div",{className:"w-5"}),(0,a.jsx)(k,{id:"task-".concat(t.id),checked:ee,onCheckedChange:()=>{d(t.id)}}),v?(0,a.jsxs)("div",{className:"flex flex-1 items-center gap-2",children:[(0,a.jsx)(u.p,{value:F,onChange:e=>O(e.target.value),onKeyDown:e=>{"Enter"===e.key?W():"Escape"===e.key&&j(!1)},className:"flex-1",autoFocus:!0}),(0,a.jsx)(c.$,{size:"sm",onClick:W,children:"Save"}),(0,a.jsx)(c.$,{size:"sm",variant:"ghost",onClick:()=>j(!1),children:"Cancel"})]}):(0,a.jsx)("label",{htmlFor:"task-".concat(t.id),className:(0,r.cn)("flex-1 cursor-pointer select-none",ee&&"text-muted-foreground line-through"),children:t.title}),!v&&(0,a.jsxs)("div",{className:"flex gap-1 opacity-0 transition-opacity group-hover:opacity-100",children:[(0,a.jsx)(c.$,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>{j(!0),O(t.title)},title:"Edit",children:(0,a.jsx)(w.A,{className:"h-4 w-4"})}),(0,a.jsx)(c.$,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>z(!0),title:"Add subtask",children:(0,a.jsx)(C.A,{className:"h-4 w-4"})}),(0,a.jsx)(c.$,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>{if(!p)return void alert("Please add an API key in the settings to use AI features.");L(""),J(!0)},disabled:T||!p,title:"AI breakdown",children:(0,a.jsx)(A.A,{className:(0,r.cn)("h-4 w-4",T&&"animate-pulse")})}),(0,a.jsx)(c.$,{variant:"ghost",size:"icon",className:"h-7 w-7 text-destructive hover:bg-destructive/10",onClick:()=>{m(t.id)},title:"Delete",children:(0,a.jsx)(S.A,{className:"h-4 w-4"})})]})]}),$&&(0,a.jsxs)("div",{className:"ml-14 mt-1 flex items-center gap-2 rounded-md border p-2",style:{marginLeft:"".concat(et+56,"px")},children:[(0,a.jsx)(u.p,{placeholder:"Enter subtask name...",value:D,onChange:e=>R(e.target.value),onKeyDown:e=>{"Enter"===e.key?X():"Escape"===e.key&&z(!1)},className:"flex-1",autoFocus:!0}),(0,a.jsx)(c.$,{size:"sm",onClick:X,children:"Add"}),(0,a.jsx)(c.$,{size:"sm",variant:"ghost",onClick:()=>z(!1),children:"Cancel"})]})]})]})}P.displayName="Textarea";var O=s(172);function $(){let{tasks:e,addSubtask:t,moveTask:s,reorderTasks:r,apiKey:i,findTaskAndParent:l}=(0,h.r)(),[d,o]=(0,n.useState)(null),[c,u]=(0,n.useState)(!1),f=(0,m.FR)((0,m.MS)(m.AN,{activationConstraint:{distance:8}})),g=t=>{let s=e=>{for(let a of e){if(a.id===t)return a;if(a.children.length>0){let e=s(a.children);if(e)return e}}return null};return s(e)},v=async(e,s,a)=>{if(!i)return void alert("Please add an API key in the settings to use AI features.");u(!0);try{let n=a?"".concat(s," (Context: ").concat(a,")"):s,r=await I(n,i);if(r&&r.tasks.length>0)for(let s of r.tasks){t(e,{title:s.title,status:"pending"});let a=l(e);if(!a)continue;let n=a.task;if(!n||!n.children||0===n.children.length)continue;let r=n.children[n.children.length-1];if(s.subtasks&&s.subtasks.length>0)for(let e of s.subtasks)t(r.id,{title:e.title,status:"pending"})}}catch(e){console.error("AI generation failed:",e),alert("Failed to generate tasks. Please try again.")}finally{u(!1)}},j=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.map(e=>(0,a.jsxs)("div",{children:[(0,a.jsx)(F,{task:e,level:s,addSubtask:(e,s)=>{"string"==typeof s?t(e,{title:s,status:"pending"}):t(e,s)},aiBreakdown:v}),!e.collapsed&&e.children.length>0&&(0,a.jsx)("div",{children:(0,a.jsx)(x.gB,{items:e.children.map(e=>e.id),strategy:x._G,children:j(e.children,s+1)})})]},e.id))},k=d?g(d):null,b=e.map(e=>e.id);return(0,a.jsxs)(a.Fragment,{children:[c&&(0,a.jsx)("div",{className:"fixed inset-0 flex items-center justify-center bg-background/80 z-50",children:(0,a.jsxs)("div",{className:"flex flex-col items-center gap-2 p-4 rounded-md bg-card border shadow-md",children:[(0,a.jsx)(O.A,{className:"h-8 w-8 animate-spin text-primary"}),(0,a.jsx)("p",{children:"Generating tasks with AI..."})]})}),(0,a.jsxs)(m.Mp,{sensors:f,collisionDetection:m.fp,onDragStart:e=>{o(e.active.id)},onDragOver:e=>{let{active:t,over:s}=e;if(!s||t.id===s.id)return;let a=t.id,n=s.id,r=g(a),i=g(n);if(!r||!i)return;let l=(e,t)=>e.id===t||e.children.some(e=>l(e,t));if(l(r,n))return},onDragEnd:t=>{o(null);let{active:s,over:a}=t;if(a&&s.id!==a.id){let t=s.id,n=a.id,i=g(t),l=g(n);if(!i||!l)return;let d=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;for(let a=0;a<t.length;a++){if(t[a].id===e)return{parent:s,index:a};if(t[a].children.length>0){let s=d(e,t[a].children,t[a]);if(null!==s.parent)return s}}return{parent:null,index:-1}},{parent:o,index:c}=d(t,e),{parent:u,index:h}=d(n,e);if(o===u)if(null===o)r((0,x.be)(e,c,h));else{let t=(0,x.be)(o.children,c,h),s=(e,t,a)=>e.map(e=>e.id===t?{...e,children:a}:e.children&&e.children.length>0?{...e,children:s(e.children,t,a)}:e);r(s(e,o.id,t))}}},modifiers:[p.FN],children:[(0,a.jsx)("div",{className:"space-y-1",children:0===e.length?(0,a.jsx)("div",{className:"rounded-md border border-dashed p-6 text-center text-muted-foreground",children:"No tasks yet. Create your first task below."}):(0,a.jsx)(x.gB,{items:b,strategy:x._G,children:j(e)})}),(0,a.jsx)(m.Hd,{children:d&&k&&(0,a.jsx)("div",{className:"w-full opacity-70",children:(0,a.jsx)(F,{task:k,level:0,addSubtask:()=>{}})})})]})]})}function z(){return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)($,{}),(0,a.jsxs)(i,{children:[(0,a.jsx)(l,{children:(0,a.jsx)(d,{children:"Add a New Goal"})}),(0,a.jsx)(o,{children:(0,a.jsx)(f,{})})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[829,749,816,441,684,358],()=>t(5406)),_N_E=e.O()}]);