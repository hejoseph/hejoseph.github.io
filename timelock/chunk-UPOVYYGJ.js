import{A as fe,C as L,e as $,h as ee,i as te,j as z,k as R,l as ne,m as ie,n as H,o as oe,p as re,r as ae,s as se,t as le,u as de,v as ce,w as me,x as j,z as ue}from"./chunk-ZHH3AUGI.js";import{$ as m,$b as W,Ga as I,Ib as S,Ka as T,Ma as B,W as k,Xa as g,Ya as o,Za as a,Zb as Z,_a as b,_b as V,aa as p,ba as E,c as D,ca as P,cb as C,db as f,dc as F,eb as d,gb as Y,hb as q,ib as G,ja as O,kb as Q,kc as pe,la as U,lb as J,lc as ge,mc as _e,nb as c,nc as xe,ob as u,pb as _,qb as X,tb as x,ub as h,vb as v,wa as r,zb as K}from"./chunk-BIN6KA2U.js";function Ce(l,t){if(l&1&&(o(0,"div",8)(1,"span",9),c(2),a(),o(3,"span",10),c(4),a()()),l&2){let e=d();r(2),_("",e.workingSessions().length," sessions"),r(2),_("Total: ",e.formatDuration(e.totalActualTime()))}}function De(l,t){if(l&1){let e=C();o(0,"div",11)(1,"div",12)(2,"span",13),c(3,"\u{1F534} Currently Working"),a(),o(4,"span",14),c(5),a(),o(6,"span",15),c(7),a()(),o(8,"div",16)(9,"span",17),c(10),a(),o(11,"button",18),f("click",function(){m(e);let n=d();return p(n.stopWorking())}),c(12,"Stop"),a()()()}if(l&2){let e,i=d();r(5),_(" (Started at: ",i.formatTime(i.activeSession().startTime),")"),r(2),u(i.getCurrentSessionDuration()),r(3),u(((e=i.activeSession())==null?null:e.description)||"Working session")}}function ke(l,t){if(l&1){let e=C();o(0,"div",19)(1,"button",20),f("click",function(){m(e);let n=d();return p(n.startWorking())}),c(2," \u25B6\uFE0F Start Working "),a()()}}function be(l,t){if(l&1){let e=C();o(0,"div",26)(1,"div",27)(2,"div",28)(3,"label"),c(4,"Description:"),a(),o(5,"input",29),v("ngModelChange",function(n){m(e);let s=d(3);return h(s.editForm.description,n)||(s.editForm.description=n),p(n)}),a()(),o(6,"div",28)(7,"label"),c(8,"Start Time:"),a(),o(9,"input",30),v("ngModelChange",function(n){m(e);let s=d(3);return h(s.editForm.startTime,n)||(s.editForm.startTime=n),p(n)}),a()(),o(10,"div",28)(11,"label"),c(12,"End Time:"),a(),o(13,"input",30),v("ngModelChange",function(n){m(e);let s=d(3);return h(s.editForm.endTime,n)||(s.editForm.endTime=n),p(n)}),a()(),o(14,"div",31)(15,"button",32),f("click",function(){m(e);let n=d().$implicit,s=d(2);return p(s.saveSession(n))}),c(16,"Save"),a(),o(17,"button",33),f("click",function(){m(e);let n=d(3);return p(n.cancelEdit())}),c(18,"Cancel"),a()()()()}if(l&2){let e=d(3);r(5),x("ngModel",e.editForm.description),r(4),x("ngModel",e.editForm.startTime),r(4),x("ngModel",e.editForm.endTime)}}function Se(l,t){if(l&1&&(o(0,"div",16)(1,"span",17),c(2),a()()),l&2){let e=d(2).$implicit;r(2),u(e.description)}}function Me(l,t){if(l&1){let e=C();o(0,"div",34)(1,"div",35)(2,"span",36),c(3),a(),o(4,"span",37),c(5),a(),o(6,"div",38)(7,"button",39),f("click",function(n){m(e);let s=d().$implicit,y=d(2);return p(y.startEditSession(s,n))}),E(),o(8,"svg",40),b(9,"path",41),a()(),P(),o(10,"button",42),f("click",function(n){m(e);let s=d().$implicit,y=d(2);return p(y.confirmDeleteSession(s,n))}),E(),o(11,"svg",40),b(12,"path",43),a()()()(),T(13,Se,3,1,"div",44),P(),o(14,"div",45),c(15),a()()}if(l&2){let e=d().$implicit,i=d(2);r(3),u(i.formatSessionDate(e.startTime)),r(2),u(i.formatDuration(e.duration)),r(8),g("ngIf",e.description&&e.description!=="Working session"),r(2),X(" ",i.formatTime(e.startTime)," - ",i.formatTime(e.endTime)," ")}}function Ee(l,t){if(l&1&&(o(0,"div",23),T(1,be,19,3,"div",24)(2,Me,16,5,"div",25),a()),l&2){let e=t.$implicit,i=d(2);r(),g("ngIf",i.editingSessionId()===e.id),r(),g("ngIf",i.editingSessionId()!==e.id)}}function Pe(l,t){if(l&1&&(o(0,"div",21)(1,"h4"),c(2,"Past Sessions"),a(),T(3,Ee,3,2,"div",22),a()),l&2){let e=d();r(3),g("ngForOf",e.completedSessions())("ngForTrackBy",e.trackBySessionId)}}function Oe(l,t){l&1&&(o(0,"div",46)(1,"div",47),c(2,"\u23F1\uFE0F"),a(),o(3,"div",48),c(4,"No working sessions yet"),a(),o(5,"div",49),c(6,"Start working on this task to track your time"),a()())}function Ie(l,t){if(l&1&&(o(0,"div",52)(1,"span",53),c(2,"Estimated:"),a(),o(3,"span",54),c(4),a()()),l&2){let e=d(2);r(4),u(e.formatDuration(e.todo.duration))}}function Ve(l,t){if(l&1&&(o(0,"div",52)(1,"span",53),c(2,"Actual:"),a(),o(3,"span",54),c(4),a()()),l&2){let e=d(2);r(4),u(e.formatDuration(e.totalActualTime()))}}function We(l,t){if(l&1&&(o(0,"div",52)(1,"span",53),c(2,"Difference:"),a(),o(3,"span",54),c(4),a()()),l&2){let e=d(2);r(3),J("over-estimate",e.totalActualTime()>e.todo.duration)("under-estimate",e.totalActualTime()<e.todo.duration),r(),_(" ",e.getDifferenceText()," ")}}function Fe(l,t){if(l&1&&(o(0,"div",50),T(1,Ie,5,1,"div",51)(2,Ve,5,1,"div",51)(3,We,5,5,"div",51),a()),l&2){let e=d();r(),g("ngIf",e.todo.duration),r(),g("ngIf",e.totalActualTime()>0),r(),g("ngIf",e.todo.duration&&e.totalActualTime()>0)}}var A=class l{todo=null;todoService=k(L);timeTrackingService=k(xe);editingSessionId=O(null);editForm={description:"",startTime:"",endTime:""};workingSessions=S(()=>this.todo?this.todoService.getWorkingSessionsForTask(this.todo.id):[]);completedSessions=S(()=>this.workingSessions().filter(t=>!t.isActive));activeSession=S(()=>this.workingSessions().find(t=>t.isActive)||null);totalActualTime=S(()=>this.todo?this.todoService.getActualWorkTimeForTask(this.todo.id):0);startWorking(){return D(this,null,function*(){if(this.todo)try{yield this.todoService.startWorking(this.todo.id)}catch(t){console.error("Error starting work session:",t)}})}stopWorking(){return D(this,null,function*(){try{yield this.todoService.stopWorking()}catch(t){console.error("Error stopping work session:",t)}})}getCurrentSessionDuration(){let t=this.activeSession();if(!t)return"0m";let i=Math.round((new Date().getTime()-t.startTime.getTime())/6e4);return this.formatDuration(i)}formatDuration(t){return this.timeTrackingService.formatDuration(t)}formatSessionDate(t){let e=new Date,i=new Date(t);if(this.isSameDay(i,e))return"Today";let n=new Date(e);return n.setDate(n.getDate()-1),this.isSameDay(i,n)?"Yesterday":new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric"}).format(i)}formatTime(t){return new Intl.DateTimeFormat("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}).format(new Date(t))}getDifferenceText(){if(!this.todo||!this.todo.duration)return"";let t=this.todo.duration,e=this.totalActualTime(),i=Math.abs(e-t);return e>t?`+${this.formatDuration(i)} over`:e<t?`${this.formatDuration(i)} under`:"Exact match!"}isSameDay(t,e){return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate()}startEditSession(t,e){e&&(e.stopPropagation(),e.preventDefault()),this.editingSessionId.set(t.id),this.editForm.description=t.description||"",this.editForm.startTime=this.formatDateForInput(t.startTime),this.editForm.endTime=t.endTime?this.formatDateForInput(t.endTime):""}cancelEdit(){this.editingSessionId.set(null),this.resetEditForm()}saveSession(t){return D(this,null,function*(){try{let e=new Date(this.editForm.startTime),i=new Date(this.editForm.endTime);if(i<=e){alert("End time must be after start time");return}let n=Math.round((i.getTime()-e.getTime())/6e4),s={description:this.editForm.description.trim()||"Working session",startTime:e,endTime:i,duration:n};yield this.timeTrackingService.updateTimeEntry(t.id,s),this.editingSessionId.set(null),this.resetEditForm(),console.log("Session updated successfully")}catch(e){console.error("Error updating session:",e),alert("Failed to update session. Please try again.")}})}confirmDeleteSession(t,e){return D(this,null,function*(){e&&(e.stopPropagation(),e.preventDefault()),confirm(`Are you sure you want to delete this working session?

Date: ${this.formatSessionDate(t.startTime)}
Duration: ${this.formatDuration(t.duration)}
Time: ${this.formatTime(t.startTime)} - ${this.formatTime(t.endTime)}`)&&(yield this.deleteSession(t))})}deleteSession(t){return D(this,null,function*(){try{yield this.timeTrackingService.deleteTimeEntry(t.id),console.log("Session deleted successfully")}catch(e){console.error("Error deleting session:",e),alert("Failed to delete session. Please try again.")}})}resetEditForm(){this.editForm.description="",this.editForm.startTime="",this.editForm.endTime=""}formatDateForInput(t){let e=new Date(t);return e.setMinutes(e.getMinutes()-e.getTimezoneOffset()),e.toISOString().slice(0,16)}trackBySessionId(t,e){return e.id}static \u0275fac=function(e){return new(e||l)};static \u0275cmp=I({type:l,selectors:[["app-working-sessions"]],inputs:{todo:"todo"},decls:10,vars:6,consts:[[1,"working-sessions-container"],[1,"header"],["class","session-summary",4,"ngIf"],["class","active-session",4,"ngIf"],["class","start-working",4,"ngIf"],["class","sessions-list",4,"ngIf"],["class","empty-state",4,"ngIf"],["class","time-comparison",4,"ngIf"],[1,"session-summary"],[1,"session-count"],[1,"total-time"],[1,"active-session"],[1,"session-header","active"],[1,"session-status"],[1,"session-start-time"],[1,"session-time"],[1,"session-details"],[1,"session-description"],["type","button",1,"stop-btn",3,"click"],[1,"start-working"],["type","button",1,"start-btn",3,"click"],[1,"sessions-list"],["class","session-item",4,"ngFor","ngForOf","ngForTrackBy"],[1,"session-item"],["class","edit-session",4,"ngIf"],["class","view-session",4,"ngIf"],[1,"edit-session"],[1,"edit-form"],[1,"edit-row"],["type","text","placeholder","Session description",1,"edit-input",3,"ngModelChange","ngModel"],["type","datetime-local",1,"edit-input",3,"ngModelChange","ngModel"],[1,"edit-actions"],["type","button",1,"save-btn",3,"click"],["type","button",1,"cancel-btn",3,"click"],[1,"view-session"],[1,"session-header"],[1,"session-date"],[1,"session-duration"],[1,"session-actions"],["title","Edit session",1,"edit-session-btn",3,"click"],["width","14","height","14","viewBox","0 0 16 16","fill","currentColor"],["d","M11.013 1.427a1.75 1.75 0 012.474 0l1.086 1.086a1.75 1.75 0 010 2.474l-8.61 8.61c-.21.21-.47.364-.756.445l-3.251.93a.75.75 0 01-.927-.928l.929-3.25a1.75 1.75 0 01.445-.758l8.61-8.61z"],["title","Delete session",1,"delete-session-btn",3,"click"],["d","M6.5 1.75a.25.25 0 01.25-.25h2.5a.25.25 0 01.25.25V3h-3V1.75zm4.5 0V3h2.25a.75.75 0 010 1.5H2.75a.75.75 0 010-1.5H5V1.75C5 .784 5.784 0 6.75 0h2.5C10.216 0 11 .784 11 1.75zM4.496 6.675a.75.75 0 10-1.492.15l.66 6.6A1.75 1.75 0 005.405 15h5.19c.9 0 1.652-.681 1.741-1.576l.66-6.6a.75.75 0 00-1.492-.149l-.66 6.6a.25.25 0 01-.249.225h-5.19a.25.25 0 01-.249-.225l-.66-6.6z"],["class","session-details",4,"ngIf"],[1,"session-time-range"],[1,"empty-state"],[1,"empty-icon"],[1,"empty-message"],[1,"empty-hint"],[1,"time-comparison"],["class","comparison-row",4,"ngIf"],[1,"comparison-row"],[1,"label"],[1,"value"]],template:function(e,i){e&1&&(o(0,"div",0)(1,"div",1)(2,"h3"),c(3,"Working Sessions"),a(),T(4,Ce,5,2,"div",2),a(),T(5,De,13,3,"div",3)(6,ke,3,0,"div",4)(7,Pe,4,2,"div",5)(8,Oe,7,0,"div",6)(9,Fe,4,3,"div",7),a()),e&2&&(r(4),g("ngIf",i.workingSessions().length>0),r(),g("ngIf",i.activeSession()),r(),g("ngIf",!i.activeSession()&&i.todo),r(),g("ngIf",i.completedSessions().length>0),r(),g("ngIf",i.workingSessions().length===0),r(),g("ngIf",i.todo&&(i.todo.duration||i.totalActualTime()>0)))},dependencies:[F,V,W,j,z,R,H],styles:[".working-sessions-container[_ngcontent-%COMP%]{padding:16px;background:#f8f9fa;border-radius:8px;margin:16px 0}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}.header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#333;font-size:18px}.session-summary[_ngcontent-%COMP%]{display:flex;gap:16px;font-size:14px;color:#666}.session-count[_ngcontent-%COMP%]{font-weight:500}.total-time[_ngcontent-%COMP%]{font-weight:600;color:#2563eb}.active-session[_ngcontent-%COMP%]{background:#fef3c7;border:1px solid #f59e0b;border-radius:6px;padding:12px;margin-bottom:16px}.session-header.active[_ngcontent-%COMP%]   .session-status[_ngcontent-%COMP%]{color:#dc2626;font-weight:600}.session-time[_ngcontent-%COMP%]{font-family:Monaco,Menlo,monospace;font-weight:600;color:#1f2937}.session-details[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.session-description[_ngcontent-%COMP%]{color:#6b7280;font-style:italic}.start-working[_ngcontent-%COMP%]{margin-bottom:16px}.start-btn[_ngcontent-%COMP%]{background:#10b981;color:#fff;border:none;padding:10px 16px;border-radius:6px;cursor:pointer;font-weight:500;transition:background-color .2s}.start-btn[_ngcontent-%COMP%]:hover{background:#059669}.stop-btn[_ngcontent-%COMP%]{background:#dc2626;color:#fff;border:none;padding:6px 12px;border-radius:4px;cursor:pointer;font-size:12px;transition:background-color .2s}.stop-btn[_ngcontent-%COMP%]:hover{background:#b91c1c}.sessions-list[_ngcontent-%COMP%]{margin-top:16px}.sessions-list[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 12px;color:#374151;font-size:14px;font-weight:600}.session-item[_ngcontent-%COMP%]{background:#fff;border:1px solid #e5e7eb;border-radius:6px;padding:12px;margin-bottom:8px}.session-item[_ngcontent-%COMP%]:last-child{margin-bottom:0}.session-date[_ngcontent-%COMP%]{font-weight:500;color:#374151}.session-duration[_ngcontent-%COMP%]{font-family:Monaco,Menlo,monospace;font-weight:600;color:#2563eb}.session-time-range[_ngcontent-%COMP%]{font-size:12px;color:#6b7280;margin-top:4px}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:32px 16px;color:#6b7280}.empty-icon[_ngcontent-%COMP%]{font-size:48px;margin-bottom:12px}.empty-message[_ngcontent-%COMP%]{font-size:16px;font-weight:500;margin-bottom:4px}.empty-hint[_ngcontent-%COMP%]{font-size:14px}.time-comparison[_ngcontent-%COMP%]{margin-top:16px;padding:12px;background:#fff;border:1px solid #e5e7eb;border-radius:6px}.comparison-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:4px}.comparison-row[_ngcontent-%COMP%]:last-child{margin-bottom:0}.comparison-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:14px;color:#6b7280}.comparison-row[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-family:Monaco,Menlo,monospace;font-weight:600;font-size:14px}.over-estimate[_ngcontent-%COMP%]{color:#dc2626}.under-estimate[_ngcontent-%COMP%]{color:#059669}@media (max-width: 768px){.working-sessions-container[_ngcontent-%COMP%]{padding:12px;margin:12px 0}.header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:8px}.session-summary[_ngcontent-%COMP%]{flex-direction:column;gap:4px}.session-details[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:8px}}.session-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}.session-actions[_ngcontent-%COMP%]{display:flex;gap:.5rem;opacity:0;transition:opacity .2s ease}.session-item[_ngcontent-%COMP%]:hover   .session-actions[_ngcontent-%COMP%]{opacity:1}.edit-session-btn[_ngcontent-%COMP%], .delete-session-btn[_ngcontent-%COMP%]{background:none;border:none;padding:.25rem;border-radius:4px;cursor:pointer;color:#6b7280;transition:all .2s ease;display:flex;align-items:center;justify-content:center}.edit-session-btn[_ngcontent-%COMP%]:hover{background:#f3f4f6;color:#2563eb}.delete-session-btn[_ngcontent-%COMP%]:hover{background:#fef2f2;color:#dc2626}.edit-session[_ngcontent-%COMP%]{background:#f9fafb;border-radius:6px;padding:16px}.edit-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.edit-row[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.edit-row[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:12px;font-weight:500;color:#374151}.edit-input[_ngcontent-%COMP%]{padding:8px 12px;border:1px solid #d1d5db;border-radius:4px;font-size:14px;transition:border-color .2s ease}.edit-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#2563eb;box-shadow:0 0 0 3px #2563eb1a}.edit-actions[_ngcontent-%COMP%]{display:flex;gap:8px;margin-top:8px}.save-btn[_ngcontent-%COMP%], .cancel-btn[_ngcontent-%COMP%]{padding:8px 16px;border:none;border-radius:4px;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s ease}.save-btn[_ngcontent-%COMP%]{background:#2563eb;color:#fff}.save-btn[_ngcontent-%COMP%]:hover{background:#1d4ed8}.cancel-btn[_ngcontent-%COMP%]{background:#f3f4f6;color:#374151}.cancel-btn[_ngcontent-%COMP%]:hover{background:#e5e7eb}"]})};var ze=["titleTextarea"],Re=l=>["/project",l],He=l=>({highlightTask:l});function je(l,t){if(l&1){let e=C();o(0,"span",50),c(1),o(2,"button",51),f("click",function(){let n=m(e).index,s=d(2);return p(s.removeTag(n))}),c(3,"\xD7"),a()()}if(l&2){let e=t.$implicit,i=d(2);Q("background-color",i.getTagColor(e))("color",i.getTagTextColor(e)),r(),_(" ",e," "),r(),g("title",i.translations().removeTag)}}function Le(l,t){if(l&1&&b(0,"option",52),l&2){let e=t.$implicit;g("value",e.name)}}function Ae(l,t){if(l&1&&(o(0,"option",54),c(1),a()),l&2){let e=t.$implicit;g("ngValue",e.id),r(),u(e.name)}}function Ne(l,t){if(l&1&&(o(0,"small",28),c(1),a()),l&2){let e=d(3);r(),u(e.translations().subtasksHint)}}function Be(l,t){if(l&1){let e=C();o(0,"div",14)(1,"div",10)(2,"label",11),c(3),a(),o(4,"select",53),v("ngModelChange",function(n){m(e);let s=d(2);return h(s.formData.projectId,n)||(s.formData.projectId=n),p(n)}),o(5,"option",54),c(6),a(),T(7,Ae,2,2,"option",55),a(),T(8,Ne,2,1,"small",56),a()()}if(l&2){let e=d(2);r(3),u(e.translations().project),r(),x("ngModel",e.formData.projectId),g("disabled",e.isSubtask)("title",e.translations().subtasksUseParentProject),r(),g("ngValue",void 0),r(),u(e.translations().noProject),r(),g("ngForOf",e.projectService.activeProjects()),r(),g("ngIf",e.isSubtask)}}function Ke(l,t){if(l&1){let e=C();o(0,"div",62)(1,"div",14)(2,"div",10)(3,"label",11),c(4),a(),o(5,"div",63)(6,"input",64),v("ngModelChange",function(n){m(e);let s=d(3);return h(s.formData.recurrenceInterval,n)||(s.formData.recurrenceInterval=n),p(n)}),a(),o(7,"select",65),v("ngModelChange",function(n){m(e);let s=d(3);return h(s.formData.recurrenceType,n)||(s.formData.recurrenceType=n),p(n)}),o(8,"option",66),c(9),a(),o(10,"option",67),c(11),a(),o(12,"option",68),c(13),a()()()()(),o(14,"div",14)(15,"div",10)(16,"label",11),c(17),a(),o(18,"input",69),v("ngModelChange",function(n){m(e);let s=d(3);return h(s.formData.recurrenceEndDate,n)||(s.formData.recurrenceEndDate=n),p(n)}),a()(),o(19,"div",10)(20,"label",11),c(21),a(),o(22,"input",70),v("ngModelChange",function(n){m(e);let s=d(3);return h(s.formData.recurrenceMaxOccurrences,n)||(s.formData.recurrenceMaxOccurrences=n),p(n)}),a()()(),o(23,"small",28),c(24),a()()}if(l&2){let e=d(3);r(4),u(e.translations().repeatEvery),r(2),x("ngModel",e.formData.recurrenceInterval),r(),x("ngModel",e.formData.recurrenceType),r(2),u(e.formData.recurrenceInterval===1?e.translations().day:e.translations().days),r(2),u(e.formData.recurrenceInterval===1?e.translations().week:e.translations().weeks),r(2),u(e.formData.recurrenceInterval===1?e.translations().month:e.translations().months),r(4),u(e.translations().endRecurrence),r(),x("ngModel",e.formData.recurrenceEndDate),g("placeholder",e.translations().noEndDate),r(3),u(e.translations().maxOccurrences),r(),x("ngModel",e.formData.recurrenceMaxOccurrences),g("placeholder",e.translations().unlimited),r(2),_(" \u{1F4C5} ",e.getRecurrencePreview()," ")}}function Ue(l,t){if(l&1){let e=C();o(0,"div",10)(1,"div",57)(2,"label",58)(3,"input",59),v("ngModelChange",function(n){m(e);let s=d(2);return h(s.formData.isRecurring,n)||(s.formData.isRecurring=n),p(n)}),f("change",function(){m(e);let n=d(2);return p(n.onRecurringToggle())}),a(),b(4,"span",60),c(5),a()(),T(6,Ke,25,13,"div",61),a()}if(l&2){let e=d(2);r(3),x("ngModel",e.formData.isRecurring),r(2),_(" \u{1F504} ",e.translations().makeRecurring," "),r(),g("ngIf",e.formData.isRecurring)}}function Ye(l,t){if(l&1&&(o(0,"div",71),b(1,"app-working-sessions",72),a()),l&2){let e=d(2);r(),g("todo",e.todo)}}function qe(l,t){if(l&1){let e=C();o(0,"a",73),f("click",function(){m(e);let n=d(2);return p(n.onClose())}),c(1),a()}if(l&2){let e=d(2);g("routerLink",K(3,Re,e.todo==null?null:e.todo.projectId))("queryParams",K(5,He,e.todo==null?null:e.todo.id)),r(),_(" ",e.translations().goToProject," ")}}function Ge(l,t){if(l&1){let e=C();o(0,"div",2),f("click",function(n){m(e);let s=d();return p(s.onOverlayClick(n))}),o(1,"div",3),f("click",function(n){return m(e),p(n.stopPropagation())}),o(2,"div",4)(3,"h2",5),c(4),a(),o(5,"button",6),f("click",function(){m(e);let n=d();return p(n.onClose())}),E(),o(6,"svg",7),b(7,"path",8),a()()(),P(),o(8,"form",9),f("ngSubmit",function(){m(e);let n=d();return p(n.onSubmit())}),o(9,"div",10)(10,"label",11),c(11),a(),o(12,"textarea",12,0),v("ngModelChange",function(n){m(e);let s=d();return h(s.formData.title,n)||(s.formData.title=n),p(n)}),f("input",function(n){m(e);let s=d();return p(s.onTitleInput(n))})("keydown",function(n){m(e);let s=d();return p(s.onTitleKeydown(n))}),a()(),o(15,"div",10)(16,"label",11),c(17),a(),o(18,"textarea",13),v("ngModelChange",function(n){m(e);let s=d();return h(s.formData.description,n)||(s.formData.description=n),p(n)}),f("keydown",function(n){m(e);let s=d();return p(s.onTextareaKeydown(n))}),a()(),o(19,"div",14)(20,"div",10)(21,"label",11),c(22),a(),o(23,"select",15),v("ngModelChange",function(n){m(e);let s=d();return h(s.formData.priority,n)||(s.formData.priority=n),p(n)}),f("ngModelChange",function(n){m(e);let s=d();return p(s.onPriorityChange(n))}),o(24,"option",16),c(25),a(),o(26,"option",17),c(27),a(),o(28,"option",18),c(29),a()()(),o(30,"div",10)(31,"label",11),c(32),a(),o(33,"div",19)(34,"input",20),v("ngModelChange",function(n){m(e);let s=d();return h(s.formData.dueDate,n)||(s.formData.dueDate=n),p(n)}),f("keydown",function(n){m(e);let s=d();return p(s.onDateTimeKeydown(n,"dueDate"))}),a(),o(35,"button",21),f("click",function(){m(e);let n=d();return p(n.setDueDateToNow())}),c(36),a()()()(),o(37,"div",14)(38,"div",10)(39,"label",11),c(40),a(),o(41,"div",19)(42,"input",22),v("ngModelChange",function(n){m(e);let s=d();return h(s.formData.startDateTime,n)||(s.formData.startDateTime=n),p(n)}),f("change",function(){m(e);let n=d();return p(n.onStartDateTimeChange())})("keydown",function(n){m(e);let s=d();return p(s.onDateTimeKeydown(n,"startDateTime"))}),a(),o(43,"button",21),f("click",function(){m(e);let n=d();return p(n.setStartDateTimeToNow())}),c(44),a()()(),o(45,"div",10)(46,"label",11),c(47),a(),o(48,"div",19)(49,"input",23),v("ngModelChange",function(n){m(e);let s=d();return h(s.formData.endDateTime,n)||(s.formData.endDateTime=n),p(n)}),f("change",function(){m(e);let n=d();return p(n.onEndDateTimeChange())})("keydown",function(n){m(e);let s=d();return p(s.onDateTimeKeydown(n,"endDateTime"))}),a(),o(50,"button",21),f("click",function(){m(e);let n=d();return p(n.setEndDateTimeToNow())}),c(51),a()()()(),o(52,"div",14)(53,"div",10)(54,"label",11),c(55),a(),o(56,"div",24)(57,"input",25),v("ngModelChange",function(n){m(e);let s=d();return h(s.formData.durationHours,n)||(s.formData.durationHours=n),p(n)}),f("change",function(){m(e);let n=d();return p(n.onDurationChange())}),a(),o(58,"span",26),c(59),a(),o(60,"input",27),v("ngModelChange",function(n){m(e);let s=d();return h(s.formData.durationMinutes,n)||(s.formData.durationMinutes=n),p(n)}),f("change",function(){m(e);let n=d();return p(n.onDurationChange())}),a(),o(61,"span",26),c(62),a()(),o(63,"small",28),c(64),a()()(),o(65,"div",10)(66,"label",11),c(67),a(),o(68,"input",29),v("ngModelChange",function(n){m(e);let s=d();return h(s.formData.category,n)||(s.formData.category=n),p(n)}),a(),o(69,"datalist",30)(70,"option",31),c(71),a(),o(72,"option",32),c(73),a(),o(74,"option",33),c(75),a(),o(76,"option",34),c(77),a(),o(78,"option",35),c(79),a(),o(80,"option",36),c(81),a()()(),o(82,"div",10)(83,"label",11),c(84),a(),o(85,"div",37)(86,"div",38),T(87,je,4,6,"span",39),a(),o(88,"input",40),v("ngModelChange",function(n){m(e);let s=d();return h(s.tagInput,n)||(s.tagInput=n),p(n)}),f("keydown",function(n){m(e);let s=d();return p(s.onTagInputKeydown(n))})("blur",function(){m(e);let n=d();return p(n.addTagFromInput())}),a(),o(89,"datalist",41),T(90,Le,1,1,"option",42),a()(),o(91,"small",28),c(92),a()(),T(93,Be,9,8,"div",43)(94,Ue,7,3,"div",44)(95,Ye,2,1,"div",45),o(96,"div",46),T(97,qe,2,7,"a",47),o(98,"button",48),f("click",function(){m(e);let n=d();return p(n.onClose())}),c(99),a(),o(100,"button",49),c(101),a()()()()()}if(l&2){let e=d();r(4),u(e.isEditing?e.translations().editTask:e.translations().createTask),r(7),_("",e.translations().taskTitle," *"),r(),x("ngModel",e.formData.title),g("placeholder",e.translations().enterTaskTitle),r(5),u(e.translations().description),r(),x("ngModel",e.formData.description),g("placeholder",e.translations().enterTaskDescription),r(4),u(e.translations().priority),r(),g("ngClass","priority-"+e.formData.priority),x("ngModel",e.formData.priority),r(2),_("\u{1F7E2} ",e.translations().priorityLow),r(2),_("\u{1F7E1} ",e.translations().priorityMedium),r(2),_("\u{1F534} ",e.translations().priorityHigh),r(3),u(e.translations().dueDate),r(2),x("ngModel",e.formData.dueDate),g("min",e.today),r(2),u(e.translations().now),r(4),u(e.translations().startDateTime),r(2),x("ngModel",e.formData.startDateTime),g("min",e.today),r(2),u(e.translations().now),r(3),u(e.translations().endDateTime),r(2),x("ngModel",e.formData.endDateTime),g("min",e.formData.startDateTime||e.today),r(2),u(e.translations().now),r(4),u(e.translations().duration),r(2),x("ngModel",e.formData.durationHours),r(2),u(e.translations().hours),r(),x("ngModel",e.formData.durationMinutes),r(2),u(e.translations().minutes),r(2),u(e.translations().durationHint),r(3),u(e.translations().category),r(),x("ngModel",e.formData.category),g("placeholder",e.translations().categoryPlaceholder),r(3),_("",e.translations().work," "),r(2),_("",e.translations().personal," "),r(2),_("",e.translations().development," "),r(2),_("",e.translations().design," "),r(2),_("",e.translations().meeting," "),r(2),_("",e.translations().research," "),r(3),u(e.translations().tags),r(3),g("ngForOf",e.formData.tags),r(),x("ngModel",e.tagInput),g("placeholder",e.translations().tagsPlaceholder),r(2),g("ngForOf",e.tagsService.tags()),r(2),u(e.translations().tagsHint),r(),g("ngIf",!e.isSubtask||e.todo),r(),g("ngIf",!e.isSubtask),r(),g("ngIf",e.isEditing&&e.todo),r(2),g("ngIf",e.todo==null?null:e.todo.projectId),r(2),_(" ",e.translations().cancel," "),r(),g("disabled",!e.formData.title.trim()),r(),_(" ",e.isEditing?e.translations().updateTask:e.translations().createTask," ")}}var he=class l{projectService=k(pe);tagsService=k(_e);recurringTasksService=k(ue);settingsService=k(fe);translationService=k(ge);todoService=k(L);translations=S(()=>({editTask:this.translationService.translate("taskEditor.editTask"),createTask:this.translationService.translate("taskEditor.createTask"),updateTask:this.translationService.translate("taskEditor.updateTask"),cancel:this.translationService.translate("actions.cancel"),goToProject:this.translationService.translate("taskEditor.goToProject"),taskTitle:this.translationService.translate("taskEditor.taskTitle"),enterTaskTitle:this.translationService.translate("taskEditor.enterTaskTitle"),addTaskDescription:this.translationService.translate("taskEditor.addTaskDescription"),enterTaskDescription:this.translationService.translate("taskEditor.enterTaskDescription"),priorityLow:this.translationService.translate("priority.low"),priorityMedium:this.translationService.translate("priority.medium"),priorityHigh:this.translationService.translate("priority.high"),dueDate:this.translationService.translate("tasks.dueDate"),startDateTime:this.translationService.translate("tasks.startDateTime"),endDateTime:this.translationService.translate("tasks.endDateTime"),duration:this.translationService.translate("tasks.duration"),now:this.translationService.translate("time.now"),hours:this.translationService.translate("time.hours"),minutes:this.translationService.translate("time.minutes"),category:this.translationService.translate("tasks.category"),work:this.translationService.translate("categories.work"),personal:this.translationService.translate("categories.personal"),development:this.translationService.translate("categories.development"),design:this.translationService.translate("categories.design"),meeting:this.translationService.translate("categories.meeting"),research:this.translationService.translate("categories.research"),tags:this.translationService.translate("tasks.tags"),removeTag:this.translationService.translate("todoItem.removeTag"),project:this.translationService.translate("tasks.project"),subtasksUseParentProject:this.translationService.translate("taskEditor.subtasksUseParentProject"),endRecurrence:this.translationService.translate("taskEditor.endRecurrence"),maxOccurrences:this.translationService.translate("taskEditor.maxOccurrences"),noEndDate:this.translationService.translate("taskEditor.noEndDate"),unlimited:this.translationService.translate("taskEditor.unlimited"),day:this.translationService.translate("time.day"),days:this.translationService.translate("time.days"),week:this.translationService.translate("time.week"),weeks:this.translationService.translate("time.weeks"),month:this.translationService.translate("time.month"),months:this.translationService.translate("time.months"),priority:this.translationService.translate("tasks.priority"),description:this.translationService.translate("tasks.description"),noProject:this.translationService.translate("common.noProject"),durationHint:this.translationService.translate("taskEditor.durationHint"),categoryPlaceholder:this.translationService.translate("taskEditor.categoryPlaceholder"),tagsPlaceholder:this.translationService.translate("taskEditor.tagsPlaceholder"),tagsHint:this.translationService.translate("taskEditor.tagsHint"),subtasksHint:this.translationService.translate("taskEditor.subtasksHint"),makeRecurring:this.translationService.translate("taskEditor.makeRecurring"),repeatEvery:this.translationService.translate("taskEditor.repeatEvery"),recurrencePreview:this.translationService.translate("taskEditor.recurrencePreview")}));todo=null;isSubtask=!1;defaultProjectId;save=new B;close=new B;titleTextareaRef;isOpenSignal=O(!1);isOpen=this.isOpenSignal.asReadonly();tagInput="";timerInterval;elapsedTime=O(0);get today(){let t=new Date;return t.setMinutes(t.getMinutes()-t.getTimezoneOffset()),t.toISOString().slice(0,16)}isEditing=!1;formData={title:"",description:"",priority:this.settingsService.getDefaultPriorityForNewTask(),dueDate:"",startDateTime:"",endDateTime:"",durationHours:0,durationMinutes:0,category:"",completed:!1,archived:!1,tags:[],isRecurring:!1,recurrenceType:"daily",recurrenceInterval:1,recurrenceEndDate:"",recurrenceMaxOccurrences:null};onKeydown(){this.onClose()}isMouseDownInsideModal=!1;onMousedown(t){let e=t.target;this.isMouseDownInsideModal=!!e.closest(".modal-content"),t.stopPropagation()}onMouseup(t){setTimeout(()=>{this.isMouseDownInsideModal=!1},0)}ngOnInit(){this.todo&&this.todoService.isTaskActive(this.todo.id)&&this.startTimer()}ngOnDestroy(){this.stopTimer()}ngAfterViewInit(){this.isOpen()&&this.formData.title&&(setTimeout(()=>this.resizeTitleTextarea(),0),setTimeout(()=>this.resizeTitleTextarea(),100))}ngOnChanges(t){if(t.todo&&t.todo.currentValue){if(this.isEditing=!0,this.todo){let e=this.todo.duration?Math.floor(this.todo.duration/60):0,i=this.todo.duration?this.todo.duration%60:0;this.formData={title:this.todo.title,description:this.todo.description||"",priority:this.todo.priority,dueDate:this.todo.dueDate?this.formatDateForInput(this.todo.dueDate):"",startDateTime:this.todo.startDateTime?this.formatDateForInput(this.todo.startDateTime):"",endDateTime:this.todo.endDateTime?this.formatDateForInput(this.todo.endDateTime):"",durationHours:e,durationMinutes:i,category:this.todo.category||"",projectId:this.todo.projectId,completed:this.todo.completed,archived:this.todo.archived,tags:this.todo.tags?[...this.todo.tags]:[],isRecurring:this.todo.isRecurring||!1,recurrenceType:this.todo.recurrencePattern?.type||"daily",recurrenceInterval:this.todo.recurrencePattern?.interval||1,recurrenceEndDate:this.todo.recurrencePattern?.endDate?this.formatDateForInput(this.todo.recurrencePattern.endDate):"",recurrenceMaxOccurrences:this.todo.recurrencePattern?.maxOccurrences||null},setTimeout(()=>this.resizeTitleTextarea(),0),setTimeout(()=>this.resizeTitleTextarea(),100),this.todoService.isTaskActive(this.todo.id)?this.startTimer():this.stopTimer()}}else this.defaultProjectId?(this.isEditing=!1,this.resetForm(),this.formData.projectId=this.defaultProjectId):(this.isEditing=!1,this.resetForm())}open(){this.isOpenSignal.set(!0),setTimeout(()=>{let t=document.querySelector('.modal-content textarea[name="title"]');t&&(this.autoResizeTextarea(t),t.focus())},100)}onOverlayClick(t){t.target===t.currentTarget&&!this.isMouseDownInsideModal&&this.onClose(),this.isMouseDownInsideModal=!1}onClose(){this.close.emit(),this.isOpenSignal.set(!1)}onSubmit(){return D(this,null,function*(){if(!this.formData.title.trim())return;let t=(this.formData.durationHours||0)*60+(this.formData.durationMinutes||0),e={title:this.formData.title.trim(),description:this.formData.description.trim()||void 0,priority:this.formData.priority,dueDate:this.formData.dueDate?new Date(this.formData.dueDate):void 0,startDateTime:this.formData.startDateTime?new Date(this.formData.startDateTime):void 0,endDateTime:this.formData.endDateTime?new Date(this.formData.endDateTime):void 0,duration:t>0?t:void 0,category:this.formData.category.trim()||void 0,projectId:this.formData.projectId,completed:this.formData.completed,tags:this.formData.tags.length>0?this.formData.tags:void 0};if(this.formData.isRecurring&&!this.isSubtask){let i={type:this.formData.recurrenceType,interval:this.formData.recurrenceInterval,endDate:this.formData.recurrenceEndDate?new Date(this.formData.recurrenceEndDate):void 0,maxOccurrences:this.formData.recurrenceMaxOccurrences||void 0,currentOccurrences:0};e.isRecurring=!0,e.recurrencePattern=i;let n=e.dueDate||new Date;e.nextDueDate=this.recurringTasksService.calculateNextDueDate(n,i)}else!this.formData.isRecurring&&this.isEditing&&this.todo?.isRecurring&&(e.isRecurring=!1,e.recurrencePattern=void 0,e.nextDueDate=void 0);!this.isEditing&&this.settingsService.useLastChosenPriority&&this.saveLastUsedPriority(this.formData.priority),this.save.emit(e)})}resetForm(){this.formData={title:"",description:"",priority:this.settingsService.getDefaultPriorityForNewTask(),dueDate:"",startDateTime:"",endDateTime:"",durationHours:0,durationMinutes:0,category:"",projectId:void 0,completed:!1,archived:!1,tags:[],isRecurring:!1,recurrenceType:"daily",recurrenceInterval:1,recurrenceEndDate:"",recurrenceMaxOccurrences:null}}getLastUsedPriority(){try{let t=localStorage.getItem("taskEditor.lastPriority");if(t&&["low","medium","high"].includes(t))return t}catch(t){console.warn("Failed to load last used priority from localStorage:",t)}return"medium"}saveLastUsedPriority(t){try{localStorage.setItem("taskEditor.lastPriority",t)}catch(e){console.warn("Failed to save last used priority to localStorage:",e)}}closeAndReset(){this.isOpenSignal.set(!1),this.resetForm()}setDueDateToNow(){this.formData.dueDate=this.formatDateForInput(new Date)}setStartDateTimeToNow(){this.formData.startDateTime=this.formatDateForInput(new Date),this.onStartDateTimeChange()}setEndDateTimeToNow(){this.formData.endDateTime=this.formatDateForInput(new Date),this.onEndDateTimeChange()}onStartDateTimeChange(){if(!this.formData.startDateTime){this.formData.endDateTime="";return}this.calculateDurationFromDates()}onEndDateTimeChange(){this.calculateDurationFromDates()}onDurationChange(){if(this.formData.startDateTime&&(this.formData.durationHours||this.formData.durationMinutes)){let t=new Date(this.formData.startDateTime),e=(this.formData.durationHours||0)*60+(this.formData.durationMinutes||0),i=new Date(t.getTime()+e*6e4),n=new Date(i.getTime()-i.getTimezoneOffset()*6e4).toISOString().slice(0,16);this.formData.endDateTime=n}}onPriorityChange(t){!this.isEditing&&this.settingsService.useLastChosenPriority&&this.saveLastUsedPriority(t)}calculateDurationFromDates(){if(this.formData.startDateTime&&this.formData.endDateTime){let t=new Date(this.formData.startDateTime),e=new Date(this.formData.endDateTime);if(e>t){let i=e.getTime()-t.getTime(),n=Math.floor(i/(1e3*60));this.formData.durationHours=Math.floor(n/60),this.formData.durationMinutes=n%60}}}formatDateForInput(t){let e=new Date(t);return e.setMinutes(e.getMinutes()-e.getTimezoneOffset()),e.toISOString().slice(0,16)}onTagInputKeydown(t){(t.key==="Enter"||t.key===",")&&(t.preventDefault(),this.addTagFromInput())}addTagFromInput(){if(!this.tagInput.trim())return;let t=[];this.tagInput.includes("#")?t=this.tagsService.parseTagsFromText(this.tagInput):t=this.tagInput.split(",").map(e=>e.trim()).filter(e=>e.length>0);for(let e of t)this.addTag(e);this.tagInput=""}addTag(t){let e=t.trim().toLowerCase();e&&!this.formData.tags.includes(e)&&(this.formData.tags.push(e),this.tagsService.autoCreateTags([e]))}removeTag(t){this.formData.tags.splice(t,1)}getTagColor(t){return this.tagsService.getTagByName(t)?.color||"#6b7280"}getTagTextColor(t){let i=this.getTagColor(t).replace("#",""),n=parseInt(i.substr(0,2),16),s=parseInt(i.substr(2,2),16),y=parseInt(i.substr(4,2),16);return(n*299+s*587+y*114)/1e3>128?"#000000":"#ffffff"}onRecurringToggle(){this.formData.isRecurring||(this.formData.recurrenceType="daily",this.formData.recurrenceInterval=1,this.formData.recurrenceEndDate="",this.formData.recurrenceMaxOccurrences=null)}getRecurrencePreview(){if(!this.formData.isRecurring)return"";let t=this.formData.recurrenceInterval===1?"":`${this.formData.recurrenceInterval} `,e=this.formData.recurrenceType==="daily"?"day":this.formData.recurrenceType==="weekly"?"week":"month",i=this.formData.recurrenceInterval===1?"":"s",n=`Repeats every ${t}${e}${i}`;if(this.formData.recurrenceEndDate){let s=new Date(this.formData.recurrenceEndDate).toLocaleDateString();n+=` until ${s}`}return this.formData.recurrenceMaxOccurrences&&(n+=` (max ${this.formData.recurrenceMaxOccurrences} occurrences)`),n}onTextareaKeydown(t){if(t.key==="Tab"){t.preventDefault();let e=t.target,i=e.selectionStart,n=e.selectionEnd,s="  ",y=e.value,w=y.substring(0,i)+s+y.substring(n);this.formData.description=w,setTimeout(()=>{e.selectionStart=e.selectionEnd=i+s.length},0)}}onTitleInput(t){let e=t.target;this.autoResizeTextarea(e)}onTitleKeydown(t){t.key==="Enter"&&(t.preventDefault(),this.onSubmit())}autoResizeTextarea(t){t.style.height="auto",t.style.height=t.scrollHeight+"px"}resizeTitleTextarea(){if(this.titleTextareaRef?.nativeElement)this.autoResizeTextarea(this.titleTextareaRef.nativeElement);else{let t=document.querySelector(".title-textarea");t&&this.autoResizeTextarea(t)}}onDateTimeKeydown(t,e){if(t.key==="ArrowUp"||t.key==="ArrowDown"){let i=t.target,n=i.value;if(!n)return;let s=i.selectionStart||0,y=n.lastIndexOf(":");if(console.log("DateTime keydown debug:",{key:t.key,currentValue:n,cursorPosition:s,minutesStartIndex:y,inMinutesField:s>y}),s>y){let w=new Date(n),N=w.getMinutes();if(console.log("Current minutes:",N),t.key==="ArrowUp"&&N===59){console.log("Handling ArrowUp at 59 minutes"),t.preventDefault(),t.stopPropagation(),w.setHours(w.getHours()+1),w.setMinutes(0);let M=this.formatDateForInput(w);console.log("Setting new value:",M),this.updateFormField(e,M),setTimeout(()=>{i.setSelectionRange(y+1,y+3)},10)}else if(t.key==="ArrowDown"&&N===0){console.log("Handling ArrowDown at 0 minutes"),t.preventDefault(),t.stopPropagation(),w.setHours(w.getHours()-1),w.setMinutes(59);let M=this.formatDateForInput(w);console.log("Setting new value:",M),this.updateFormField(e,M),setTimeout(()=>{i.setSelectionRange(y+1,y+3)},10)}}}}updateFormField(t,e){this.formData[t]=e,t==="startDateTime"?this.onStartDateTimeChange():t==="endDateTime"&&this.onEndDateTimeChange()}startTimer(){this.stopTimer(),this.updateElapsedTime(),this.timerInterval=window.setInterval(()=>{this.updateElapsedTime()},1e3)}stopTimer(){this.timerInterval&&(clearInterval(this.timerInterval),this.timerInterval=void 0)}updateElapsedTime(){if(this.todo){let t=this.todoService.getElapsedTime(this.todo.id);this.elapsedTime.set(t)}}isTaskActive(){return this.todo?this.todoService.isTaskActive(this.todo.id):!1}onStartWork(t){return D(this,null,function*(){if(t.stopPropagation(),!!this.todo)try{if(this.todo.completed){let e=yield this.todoService.duplicateAndStartWork(this.todo.id);this.startTimer(),console.log("Duplicated completed task and started working on new task:",e)}else yield this.todoService.startWork(this.todo.id),this.startTimer()}catch(e){console.error("Failed to start work:",e)}})}onStopWork(t,e=!1){return D(this,null,function*(){if(t.stopPropagation(),!!this.todo)try{yield this.todoService.stopWork(this.todo.id,e),this.stopTimer(),this.elapsedTime.set(0)}catch(i){console.error("Failed to stop work:",i)}})}formatElapsedTime(t){if(t<60)return`${t}m`;let e=Math.floor(t/60),i=t%60;return i===0?`${e}h`:`${e}h ${i}m`}static \u0275fac=function(e){return new(e||l)};static \u0275cmp=I({type:l,selectors:[["app-task-editor"]],viewQuery:function(e,i){if(e&1&&Y(ze,5),e&2){let n;q(n=G())&&(i.titleTextareaRef=n.first)}},hostBindings:function(e,i){e&1&&f("keydown.escape",function(){return i.onKeydown()})("mousedown",function(s){return i.onMousedown(s)})("mouseup",function(s){return i.onMouseup(s)})},inputs:{todo:"todo",isSubtask:"isSubtask",defaultProjectId:"defaultProjectId"},outputs:{save:"save",close:"close"},features:[U],decls:1,vars:1,consts:[["titleInput","","titleTextarea",""],["class","modal-overlay",3,"click",4,"ngIf"],[1,"modal-overlay",3,"click"],[1,"modal-content",3,"click"],[1,"modal-header"],[1,"modal-title"],["type","button",1,"close-btn",3,"click"],["width","20","height","20","viewBox","0 0 20 20","fill","currentColor"],["d","M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"],[1,"modal-form",3,"ngSubmit"],[1,"form-group"],[1,"form-label"],["name","title","required","","rows","1",1,"form-input","title-textarea",3,"ngModelChange","input","keydown","ngModel","placeholder"],["name","description","rows","3",1,"form-input",3,"ngModelChange","keydown","ngModel","placeholder"],[1,"form-row"],["name","priority",1,"form-input","priority-select",3,"ngModelChange","ngClass","ngModel"],["value","low"],["value","medium"],["value","high"],[1,"date-input-group"],["type","datetime-local","name","dueDate",1,"form-input",3,"ngModelChange","keydown","ngModel","min"],["type","button",1,"btn","btn-secondary","btn-now",3,"click"],["type","datetime-local","name","startDateTime",1,"form-input",3,"ngModelChange","change","keydown","ngModel","min"],["type","datetime-local","name","endDateTime",1,"form-input",3,"ngModelChange","change","keydown","ngModel","min"],[1,"duration-input-group"],["type","number","name","durationHours","placeholder","0","min","0","max","23",1,"form-input","duration-input",3,"ngModelChange","change","ngModel"],[1,"duration-label"],["type","number","name","durationMinutes","placeholder","0","min","0","max","59",1,"form-input","duration-input",3,"ngModelChange","change","ngModel"],[1,"form-hint"],["type","text","name","category","list","categories",1,"form-input",3,"ngModelChange","ngModel","placeholder"],["id","categories"],["value","Work"],["value","Personal"],["value","Development"],["value","Design"],["value","Meeting"],["value","Research"],[1,"tags-input-container"],[1,"tags-display"],["class","tag-chip",3,"background-color","color",4,"ngFor","ngForOf"],["type","text","name","tagInput","list","existing-tags",1,"form-input","tags-input",3,"ngModelChange","keydown","blur","ngModel","placeholder"],["id","existing-tags"],[3,"value",4,"ngFor","ngForOf"],["class","form-row",4,"ngIf"],["class","form-group",4,"ngIf"],["class","working-sessions-section",4,"ngIf"],[1,"modal-actions"],["class","btn btn-secondary",3,"routerLink","queryParams","click",4,"ngIf"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"tag-chip"],["type","button",1,"tag-remove",3,"click","title"],[3,"value"],["name","projectId",1,"form-input",3,"ngModelChange","ngModel","disabled","title"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],["class","form-hint",4,"ngIf"],[1,"checkbox-group"],[1,"checkbox-label"],["type","checkbox","name","isRecurring",3,"ngModelChange","change","ngModel"],[1,"checkmark"],["class","recurring-options",4,"ngIf"],[1,"recurring-options"],[1,"repeat-input-group"],["type","number","name","recurrenceInterval","min","1","max","365",1,"form-input","repeat-interval",3,"ngModelChange","ngModel"],["name","recurrenceType",1,"form-input","repeat-type",3,"ngModelChange","ngModel"],["value","daily"],["value","weekly"],["value","monthly"],["type","date","name","recurrenceEndDate",1,"form-input",3,"ngModelChange","ngModel","placeholder"],["type","number","name","recurrenceMaxOccurrences","min","1",1,"form-input",3,"ngModelChange","ngModel","placeholder"],[1,"working-sessions-section"],[3,"todo"],[1,"btn","btn-secondary",3,"click","routerLink","queryParams"]],template:function(e,i){e&1&&T(0,Ge,102,53,"div",1),e&2&&g("ngIf",i.isOpen())},dependencies:[F,Z,V,W,j,oe,se,le,z,re,te,ae,R,ne,me,ce,de,H,ie,ee,$,A],styles:['.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000;padding:20px}.modal-content[_ngcontent-%COMP%]{background:#fff;border-radius:12px;width:100%;max-width:900px;max-height:90vh;overflow-y:auto;box-shadow:0 25px 50px -12px #00000040;animation:_ngcontent-%COMP%_modalSlideIn .3s ease-out}@keyframes _ngcontent-%COMP%_modalSlideIn{0%{opacity:0;transform:scale(.95) translateY(-20px)}to{opacity:1;transform:scale(1) translateY(0)}}.modal-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:24px 24px 0;border-bottom:1px solid #e5e7eb;margin-bottom:24px}.modal-title[_ngcontent-%COMP%]{font-size:20px;font-weight:600;color:#111827;margin:0}.close-btn[_ngcontent-%COMP%]{background:none;border:none;color:#6b7280;cursor:pointer;padding:8px;border-radius:6px;transition:all .2s ease;display:flex;align-items:center;justify-content:center}.close-btn[_ngcontent-%COMP%]:hover{background:#f3f4f6;color:#374151}.modal-form[_ngcontent-%COMP%]{padding:0 24px 24px}.form-group[_ngcontent-%COMP%]{margin-bottom:20px}.duration-input-group[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;flex-wrap:wrap}.duration-input[_ngcontent-%COMP%]{width:60px!important;text-align:center}.duration-label[_ngcontent-%COMP%]{font-size:12px;color:#6b7280;font-weight:500}.form-hint[_ngcontent-%COMP%]{display:block;margin-top:4px;font-size:11px;color:#6b7280;font-style:italic}.form-label[_ngcontent-%COMP%]{display:block;margin-bottom:6px;font-weight:500;color:#374151;font-size:14px}.form-input[_ngcontent-%COMP%]{width:100%;padding:10px 12px;border:1px solid #d1d5db;border-radius:8px;font-size:14px;transition:all .2s ease;background:#fff;box-sizing:border-box;font-family:inherit}.form-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.form-input[_ngcontent-%COMP%]::placeholder{color:#9ca3af}textarea.form-input[_ngcontent-%COMP%]{resize:vertical;min-height:80px;line-height:1.5}.title-textarea[_ngcontent-%COMP%]{resize:none!important;overflow:hidden;min-height:auto!important;line-height:1.4;font-size:16px;font-weight:500}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:16px}select.form-input[_ngcontent-%COMP%]{cursor:pointer}.priority-select[_ngcontent-%COMP%]{appearance:none;-webkit-appearance:none;-moz-appearance:none;padding-right:2rem}.priority-select.priority-low[_ngcontent-%COMP%]{border-color:#10b981;box-shadow:0 0 0 2px #10b98126}.priority-select.priority-medium[_ngcontent-%COMP%]{border-color:#f59e0b;box-shadow:0 0 0 2px #f59e0b26}.priority-select.priority-high[_ngcontent-%COMP%]{border-color:#ef4444;box-shadow:0 0 0 2px #ef444426}.modal-actions[_ngcontent-%COMP%]{display:flex;gap:12px;justify-content:flex-end;margin-top:32px;padding-top:20px;border-top:1px solid #e5e7eb}.btn[_ngcontent-%COMP%]{padding:10px 20px;border:none;border-radius:8px;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s ease;display:flex;align-items:center;gap:8px;min-width:100px;justify-content:center}.btn-primary[_ngcontent-%COMP%]{background:#3b82f6;color:#fff;box-shadow:0 1px 2px #0000000d}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background:#2563eb;box-shadow:0 4px 6px -1px #0000001a,0 2px 4px -1px #0000000f}.btn-primary[_ngcontent-%COMP%]:disabled{background:#9ca3af;cursor:not-allowed;box-shadow:none}.btn-secondary[_ngcontent-%COMP%]{background:#f3f4f6;color:#374151;border:1px solid #d1d5db}.btn-secondary[_ngcontent-%COMP%]:hover{background:#e5e7eb;border-color:#9ca3af}.tags-input-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.tags-display[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:6px;min-height:24px}.tag-chip[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:4px;padding:4px 8px;border-radius:12px;font-size:.75rem;font-weight:500;white-space:nowrap;border:1px solid rgba(255,255,255,.2)}.tag-remove[_ngcontent-%COMP%]{background:none;border:none;color:inherit;cursor:pointer;font-size:.875rem;font-weight:700;padding:0;margin:0;width:16px;height:16px;border-radius:50%;display:flex;align-items:center;justify-content:center;opacity:.7;transition:opacity .2s ease}.tag-remove[_ngcontent-%COMP%]:hover{opacity:1;background:#fff3}.tags-input[_ngcontent-%COMP%]{margin-top:0}@media (max-width: 640px){.modal-overlay[_ngcontent-%COMP%]{padding:10px}.modal-content[_ngcontent-%COMP%]{max-width:100%;border-radius:8px}.modal-header[_ngcontent-%COMP%]{padding:20px 20px 0}.modal-form[_ngcontent-%COMP%]{padding:0 20px 20px}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:12px}.modal-actions[_ngcontent-%COMP%]{flex-direction:column}.btn[_ngcontent-%COMP%]{width:100%}.working-sessions-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:.75rem}.start-work-btn[_ngcontent-%COMP%], .stop-work-btn[_ngcontent-%COMP%], .finish-work-btn[_ngcontent-%COMP%]{font-size:.8rem;padding:.4rem .8rem}}.checkbox-group[_ngcontent-%COMP%]{margin-bottom:1rem}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;cursor:pointer;font-weight:500;color:var(--text-primary);gap:.5rem}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{margin:0;width:18px;height:18px;accent-color:var(--primary-color);cursor:pointer}.checkmark[_ngcontent-%COMP%]{font-size:1rem}.recurring-options[_ngcontent-%COMP%]{background:#f8fafc;border:1px solid #e2e8f0;border-radius:8px;padding:1rem;margin-top:.75rem;animation:_ngcontent-%COMP%_slideDown .2s ease-out}@keyframes _ngcontent-%COMP%_slideDown{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.repeat-input-group[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:center}.repeat-interval[_ngcontent-%COMP%]{width:80px;flex-shrink:0}.repeat-type[_ngcontent-%COMP%]{flex:1;min-width:120px}.recurring-options[_ngcontent-%COMP%]   .form-hint[_ngcontent-%COMP%]{color:#059669;font-weight:500;background:#10b9811a;padding:.5rem;border-radius:4px;border-left:3px solid #10b981;margin-top:.75rem}.date-input-group[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.date-input-group[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]{flex:1}.btn-now[_ngcontent-%COMP%]{min-width:auto;padding:10px 12px}.working-sessions-section[_ngcontent-%COMP%]{margin-top:2rem;padding-top:1.5rem;border-top:1px solid var(--border-color)}.working-sessions-section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]{margin:0 0 1rem;font-size:1.1rem;font-weight:600;color:var(--text-color);display:flex;align-items:center;gap:.5rem}.working-sessions-section[_ngcontent-%COMP%]   .section-title[_ngcontent-%COMP%]:before{content:"\\23f1\\fe0f";font-size:1.2rem}.working-sessions-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem;flex-wrap:wrap;gap:1rem}.start-work-btn[_ngcontent-%COMP%], .stop-work-btn[_ngcontent-%COMP%], .finish-work-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.5rem 1rem;font-size:.875rem;font-weight:500;border:none;border-radius:6px;cursor:pointer;transition:all .2s ease;white-space:nowrap}.start-work-btn[_ngcontent-%COMP%]{background:#10b981;color:#fff}.start-work-btn[_ngcontent-%COMP%]:hover{background:#059669;transform:translateY(-1px);box-shadow:0 4px 8px #10b9814d}.stop-work-btn[_ngcontent-%COMP%]{background:#f59e0b;color:#fff}.stop-work-btn[_ngcontent-%COMP%]:hover{background:#d97706;transform:translateY(-1px);box-shadow:0 4px 8px #f59e0b4d}.finish-work-btn[_ngcontent-%COMP%]{background:#3b82f6;color:#fff}.finish-work-btn[_ngcontent-%COMP%]:hover{background:#2563eb;transform:translateY(-1px);box-shadow:0 4px 8px #3b82f64d}@keyframes _ngcontent-%COMP%_pulse{0%,to{opacity:1;transform:scale(1)}50%{opacity:.7;transform:scale(1.1)}}']})};export{he as a};
