import{A as me,e as U,h as q,i as Q,j as Y,k as G,l as J,m as X,n as Z,o as $,p as ee,r as te,s as ne,t as ie,u as re,v as ae,w as oe,x as se,z as de}from"./chunk-RVASHVHN.js";import{$ as d,$b as A,Ga as F,Ib as z,Ka as T,Ma as S,W as C,Xa as u,Ya as o,Za as s,Zb as N,_a as M,_b as B,aa as m,ba as I,c as P,ca as O,cb as w,db as _,dc as K,eb as l,gb as W,hb as H,ib as L,ja as V,kb as j,kc as le,la as R,lc as ce,mc as pe,nb as c,ob as g,pb as f,tb as h,ub as x,vb as v,wa as a,zb as E}from"./chunk-NENYJKRB.js";var ge=["titleTextarea"],_e=p=>["/project",p],fe=p=>({highlightTask:p});function he(p,n){if(p&1){let e=w();o(0,"span",49),c(1),o(2,"button",50),_("click",function(){let t=d(e).index,i=l(2);return m(i.removeTag(t))}),c(3,"\xD7"),s()()}if(p&2){let e=n.$implicit,r=l(2);j("background-color",r.getTagColor(e))("color",r.getTagTextColor(e)),a(),f(" ",e," "),a(),u("title",r.translations().removeTag)}}function xe(p,n){if(p&1&&M(0,"option",51),p&2){let e=n.$implicit;u("value",e.name)}}function ve(p,n){if(p&1&&(o(0,"option",53),c(1),s()),p&2){let e=n.$implicit;u("ngValue",e.id),a(),g(e.name)}}function ye(p,n){if(p&1&&(o(0,"small",28),c(1),s()),p&2){let e=l(3);a(),g(e.translations().subtasksHint)}}function De(p,n){if(p&1){let e=w();o(0,"div",14)(1,"div",10)(2,"label",11),c(3),s(),o(4,"select",52),v("ngModelChange",function(t){d(e);let i=l(2);return x(i.formData.projectId,t)||(i.formData.projectId=t),m(t)}),o(5,"option",53),c(6),s(),T(7,ve,2,2,"option",54),s(),T(8,ye,2,1,"small",55),s()()}if(p&2){let e=l(2);a(3),g(e.translations().project),a(),h("ngModel",e.formData.projectId),u("disabled",e.isSubtask)("title",e.translations().subtasksUseParentProject),a(),u("ngValue",void 0),a(),g(e.translations().noProject),a(),u("ngForOf",e.projectService.activeProjects()),a(),u("ngIf",e.isSubtask)}}function Te(p,n){if(p&1){let e=w();o(0,"div",61)(1,"div",14)(2,"div",10)(3,"label",11),c(4),s(),o(5,"div",62)(6,"input",63),v("ngModelChange",function(t){d(e);let i=l(3);return x(i.formData.recurrenceInterval,t)||(i.formData.recurrenceInterval=t),m(t)}),s(),o(7,"select",64),v("ngModelChange",function(t){d(e);let i=l(3);return x(i.formData.recurrenceType,t)||(i.formData.recurrenceType=t),m(t)}),o(8,"option",65),c(9),s(),o(10,"option",66),c(11),s(),o(12,"option",67),c(13),s()()()()(),o(14,"div",14)(15,"div",10)(16,"label",11),c(17),s(),o(18,"input",68),v("ngModelChange",function(t){d(e);let i=l(3);return x(i.formData.recurrenceEndDate,t)||(i.formData.recurrenceEndDate=t),m(t)}),s()(),o(19,"div",10)(20,"label",11),c(21),s(),o(22,"input",69),v("ngModelChange",function(t){d(e);let i=l(3);return x(i.formData.recurrenceMaxOccurrences,t)||(i.formData.recurrenceMaxOccurrences=t),m(t)}),s()()(),o(23,"small",28),c(24),s()()}if(p&2){let e=l(3);a(4),g(e.translations().repeatEvery),a(2),h("ngModel",e.formData.recurrenceInterval),a(),h("ngModel",e.formData.recurrenceType),a(2),g(e.formData.recurrenceInterval===1?e.translations().day:e.translations().days),a(2),g(e.formData.recurrenceInterval===1?e.translations().week:e.translations().weeks),a(2),g(e.formData.recurrenceInterval===1?e.translations().month:e.translations().months),a(4),g(e.translations().endRecurrence),a(),h("ngModel",e.formData.recurrenceEndDate),u("placeholder",e.translations().noEndDate),a(3),g(e.translations().maxOccurrences),a(),h("ngModel",e.formData.recurrenceMaxOccurrences),u("placeholder",e.translations().unlimited),a(2),f(" \u{1F4C5} ",e.getRecurrencePreview()," ")}}function we(p,n){if(p&1){let e=w();o(0,"div",10)(1,"div",56)(2,"label",57)(3,"input",58),v("ngModelChange",function(t){d(e);let i=l(2);return x(i.formData.isRecurring,t)||(i.formData.isRecurring=t),m(t)}),_("change",function(){d(e);let t=l(2);return m(t.onRecurringToggle())}),s(),M(4,"span",59),c(5),s()(),T(6,Te,25,13,"div",60),s()}if(p&2){let e=l(2);a(3),h("ngModel",e.formData.isRecurring),a(2),f(" \u{1F504} ",e.translations().makeRecurring," "),a(),u("ngIf",e.formData.isRecurring)}}function Ce(p,n){if(p&1){let e=w();o(0,"a",70),_("click",function(){d(e);let t=l(2);return m(t.onClose())}),c(1),s()}if(p&2){let e=l(2);u("routerLink",E(3,_e,e.todo==null?null:e.todo.projectId))("queryParams",E(5,fe,e.todo==null?null:e.todo.id)),a(),f(" ",e.translations().goToProject," ")}}function ke(p,n){if(p&1){let e=w();o(0,"div",2),_("click",function(t){d(e);let i=l();return m(i.onOverlayClick(t))}),o(1,"div",3),_("click",function(t){return d(e),m(t.stopPropagation())}),o(2,"div",4)(3,"h2",5),c(4),s(),o(5,"button",6),_("click",function(){d(e);let t=l();return m(t.onClose())}),I(),o(6,"svg",7),M(7,"path",8),s()()(),O(),o(8,"form",9),_("ngSubmit",function(){d(e);let t=l();return m(t.onSubmit())}),o(9,"div",10)(10,"label",11),c(11),s(),o(12,"textarea",12,0),v("ngModelChange",function(t){d(e);let i=l();return x(i.formData.title,t)||(i.formData.title=t),m(t)}),_("input",function(t){d(e);let i=l();return m(i.onTitleInput(t))})("keydown",function(t){d(e);let i=l();return m(i.onTitleKeydown(t))}),s()(),o(15,"div",10)(16,"label",11),c(17),s(),o(18,"textarea",13),v("ngModelChange",function(t){d(e);let i=l();return x(i.formData.description,t)||(i.formData.description=t),m(t)}),_("keydown",function(t){d(e);let i=l();return m(i.onTextareaKeydown(t))}),s()(),o(19,"div",14)(20,"div",10)(21,"label",11),c(22),s(),o(23,"select",15),v("ngModelChange",function(t){d(e);let i=l();return x(i.formData.priority,t)||(i.formData.priority=t),m(t)}),_("ngModelChange",function(t){d(e);let i=l();return m(i.onPriorityChange(t))}),o(24,"option",16),c(25),s(),o(26,"option",17),c(27),s(),o(28,"option",18),c(29),s()()(),o(30,"div",10)(31,"label",11),c(32),s(),o(33,"div",19)(34,"input",20),v("ngModelChange",function(t){d(e);let i=l();return x(i.formData.dueDate,t)||(i.formData.dueDate=t),m(t)}),_("keydown",function(t){d(e);let i=l();return m(i.onDateTimeKeydown(t,"dueDate"))}),s(),o(35,"button",21),_("click",function(){d(e);let t=l();return m(t.setDueDateToNow())}),c(36),s()()()(),o(37,"div",14)(38,"div",10)(39,"label",11),c(40),s(),o(41,"div",19)(42,"input",22),v("ngModelChange",function(t){d(e);let i=l();return x(i.formData.startDateTime,t)||(i.formData.startDateTime=t),m(t)}),_("change",function(){d(e);let t=l();return m(t.onStartDateTimeChange())})("keydown",function(t){d(e);let i=l();return m(i.onDateTimeKeydown(t,"startDateTime"))}),s(),o(43,"button",21),_("click",function(){d(e);let t=l();return m(t.setStartDateTimeToNow())}),c(44),s()()(),o(45,"div",10)(46,"label",11),c(47),s(),o(48,"div",19)(49,"input",23),v("ngModelChange",function(t){d(e);let i=l();return x(i.formData.endDateTime,t)||(i.formData.endDateTime=t),m(t)}),_("change",function(){d(e);let t=l();return m(t.onEndDateTimeChange())})("keydown",function(t){d(e);let i=l();return m(i.onDateTimeKeydown(t,"endDateTime"))}),s(),o(50,"button",21),_("click",function(){d(e);let t=l();return m(t.setEndDateTimeToNow())}),c(51),s()()()(),o(52,"div",14)(53,"div",10)(54,"label",11),c(55),s(),o(56,"div",24)(57,"input",25),v("ngModelChange",function(t){d(e);let i=l();return x(i.formData.durationHours,t)||(i.formData.durationHours=t),m(t)}),_("change",function(){d(e);let t=l();return m(t.onDurationChange())}),s(),o(58,"span",26),c(59),s(),o(60,"input",27),v("ngModelChange",function(t){d(e);let i=l();return x(i.formData.durationMinutes,t)||(i.formData.durationMinutes=t),m(t)}),_("change",function(){d(e);let t=l();return m(t.onDurationChange())}),s(),o(61,"span",26),c(62),s()(),o(63,"small",28),c(64),s()()(),o(65,"div",10)(66,"label",11),c(67),s(),o(68,"input",29),v("ngModelChange",function(t){d(e);let i=l();return x(i.formData.category,t)||(i.formData.category=t),m(t)}),s(),o(69,"datalist",30)(70,"option",31),c(71),s(),o(72,"option",32),c(73),s(),o(74,"option",33),c(75),s(),o(76,"option",34),c(77),s(),o(78,"option",35),c(79),s(),o(80,"option",36),c(81),s()()(),o(82,"div",10)(83,"label",11),c(84),s(),o(85,"div",37)(86,"div",38),T(87,he,4,6,"span",39),s(),o(88,"input",40),v("ngModelChange",function(t){d(e);let i=l();return x(i.tagInput,t)||(i.tagInput=t),m(t)}),_("keydown",function(t){d(e);let i=l();return m(i.onTagInputKeydown(t))})("blur",function(){d(e);let t=l();return m(t.addTagFromInput())}),s(),o(89,"datalist",41),T(90,xe,1,1,"option",42),s()(),o(91,"small",28),c(92),s()(),T(93,De,9,8,"div",43)(94,we,7,3,"div",44),o(95,"div",45),T(96,Ce,2,7,"a",46),o(97,"button",47),_("click",function(){d(e);let t=l();return m(t.onClose())}),c(98),s(),o(99,"button",48),c(100),s()()()()()}if(p&2){let e=l();a(4),g(e.isEditing?e.translations().editTask:e.translations().createTask),a(7),f("",e.translations().taskTitle," *"),a(),h("ngModel",e.formData.title),u("placeholder",e.translations().enterTaskTitle),a(5),g(e.translations().description),a(),h("ngModel",e.formData.description),u("placeholder",e.translations().enterTaskDescription),a(4),g(e.translations().priority),a(),u("ngClass","priority-"+e.formData.priority),h("ngModel",e.formData.priority),a(2),f("\u{1F7E2} ",e.translations().priorityLow),a(2),f("\u{1F7E1} ",e.translations().priorityMedium),a(2),f("\u{1F534} ",e.translations().priorityHigh),a(3),g(e.translations().dueDate),a(2),h("ngModel",e.formData.dueDate),u("min",e.today),a(2),g(e.translations().now),a(4),g(e.translations().startDateTime),a(2),h("ngModel",e.formData.startDateTime),u("min",e.today),a(2),g(e.translations().now),a(3),g(e.translations().endDateTime),a(2),h("ngModel",e.formData.endDateTime),u("min",e.formData.startDateTime||e.today),a(2),g(e.translations().now),a(4),g(e.translations().duration),a(2),h("ngModel",e.formData.durationHours),a(2),g(e.translations().hours),a(),h("ngModel",e.formData.durationMinutes),a(2),g(e.translations().minutes),a(2),g(e.translations().durationHint),a(3),g(e.translations().category),a(),h("ngModel",e.formData.category),u("placeholder",e.translations().categoryPlaceholder),a(3),f("",e.translations().work," "),a(2),f("",e.translations().personal," "),a(2),f("",e.translations().development," "),a(2),f("",e.translations().design," "),a(2),f("",e.translations().meeting," "),a(2),f("",e.translations().research," "),a(3),g(e.translations().tags),a(3),u("ngForOf",e.formData.tags),a(),h("ngModel",e.tagInput),u("placeholder",e.translations().tagsPlaceholder),a(2),u("ngForOf",e.tagsService.tags()),a(2),g(e.translations().tagsHint),a(),u("ngIf",!e.isSubtask||e.todo),a(),u("ngIf",!e.isSubtask),a(2),u("ngIf",e.todo==null?null:e.todo.projectId),a(2),f(" ",e.translations().cancel," "),a(),u("disabled",!e.formData.title.trim()),a(),f(" ",e.isEditing?e.translations().updateTask:e.translations().createTask," ")}}var ue=class p{projectService=C(le);tagsService=C(pe);recurringTasksService=C(de);settingsService=C(me);translationService=C(ce);translations=z(()=>({editTask:this.translationService.translate("taskEditor.editTask"),createTask:this.translationService.translate("taskEditor.createTask"),updateTask:this.translationService.translate("taskEditor.updateTask"),cancel:this.translationService.translate("actions.cancel"),goToProject:this.translationService.translate("taskEditor.goToProject"),taskTitle:this.translationService.translate("taskEditor.taskTitle"),enterTaskTitle:this.translationService.translate("taskEditor.enterTaskTitle"),addTaskDescription:this.translationService.translate("taskEditor.addTaskDescription"),enterTaskDescription:this.translationService.translate("taskEditor.enterTaskDescription"),priorityLow:this.translationService.translate("priority.low"),priorityMedium:this.translationService.translate("priority.medium"),priorityHigh:this.translationService.translate("priority.high"),dueDate:this.translationService.translate("tasks.dueDate"),startDateTime:this.translationService.translate("tasks.startDateTime"),endDateTime:this.translationService.translate("tasks.endDateTime"),duration:this.translationService.translate("tasks.duration"),now:this.translationService.translate("time.now"),hours:this.translationService.translate("time.hours"),minutes:this.translationService.translate("time.minutes"),category:this.translationService.translate("tasks.category"),work:this.translationService.translate("categories.work"),personal:this.translationService.translate("categories.personal"),development:this.translationService.translate("categories.development"),design:this.translationService.translate("categories.design"),meeting:this.translationService.translate("categories.meeting"),research:this.translationService.translate("categories.research"),tags:this.translationService.translate("tasks.tags"),removeTag:this.translationService.translate("todoItem.removeTag"),project:this.translationService.translate("tasks.project"),subtasksUseParentProject:this.translationService.translate("taskEditor.subtasksUseParentProject"),endRecurrence:this.translationService.translate("taskEditor.endRecurrence"),maxOccurrences:this.translationService.translate("taskEditor.maxOccurrences"),noEndDate:this.translationService.translate("taskEditor.noEndDate"),unlimited:this.translationService.translate("taskEditor.unlimited"),day:this.translationService.translate("time.day"),days:this.translationService.translate("time.days"),week:this.translationService.translate("time.week"),weeks:this.translationService.translate("time.weeks"),month:this.translationService.translate("time.month"),months:this.translationService.translate("time.months"),priority:this.translationService.translate("tasks.priority"),description:this.translationService.translate("tasks.description"),noProject:this.translationService.translate("common.noProject"),durationHint:this.translationService.translate("taskEditor.durationHint"),categoryPlaceholder:this.translationService.translate("taskEditor.categoryPlaceholder"),tagsPlaceholder:this.translationService.translate("taskEditor.tagsPlaceholder"),tagsHint:this.translationService.translate("taskEditor.tagsHint"),subtasksHint:this.translationService.translate("taskEditor.subtasksHint"),makeRecurring:this.translationService.translate("taskEditor.makeRecurring"),repeatEvery:this.translationService.translate("taskEditor.repeatEvery"),recurrencePreview:this.translationService.translate("taskEditor.recurrencePreview")}));todo=null;isSubtask=!1;defaultProjectId;save=new S;close=new S;titleTextareaRef;isOpenSignal=V(!1);isOpen=this.isOpenSignal.asReadonly();tagInput="";get today(){let n=new Date;return n.setMinutes(n.getMinutes()-n.getTimezoneOffset()),n.toISOString().slice(0,16)}isEditing=!1;formData={title:"",description:"",priority:this.settingsService.getDefaultPriorityForNewTask(),dueDate:"",startDateTime:"",endDateTime:"",durationHours:0,durationMinutes:0,category:"",completed:!1,archived:!1,tags:[],isRecurring:!1,recurrenceType:"daily",recurrenceInterval:1,recurrenceEndDate:"",recurrenceMaxOccurrences:null};onKeydown(){this.onClose()}isMouseDownInsideModal=!1;onMousedown(n){let e=n.target;this.isMouseDownInsideModal=!!e.closest(".modal-content"),n.stopPropagation()}onMouseup(n){setTimeout(()=>{this.isMouseDownInsideModal=!1},0)}ngAfterViewInit(){this.isOpen()&&this.formData.title&&(setTimeout(()=>this.resizeTitleTextarea(),0),setTimeout(()=>this.resizeTitleTextarea(),100))}ngOnChanges(n){if(n.todo&&n.todo.currentValue){if(this.isEditing=!0,this.todo){let e=this.todo.duration?Math.floor(this.todo.duration/60):0,r=this.todo.duration?this.todo.duration%60:0;this.formData={title:this.todo.title,description:this.todo.description||"",priority:this.todo.priority,dueDate:this.todo.dueDate?this.formatDateForInput(this.todo.dueDate):"",startDateTime:this.todo.startDateTime?this.formatDateForInput(this.todo.startDateTime):"",endDateTime:this.todo.endDateTime?this.formatDateForInput(this.todo.endDateTime):"",durationHours:e,durationMinutes:r,category:this.todo.category||"",projectId:this.todo.projectId,completed:this.todo.completed,archived:this.todo.archived,tags:this.todo.tags?[...this.todo.tags]:[],isRecurring:this.todo.isRecurring||!1,recurrenceType:this.todo.recurrencePattern?.type||"daily",recurrenceInterval:this.todo.recurrencePattern?.interval||1,recurrenceEndDate:this.todo.recurrencePattern?.endDate?this.formatDateForInput(this.todo.recurrencePattern.endDate):"",recurrenceMaxOccurrences:this.todo.recurrencePattern?.maxOccurrences||null},setTimeout(()=>this.resizeTitleTextarea(),0),setTimeout(()=>this.resizeTitleTextarea(),100)}}else this.defaultProjectId?(this.isEditing=!1,this.resetForm(),this.formData.projectId=this.defaultProjectId):(this.isEditing=!1,this.resetForm())}open(){this.isOpenSignal.set(!0),setTimeout(()=>{let n=document.querySelector('.modal-content textarea[name="title"]');n&&(this.autoResizeTextarea(n),n.focus())},100)}onOverlayClick(n){n.target===n.currentTarget&&!this.isMouseDownInsideModal&&this.onClose(),this.isMouseDownInsideModal=!1}onClose(){this.close.emit(),this.isOpenSignal.set(!1)}onSubmit(){return P(this,null,function*(){if(!this.formData.title.trim())return;let n=(this.formData.durationHours||0)*60+(this.formData.durationMinutes||0),e={title:this.formData.title.trim(),description:this.formData.description.trim()||void 0,priority:this.formData.priority,dueDate:this.formData.dueDate?new Date(this.formData.dueDate):void 0,startDateTime:this.formData.startDateTime?new Date(this.formData.startDateTime):void 0,endDateTime:this.formData.endDateTime?new Date(this.formData.endDateTime):void 0,duration:n>0?n:void 0,category:this.formData.category.trim()||void 0,projectId:this.formData.projectId,completed:this.formData.completed,tags:this.formData.tags.length>0?this.formData.tags:void 0};if(this.formData.isRecurring&&!this.isSubtask){let r={type:this.formData.recurrenceType,interval:this.formData.recurrenceInterval,endDate:this.formData.recurrenceEndDate?new Date(this.formData.recurrenceEndDate):void 0,maxOccurrences:this.formData.recurrenceMaxOccurrences||void 0,currentOccurrences:0};e.isRecurring=!0,e.recurrencePattern=r;let t=e.dueDate||new Date;e.nextDueDate=this.recurringTasksService.calculateNextDueDate(t,r)}else!this.formData.isRecurring&&this.isEditing&&this.todo?.isRecurring&&(e.isRecurring=!1,e.recurrencePattern=void 0,e.nextDueDate=void 0);!this.isEditing&&this.settingsService.useLastChosenPriority&&this.saveLastUsedPriority(this.formData.priority),this.save.emit(e)})}resetForm(){this.formData={title:"",description:"",priority:this.settingsService.getDefaultPriorityForNewTask(),dueDate:"",startDateTime:"",endDateTime:"",durationHours:0,durationMinutes:0,category:"",projectId:void 0,completed:!1,archived:!1,tags:[],isRecurring:!1,recurrenceType:"daily",recurrenceInterval:1,recurrenceEndDate:"",recurrenceMaxOccurrences:null}}getLastUsedPriority(){try{let n=localStorage.getItem("taskEditor.lastPriority");if(n&&["low","medium","high"].includes(n))return n}catch(n){console.warn("Failed to load last used priority from localStorage:",n)}return"medium"}saveLastUsedPriority(n){try{localStorage.setItem("taskEditor.lastPriority",n)}catch(e){console.warn("Failed to save last used priority to localStorage:",e)}}closeAndReset(){this.isOpenSignal.set(!1),this.resetForm()}setDueDateToNow(){this.formData.dueDate=this.formatDateForInput(new Date)}setStartDateTimeToNow(){this.formData.startDateTime=this.formatDateForInput(new Date),this.onStartDateTimeChange()}setEndDateTimeToNow(){this.formData.endDateTime=this.formatDateForInput(new Date),this.onEndDateTimeChange()}onStartDateTimeChange(){if(!this.formData.startDateTime){this.formData.endDateTime="";return}this.calculateDurationFromDates()}onEndDateTimeChange(){this.calculateDurationFromDates()}onDurationChange(){if(this.formData.startDateTime&&(this.formData.durationHours||this.formData.durationMinutes)){let n=new Date(this.formData.startDateTime),e=(this.formData.durationHours||0)*60+(this.formData.durationMinutes||0),r=new Date(n.getTime()+e*6e4),t=new Date(r.getTime()-r.getTimezoneOffset()*6e4).toISOString().slice(0,16);this.formData.endDateTime=t}}onPriorityChange(n){!this.isEditing&&this.settingsService.useLastChosenPriority&&this.saveLastUsedPriority(n)}calculateDurationFromDates(){if(this.formData.startDateTime&&this.formData.endDateTime){let n=new Date(this.formData.startDateTime),e=new Date(this.formData.endDateTime);if(e>n){let r=e.getTime()-n.getTime(),t=Math.floor(r/(1e3*60));this.formData.durationHours=Math.floor(t/60),this.formData.durationMinutes=t%60}}}formatDateForInput(n){let e=new Date(n);return e.setMinutes(e.getMinutes()-e.getTimezoneOffset()),e.toISOString().slice(0,16)}onTagInputKeydown(n){(n.key==="Enter"||n.key===",")&&(n.preventDefault(),this.addTagFromInput())}addTagFromInput(){if(!this.tagInput.trim())return;let n=[];this.tagInput.includes("#")?n=this.tagsService.parseTagsFromText(this.tagInput):n=this.tagInput.split(",").map(e=>e.trim()).filter(e=>e.length>0);for(let e of n)this.addTag(e);this.tagInput=""}addTag(n){let e=n.trim().toLowerCase();e&&!this.formData.tags.includes(e)&&(this.formData.tags.push(e),this.tagsService.autoCreateTags([e]))}removeTag(n){this.formData.tags.splice(n,1)}getTagColor(n){return this.tagsService.getTagByName(n)?.color||"#6b7280"}getTagTextColor(n){let r=this.getTagColor(n).replace("#",""),t=parseInt(r.substr(0,2),16),i=parseInt(r.substr(2,2),16),y=parseInt(r.substr(4,2),16);return(t*299+i*587+y*114)/1e3>128?"#000000":"#ffffff"}onRecurringToggle(){this.formData.isRecurring||(this.formData.recurrenceType="daily",this.formData.recurrenceInterval=1,this.formData.recurrenceEndDate="",this.formData.recurrenceMaxOccurrences=null)}getRecurrencePreview(){if(!this.formData.isRecurring)return"";let n=this.formData.recurrenceInterval===1?"":`${this.formData.recurrenceInterval} `,e=this.formData.recurrenceType==="daily"?"day":this.formData.recurrenceType==="weekly"?"week":"month",r=this.formData.recurrenceInterval===1?"":"s",t=`Repeats every ${n}${e}${r}`;if(this.formData.recurrenceEndDate){let i=new Date(this.formData.recurrenceEndDate).toLocaleDateString();t+=` until ${i}`}return this.formData.recurrenceMaxOccurrences&&(t+=` (max ${this.formData.recurrenceMaxOccurrences} occurrences)`),t}onTextareaKeydown(n){if(n.key==="Tab"){n.preventDefault();let e=n.target,r=e.selectionStart,t=e.selectionEnd,i="  ",y=e.value,D=y.substring(0,r)+i+y.substring(t);this.formData.description=D,setTimeout(()=>{e.selectionStart=e.selectionEnd=r+i.length},0)}}onTitleInput(n){let e=n.target;this.autoResizeTextarea(e)}onTitleKeydown(n){n.key==="Enter"&&(n.preventDefault(),this.onSubmit())}autoResizeTextarea(n){n.style.height="auto",n.style.height=n.scrollHeight+"px"}resizeTitleTextarea(){if(this.titleTextareaRef?.nativeElement)this.autoResizeTextarea(this.titleTextareaRef.nativeElement);else{let n=document.querySelector(".title-textarea");n&&this.autoResizeTextarea(n)}}onDateTimeKeydown(n,e){if(n.key==="ArrowUp"||n.key==="ArrowDown"){let r=n.target,t=r.value;if(!t)return;let i=r.selectionStart||0,y=t.lastIndexOf(":");if(console.log("DateTime keydown debug:",{key:n.key,currentValue:t,cursorPosition:i,minutesStartIndex:y,inMinutesField:i>y}),i>y){let D=new Date(t),b=D.getMinutes();if(console.log("Current minutes:",b),n.key==="ArrowUp"&&b===59){console.log("Handling ArrowUp at 59 minutes"),n.preventDefault(),n.stopPropagation(),D.setHours(D.getHours()+1),D.setMinutes(0);let k=this.formatDateForInput(D);console.log("Setting new value:",k),this.updateFormField(e,k),setTimeout(()=>{r.setSelectionRange(y+1,y+3)},10)}else if(n.key==="ArrowDown"&&b===0){console.log("Handling ArrowDown at 0 minutes"),n.preventDefault(),n.stopPropagation(),D.setHours(D.getHours()-1),D.setMinutes(59);let k=this.formatDateForInput(D);console.log("Setting new value:",k),this.updateFormField(e,k),setTimeout(()=>{r.setSelectionRange(y+1,y+3)},10)}}}}updateFormField(n,e){this.formData[n]=e,n==="startDateTime"?this.onStartDateTimeChange():n==="endDateTime"&&this.onEndDateTimeChange()}static \u0275fac=function(e){return new(e||p)};static \u0275cmp=F({type:p,selectors:[["app-task-editor"]],viewQuery:function(e,r){if(e&1&&W(ge,5),e&2){let t;H(t=L())&&(r.titleTextareaRef=t.first)}},hostBindings:function(e,r){e&1&&_("keydown.escape",function(){return r.onKeydown()})("mousedown",function(i){return r.onMousedown(i)})("mouseup",function(i){return r.onMouseup(i)})},inputs:{todo:"todo",isSubtask:"isSubtask",defaultProjectId:"defaultProjectId"},outputs:{save:"save",close:"close"},features:[R],decls:1,vars:1,consts:[["titleInput","","titleTextarea",""],["class","modal-overlay",3,"click",4,"ngIf"],[1,"modal-overlay",3,"click"],[1,"modal-content",3,"click"],[1,"modal-header"],[1,"modal-title"],["type","button",1,"close-btn",3,"click"],["width","20","height","20","viewBox","0 0 20 20","fill","currentColor"],["d","M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"],[1,"modal-form",3,"ngSubmit"],[1,"form-group"],[1,"form-label"],["name","title","required","","rows","1",1,"form-input","title-textarea",3,"ngModelChange","input","keydown","ngModel","placeholder"],["name","description","rows","3",1,"form-input",3,"ngModelChange","keydown","ngModel","placeholder"],[1,"form-row"],["name","priority",1,"form-input","priority-select",3,"ngModelChange","ngClass","ngModel"],["value","low"],["value","medium"],["value","high"],[1,"date-input-group"],["type","datetime-local","name","dueDate",1,"form-input",3,"ngModelChange","keydown","ngModel","min"],["type","button",1,"btn","btn-secondary","btn-now",3,"click"],["type","datetime-local","name","startDateTime",1,"form-input",3,"ngModelChange","change","keydown","ngModel","min"],["type","datetime-local","name","endDateTime",1,"form-input",3,"ngModelChange","change","keydown","ngModel","min"],[1,"duration-input-group"],["type","number","name","durationHours","placeholder","0","min","0","max","23",1,"form-input","duration-input",3,"ngModelChange","change","ngModel"],[1,"duration-label"],["type","number","name","durationMinutes","placeholder","0","min","0","max","59",1,"form-input","duration-input",3,"ngModelChange","change","ngModel"],[1,"form-hint"],["type","text","name","category","list","categories",1,"form-input",3,"ngModelChange","ngModel","placeholder"],["id","categories"],["value","Work"],["value","Personal"],["value","Development"],["value","Design"],["value","Meeting"],["value","Research"],[1,"tags-input-container"],[1,"tags-display"],["class","tag-chip",3,"background-color","color",4,"ngFor","ngForOf"],["type","text","name","tagInput","list","existing-tags",1,"form-input","tags-input",3,"ngModelChange","keydown","blur","ngModel","placeholder"],["id","existing-tags"],[3,"value",4,"ngFor","ngForOf"],["class","form-row",4,"ngIf"],["class","form-group",4,"ngIf"],[1,"modal-actions"],["class","btn btn-secondary",3,"routerLink","queryParams","click",4,"ngIf"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"tag-chip"],["type","button",1,"tag-remove",3,"click","title"],[3,"value"],["name","projectId",1,"form-input",3,"ngModelChange","ngModel","disabled","title"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],["class","form-hint",4,"ngIf"],[1,"checkbox-group"],[1,"checkbox-label"],["type","checkbox","name","isRecurring",3,"ngModelChange","change","ngModel"],[1,"checkmark"],["class","recurring-options",4,"ngIf"],[1,"recurring-options"],[1,"repeat-input-group"],["type","number","name","recurrenceInterval","min","1","max","365",1,"form-input","repeat-interval",3,"ngModelChange","ngModel"],["name","recurrenceType",1,"form-input","repeat-type",3,"ngModelChange","ngModel"],["value","daily"],["value","weekly"],["value","monthly"],["type","date","name","recurrenceEndDate",1,"form-input",3,"ngModelChange","ngModel","placeholder"],["type","number","name","recurrenceMaxOccurrences","min","1",1,"form-input",3,"ngModelChange","ngModel","placeholder"],[1,"btn","btn-secondary",3,"click","routerLink","queryParams"]],template:function(e,r){e&1&&T(0,ke,101,52,"div",1),e&2&&u("ngIf",r.isOpen())},dependencies:[K,N,B,A,se,$,ne,ie,Y,ee,Q,te,G,J,oe,ae,re,Z,X,q,U],styles:[".modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000;padding:20px}.modal-content[_ngcontent-%COMP%]{background:#fff;border-radius:12px;width:100%;max-width:600px;max-height:90vh;overflow-y:auto;box-shadow:0 25px 50px -12px #00000040;animation:_ngcontent-%COMP%_modalSlideIn .3s ease-out}@keyframes _ngcontent-%COMP%_modalSlideIn{0%{opacity:0;transform:scale(.95) translateY(-20px)}to{opacity:1;transform:scale(1) translateY(0)}}.modal-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:24px 24px 0;border-bottom:1px solid #e5e7eb;margin-bottom:24px}.modal-title[_ngcontent-%COMP%]{font-size:20px;font-weight:600;color:#111827;margin:0}.close-btn[_ngcontent-%COMP%]{background:none;border:none;color:#6b7280;cursor:pointer;padding:8px;border-radius:6px;transition:all .2s ease;display:flex;align-items:center;justify-content:center}.close-btn[_ngcontent-%COMP%]:hover{background:#f3f4f6;color:#374151}.modal-form[_ngcontent-%COMP%]{padding:0 24px 24px}.form-group[_ngcontent-%COMP%]{margin-bottom:20px}.duration-input-group[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;flex-wrap:wrap}.duration-input[_ngcontent-%COMP%]{width:60px!important;text-align:center}.duration-label[_ngcontent-%COMP%]{font-size:12px;color:#6b7280;font-weight:500}.form-hint[_ngcontent-%COMP%]{display:block;margin-top:4px;font-size:11px;color:#6b7280;font-style:italic}.form-label[_ngcontent-%COMP%]{display:block;margin-bottom:6px;font-weight:500;color:#374151;font-size:14px}.form-input[_ngcontent-%COMP%]{width:100%;padding:10px 12px;border:1px solid #d1d5db;border-radius:8px;font-size:14px;transition:all .2s ease;background:#fff;box-sizing:border-box;font-family:inherit}.form-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.form-input[_ngcontent-%COMP%]::placeholder{color:#9ca3af}textarea.form-input[_ngcontent-%COMP%]{resize:vertical;min-height:80px;line-height:1.5}.title-textarea[_ngcontent-%COMP%]{resize:none!important;overflow:hidden;min-height:auto!important;line-height:1.4;font-size:16px;font-weight:500}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:16px}select.form-input[_ngcontent-%COMP%]{cursor:pointer}.priority-select[_ngcontent-%COMP%]{appearance:none;-webkit-appearance:none;-moz-appearance:none;padding-right:2rem}.priority-select.priority-low[_ngcontent-%COMP%]{border-color:#10b981;box-shadow:0 0 0 2px #10b98126}.priority-select.priority-medium[_ngcontent-%COMP%]{border-color:#f59e0b;box-shadow:0 0 0 2px #f59e0b26}.priority-select.priority-high[_ngcontent-%COMP%]{border-color:#ef4444;box-shadow:0 0 0 2px #ef444426}.modal-actions[_ngcontent-%COMP%]{display:flex;gap:12px;justify-content:flex-end;margin-top:32px;padding-top:20px;border-top:1px solid #e5e7eb}.btn[_ngcontent-%COMP%]{padding:10px 20px;border:none;border-radius:8px;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s ease;display:flex;align-items:center;gap:8px;min-width:100px;justify-content:center}.btn-primary[_ngcontent-%COMP%]{background:#3b82f6;color:#fff;box-shadow:0 1px 2px #0000000d}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background:#2563eb;box-shadow:0 4px 6px -1px #0000001a,0 2px 4px -1px #0000000f}.btn-primary[_ngcontent-%COMP%]:disabled{background:#9ca3af;cursor:not-allowed;box-shadow:none}.btn-secondary[_ngcontent-%COMP%]{background:#f3f4f6;color:#374151;border:1px solid #d1d5db}.btn-secondary[_ngcontent-%COMP%]:hover{background:#e5e7eb;border-color:#9ca3af}.tags-input-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.tags-display[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:6px;min-height:24px}.tag-chip[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:4px;padding:4px 8px;border-radius:12px;font-size:.75rem;font-weight:500;white-space:nowrap;border:1px solid rgba(255,255,255,.2)}.tag-remove[_ngcontent-%COMP%]{background:none;border:none;color:inherit;cursor:pointer;font-size:.875rem;font-weight:700;padding:0;margin:0;width:16px;height:16px;border-radius:50%;display:flex;align-items:center;justify-content:center;opacity:.7;transition:opacity .2s ease}.tag-remove[_ngcontent-%COMP%]:hover{opacity:1;background:#fff3}.tags-input[_ngcontent-%COMP%]{margin-top:0}@media (max-width: 640px){.modal-overlay[_ngcontent-%COMP%]{padding:10px}.modal-content[_ngcontent-%COMP%]{max-width:100%;border-radius:8px}.modal-header[_ngcontent-%COMP%]{padding:20px 20px 0}.modal-form[_ngcontent-%COMP%]{padding:0 20px 20px}.form-row[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:12px}.modal-actions[_ngcontent-%COMP%]{flex-direction:column}.btn[_ngcontent-%COMP%]{width:100%}}.checkbox-group[_ngcontent-%COMP%]{margin-bottom:1rem}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;cursor:pointer;font-weight:500;color:var(--text-primary);gap:.5rem}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{margin:0;width:18px;height:18px;accent-color:var(--primary-color);cursor:pointer}.checkmark[_ngcontent-%COMP%]{font-size:1rem}.recurring-options[_ngcontent-%COMP%]{background:#f8fafc;border:1px solid #e2e8f0;border-radius:8px;padding:1rem;margin-top:.75rem;animation:_ngcontent-%COMP%_slideDown .2s ease-out}@keyframes _ngcontent-%COMP%_slideDown{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}.repeat-input-group[_ngcontent-%COMP%]{display:flex;gap:.5rem;align-items:center}.repeat-interval[_ngcontent-%COMP%]{width:80px;flex-shrink:0}.repeat-type[_ngcontent-%COMP%]{flex:1;min-width:120px}.recurring-options[_ngcontent-%COMP%]   .form-hint[_ngcontent-%COMP%]{color:#059669;font-weight:500;background:#10b9811a;padding:.5rem;border-radius:4px;border-left:3px solid #10b981;margin-top:.75rem}.date-input-group[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.date-input-group[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]{flex:1}.btn-now[_ngcontent-%COMP%]{min-width:auto;padding:10px 12px}"]})};export{ue as a};
