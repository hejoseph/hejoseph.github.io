import{a as ie}from"./chunk-T4EC7FHI.js";import{a as re,b as L,c as ae,h as de}from"./chunk-B3DLK4UM.js";import{a as se}from"./chunk-GC3T4LN3.js";import{C as oe,h as Y,j as H,k as G,n as q,r as J,s as K,t as X,x as Z,y as ne}from"./chunk-VMC4RC4D.js";import{$a as E,Ab as m,Bb as x,Ca as a,Cb as Q,Fb as A,Gb as N,Hb as z,Na as R,Ra as f,Tb as B,_ as y,a as S,b as P,c as v,cb as g,da as c,db as p,ea as l,eb as d,fa as F,fb as w,ga as I,lc as $,mb as b,mc as U,na as C,nb as T,ob as r,qc as W,sb as O,tb as M,ub as D,wb as j,xb as h,xc as ee,yc as te,zb as u}from"./chunk-L2PMUJ2L.js";var le=["taskEditor"];function pe(s,i){if(s&1&&(p(0,"span",32)(1,"strong"),u(2),d(),u(3),d()),s&2){let e=r(2);a(2),m(e.formatTime(e.timeEstimate())),a(),x(" ",e.translations().estimated," ")}}function _e(s,i){if(s&1&&(p(0,"div",30)(1,"div",31)(2,"span",32)(3,"strong"),u(4),d(),u(5),d(),p(6,"span",32)(7,"strong"),u(8),d(),u(9),d(),f(10,pe,4,2,"span",33),d(),p(11,"div",34),w(12,"div",35),d(),p(13,"span",36),u(14),d()()),s&2){let e=r();a(4),m(e.focusService.focusProgress().completed),a(),x(" ",e.translations().completed," "),a(3),m(e.focusService.focusProgress().remaining),a(),x(" ",e.translations().remaining," "),a(),g("ngIf",e.timeEstimate()>0),a(2),j("width",e.focusService.focusProgress().percentage,"%"),a(2),Q("",e.focusService.focusProgress().percentage,"% ",e.translations().complete)}}function ue(s,i){if(s&1){let e=b();p(0,"button",37),T("click",function(){c(e);let n=r();return l(n.clearAllFocus())}),u(1),d()}if(s&2){let e=r();g("title",e.translations().clearAllFocusTasks),a(),x(" ",e.translations().clearAll," ")}}function ge(s,i){if(s&1&&(p(0,"div",38)(1,"div",39),u(2,"\u{1F3AF}"),d(),p(3,"h3"),u(4),d(),p(5,"p"),u(6),d()()),s&2){let e=r();a(4),m(e.translations().noFocusTasksYet),a(2),m(e.translations().selectTasksFromAvailable)}}function me(s,i){if(s&1&&(p(0,"div",49)(1,"span",50),u(2),d()()),s&2){let e=r().$implicit,t=r(2);a(2),m(t.getProjectName(e.projectId))}}function ve(s,i){if(s&1&&(p(0,"div",51)(1,"span",50),u(2),d()()),s&2){let e=r(3);a(2),m(e.translations().noProject)}}function fe(s,i){if(s&1){let e=b();p(0,"div",42),T("dragstart",function(n){let o=c(e).index,_=r(2);return l(_.onFocusTaskDragStart(o,n))})("dragenter",function(n){let o=c(e).index,_=r(2);return l(_.onFocusTaskDragEnter(o,n))})("dragover",function(n){let o=c(e).index,_=r(2);return l(_.onFocusTaskDragOver(o,n))})("dragleave",function(n){let o=c(e).index,_=r(2);return l(_.onFocusTaskDragLeave(o,n))})("drop",function(n){let o=c(e).index,_=r(2);return l(_.onFocusTaskDrop(o,n))})("dragend",function(){c(e);let n=r(2);return l(n.onFocusTaskDragEnd())}),p(1,"div",43)(2,"div",44),u(3),d(),f(4,me,3,1,"div",45)(5,ve,3,1,"div",46),d(),p(6,"div",47)(7,"app-todo-item",48),T("toggle",function(n){c(e);let o=r(2);return l(o.onToggleTodo(n))})("delete",function(n){c(e);let o=r(2);return l(o.onDeleteTodo(n))})("archive",function(n){c(e);let o=r(2);return l(o.onArchiveTodo(n))})("unarchive",function(n){c(e);let o=r(2);return l(o.onUnarchiveTodo(n))})("update",function(n){c(e);let o=r(2);return l(o.onUpdateTodo(n))})("addSubtaskEvent",function(n){c(e);let o=r(2);return l(o.onAddSubtask(n))})("toggleExpanded",function(n){c(e);let o=r(2);return l(o.onToggleExpanded(n))})("subtaskDrop",function(n){c(e);let o=r(2);return l(o.onSubtaskDrop(n))})("edit",function(){let n=c(e).$implicit,o=r(2);return l(o.openTaskEditorById(n.id))})("editSubtask",function(n){c(e);let o=r(2);return l(o.openTaskEditorById(n))})("focusToggle",function(n){c(e);let o=r(2);return l(o.onFocusToggle(n))})("todayTaskToggle",function(n){c(e);let o=r(2);return l(o.onTodayTaskToggle(n))})("duplicate",function(n){c(e);let o=r(2);return l(o.onDuplicateTodo(n))}),d()()()}if(s&2){let e=i.$implicit,t=i.index,n=r(2);h("dragging",n.draggingIndex()===t)("drag-over",n.dragOverIndex()===t&&n.draggingIndex()!==t),a(3),m(t+1),a(),g("ngIf",e.projectId),a(),g("ngIf",!e.projectId),a(2),g("todo",e)("highlightedTaskId",(n.editingTodo==null?null:n.editingTodo.id)||null)("showFocusToggle",!0)("hideConversionButtons",!0)}}function xe(s,i){if(s&1&&(p(0,"div",40),f(1,fe,8,11,"div",41),d()),s&2){let e=r();a(),g("ngForOf",e.focusService.todaysFocusTasks())}}function Te(s,i){if(s&1){let e=b();p(0,"button",37),T("click",function(){c(e);let n=r();return l(n.clearAllTodayTasks())}),u(1),d()}if(s&2){let e=r();g("title",e.translations().clearAllTodayTasks),a(),x(" ",e.translations().clearAll," ")}}function he(s,i){if(s&1&&(p(0,"div",38)(1,"div",39),u(2,"\u{1F4CB}"),d(),p(3,"h3"),u(4),d(),p(5,"p"),u(6),d()()),s&2){let e=r();a(4),m(e.translations().noTasksForTodayYet),a(2),m(e.translations().selectTasksForToday)}}function ke(s,i){if(s&1&&(p(0,"div",49)(1,"span",50),u(2),d()()),s&2){let e=r().$implicit,t=r(2);a(2),m(t.getProjectName(e.projectId))}}function Ce(s,i){if(s&1&&(p(0,"div",51)(1,"span",50),u(2),d()()),s&2){let e=r(3);a(2),m(e.translations().noProject)}}function be(s,i){if(s&1){let e=b();p(0,"div",42),T("dragstart",function(n){let o=c(e).index,_=r(2);return l(_.onTodayTaskDragStart(o,n))})("dragenter",function(n){let o=c(e).index,_=r(2);return l(_.onTodayTaskDragEnter(o,n))})("dragover",function(n){let o=c(e).index,_=r(2);return l(_.onTodayTaskDragOver(o,n))})("dragleave",function(n){let o=c(e).index,_=r(2);return l(_.onTodayTaskDragLeave(o,n))})("drop",function(n){let o=c(e).index,_=r(2);return l(_.onTodayTaskDrop(o,n))})("dragend",function(){c(e);let n=r(2);return l(n.onTodayTaskDragEnd())}),p(1,"div",43)(2,"div",44),u(3),d(),f(4,ke,3,1,"div",45)(5,Ce,3,1,"div",46),d(),p(6,"div",47)(7,"app-todo-item",48),T("toggle",function(n){c(e);let o=r(2);return l(o.onToggleTodo(n))})("delete",function(n){c(e);let o=r(2);return l(o.onDeleteTodo(n))})("archive",function(n){c(e);let o=r(2);return l(o.onArchiveTodo(n))})("unarchive",function(n){c(e);let o=r(2);return l(o.onUnarchiveTodo(n))})("update",function(n){c(e);let o=r(2);return l(o.onUpdateTodo(n))})("addSubtaskEvent",function(n){c(e);let o=r(2);return l(o.onAddSubtask(n))})("toggleExpanded",function(n){c(e);let o=r(2);return l(o.onToggleExpanded(n))})("subtaskDrop",function(n){c(e);let o=r(2);return l(o.onSubtaskDrop(n))})("edit",function(){let n=c(e).$implicit,o=r(2);return l(o.openTaskEditorById(n.id))})("editSubtask",function(n){c(e);let o=r(2);return l(o.openTaskEditorById(n))})("focusToggle",function(n){c(e);let o=r(2);return l(o.onFocusToggle(n))})("todayTaskToggle",function(n){c(e);let o=r(2);return l(o.onTodayTaskToggle(n))})("duplicate",function(n){c(e);let o=r(2);return l(o.onDuplicateTodo(n))}),d()()()}if(s&2){let e=i.$implicit,t=i.index,n=r(2);h("dragging",n.draggingTodayTaskIndex()===t)("drag-over",n.dragOverTodayTaskIndex()===t&&n.draggingTodayTaskIndex()!==t),a(3),m(t+1),a(),g("ngIf",e.projectId),a(),g("ngIf",!e.projectId),a(2),g("todo",e)("highlightedTaskId",(n.editingTodo==null?null:n.editingTodo.id)||null)("showFocusToggle",!0)("hideConversionButtons",!0)}}function ye(s,i){if(s&1&&(p(0,"div",40),f(1,be,8,11,"div",41),d()),s&2){let e=r();a(),g("ngForOf",e.focusService.todaysTasks())}}function we(s,i){if(s&1&&(p(0,"option",52),u(1),d()),s&2){let e=i.$implicit;g("value",e.id),a(),x(" ",e.name," ")}}function Se(s,i){if(s&1&&(p(0,"p"),u(1),d()),s&2){let e=r(2);a(),m(e.translations().tryAdjustingFilters)}}function Pe(s,i){if(s&1&&(p(0,"p"),u(1),d()),s&2){let e=r(2);a(),m(e.translations().allTasksInFocusOrCompleted)}}function Fe(s,i){if(s&1&&(p(0,"div",38)(1,"div",39),u(2,"\u2705"),d(),p(3,"h3"),u(4),d(),f(5,Se,2,1,"p",53)(6,Pe,2,1,"p",53),d()),s&2){let e=r();a(4),m(e.translations().noAvailableTasks),a(),g("ngIf",e.searchQuery||e.selectedProject),a(),g("ngIf",!e.searchQuery&&!e.selectedProject)}}function Ie(s,i){if(s&1){let e=b();p(0,"div",60),T("click",function(){c(e);let n=r().$implicit,o=r(2);return l(o.toggleProjectExpansion(n.projectId))}),p(1,"button",61),F(),p(2,"svg",12),w(3,"path",13),d()(),I(),p(4,"span",62),u(5),d(),p(6,"h3",63),u(7),d(),p(8,"span",15),u(9),d()()}if(s&2){let e=r().$implicit,t=r(2);h("expanded",t.isProjectExpanded(e.projectId)),a(),h("expanded",t.isProjectExpanded(e.projectId)),E("aria-expanded",t.isProjectExpanded(e.projectId))("aria-controls","project-tasks-"+e.projectId),a(3),j("color",e.projectColor),a(),x(" ",e.projectIcon," "),a(2),m(e.projectName),a(2),x("(",e.taskCount,")")}}function Ee(s,i){if(s&1){let e=b();p(0,"div",64)(1,"app-todo-item",48),T("toggle",function(n){c(e);let o=r(3);return l(o.onToggleTodo(n))})("delete",function(n){c(e);let o=r(3);return l(o.onDeleteTodo(n))})("archive",function(n){c(e);let o=r(3);return l(o.onArchiveTodo(n))})("unarchive",function(n){c(e);let o=r(3);return l(o.onUnarchiveTodo(n))})("update",function(n){c(e);let o=r(3);return l(o.onUpdateTodo(n))})("addSubtaskEvent",function(n){c(e);let o=r(3);return l(o.onAddSubtask(n))})("toggleExpanded",function(n){c(e);let o=r(3);return l(o.onToggleExpanded(n))})("subtaskDrop",function(n){c(e);let o=r(3);return l(o.onSubtaskDrop(n))})("edit",function(){c(e);let n=r().$implicit,o=r(2);return l(o.openTaskEditorById(n.task.id))})("editSubtask",function(n){c(e);let o=r(3);return l(o.openTaskEditorById(n))})("focusToggle",function(n){c(e);let o=r(3);return l(o.onFocusToggle(n))})("todayTaskToggle",function(n){c(e);let o=r(3);return l(o.onTodayTaskToggle(n))})("duplicate",function(n){c(e);let o=r(3);return l(o.onDuplicateTodo(n))}),d()()}if(s&2){let e=r().$implicit,t=r(2);a(),g("todo",e.task)("highlightedTaskId",(t.editingTodo==null?null:t.editingTodo.id)||null)("showFocusToggle",!0)("hideConversionButtons",!0)}}function je(s,i){if(s&1&&(p(0,"div",57),f(1,Ie,10,11,"div",58)(2,Ee,2,4,"div",59),d()),s&2){let e=i.$implicit;a(),g("ngIf",e.type==="header"),a(),g("ngIf",e.type==="task")}}function Ve(s,i){if(s&1&&(p(0,"div",54)(1,"cdk-virtual-scroll-viewport",55),f(2,je,3,2,"div",56),d()()),s&2){let e=r();a(),j("height",400,"px"),a(),g("cdkVirtualForOf",e.virtualScrollItems())}}var ce=class s{focusService=y(ie);todoService=y(oe);projectService=y(ee);confirmationService=y(ne);translationService=y(te);taskEditor;viewport;translations=B(()=>({todaysFocus:this.translationService.translate("focus.todaysFocus"),planAndTrackTasks:this.translationService.translate("focus.planAndTrackTasks"),completed:this.translationService.translate("focus.completed"),remaining:this.translationService.translate("focus.remaining"),estimated:this.translationService.translate("focus.estimated"),complete:this.translationService.translate("focus.complete"),focusTasks:this.translationService.translate("focus.focusTasks"),clearAll:this.translationService.translate("focus.clearAll"),clearAllFocusTasks:this.translationService.translate("focus.clearAllFocusTasks"),collapseFocusTasks:this.translationService.translate("focus.collapseFocusTasks"),expandFocusTasks:this.translationService.translate("focus.expandFocusTasks"),noFocusTasksYet:this.translationService.translate("focus.noFocusTasksYet"),selectTasksFromAvailable:this.translationService.translate("focus.selectTasksFromAvailable"),todaysTasks:this.translationService.translate("focus.todaysTasks"),clearAllTodayTasks:this.translationService.translate("focus.clearAllTodayTasks"),collapseTodayTasks:this.translationService.translate("focus.collapseTodayTasks"),expandTodayTasks:this.translationService.translate("focus.expandTodayTasks"),noTasksForTodayYet:this.translationService.translate("focus.noTasksForTodayYet"),selectTasksForToday:this.translationService.translate("focus.selectTasksForToday"),availableTasks:this.translationService.translate("focus.availableTasks"),collapseAvailableTasks:this.translationService.translate("focus.collapseAvailableTasks"),expandAvailableTasks:this.translationService.translate("focus.expandAvailableTasks"),searchTasks:this.translationService.translate("focus.searchTasks"),noAvailableTasks:this.translationService.translate("focus.noAvailableTasks"),tryAdjustingFilters:this.translationService.translate("focus.tryAdjustingFilters"),allTasksInFocusOrCompleted:this.translationService.translate("focus.allTasksInFocusOrCompleted"),allProjects:this.translationService.translate("common.allProjects"),noProject:this.translationService.translate("common.noProject"),unknownProject:this.translationService.translate("common.unknownProject"),clearAllFocusConfirm:this.translationService.translate("focus.clearAllFocusConfirm"),clearAllTodayTasksConfirm:this.translationService.translate("focus.clearAllTodayTasksConfirm"),deleteTaskConfirm:this.translationService.translate("searchPage.deleteTaskConfirm"),deleteTaskSubtext:this.translationService.translate("searchPage.deleteTaskSubtext"),deleteAction:this.translationService.translate("actions.delete"),cancelAction:this.translationService.translate("actions.cancel")}));editingTodo=null;searchQuery="";selectedProject="";expandedProjects=C(new Set);hasUserInteracted=!1;focusPanelExpanded=C(!0);availableTasksPanelExpanded=C(!0);todayTasksPanelExpanded=C(!0);draggingIndex=C(null);dragOverIndex=C(null);draggingTodayTaskIndex=C(null);dragOverTodayTaskIndex=C(null);timeEstimate=()=>this.focusService.getFocusTimeEstimate();filteredAvailableTasks=()=>{let i=this.focusService.availableTasks(),e=new Set(this.getAllTaskIds(this.focusService.todaysFocusTasks())),t=new Set(this.getAllTaskIds(this.focusService.todaysTasks())),n=new Set([...e,...t]),o=this.processTasksWithSmartSubtaskFiltering(i,n),_=o;if(this.searchQuery){let k=this.searchQuery.toLowerCase();_=this.filterTasksRecursively(o,V=>V.title.toLowerCase().includes(k)||(V.description?.toLowerCase().includes(k)??!1)||(V.category?.toLowerCase().includes(k)??!1))}return this.selectedProject&&(_=_.filter(k=>k.projectId===this.selectedProject)),_};virtualScrollItems=B(()=>{let i=this.filteredAvailableTasks();if(this.selectedProject)return i.map(o=>({type:"task",task:o,projectId:this.selectedProject}));let e=new Map;for(let o of i){let _=o.projectId||"no-project";e.has(_)||e.set(_,[]),e.get(_).push(o)}let t=[],n=Array.from(e.entries()).sort(([o],[_])=>o==="no-project"?1:_==="no-project"?-1:this.getProjectName(o).localeCompare(this.getProjectName(_)));for(let[o,_]of n)if(t.push({type:"header",projectId:o,projectName:o==="no-project"?this.translations().noProject:this.getProjectName(o),projectIcon:this.getProjectIcon(o),projectColor:this.getProjectColor(o),taskCount:_.length}),this.isProjectExpanded(o))for(let k of _)t.push({type:"task",task:k,projectId:o});return t});groupedAvailableTasks=()=>{let i=this.filteredAvailableTasks();if(this.selectedProject)return[{projectId:this.selectedProject,projectName:this.getProjectName(this.selectedProject),tasks:i}];let e=new Map;for(let n of i){let o=n.projectId||"no-project",_=n.projectId?this.getProjectName(n.projectId):this.translations().noProject;e.has(o)||e.set(o,{projectId:o,projectName:_,tasks:[]}),e.get(o).tasks.push(n)}return Array.from(e.values()).sort((n,o)=>n.projectId==="no-project"?1:o.projectId==="no-project"?-1:n.projectName.localeCompare(o.projectName))};getAllTaskIds(i){let e=[];for(let t of i)e.push(t.id),t.subtasks.length>0&&e.push(...this.getAllTaskIds(t.subtasks));return e}processTasksWithSmartSubtaskFiltering(i,e){let t=[];for(let n of i)if(!e.has(n.id))if(n.completed){let o=this.getOrphanedSubtasks(n.subtasks,e);t.push(...o)}else{let o=this.filterSubtasksRecursively(n.subtasks,e),_=P(S({},n),{subtasks:o});t.push(_)}return t}getOrphanedSubtasks(i,e){let t=[];for(let n of i)if(!e.has(n.id))if(n.completed)n.subtasks.length>0&&t.push(...this.getOrphanedSubtasks(n.subtasks,e));else{let o=this.filterSubtasksRecursively(n.subtasks,e),_=P(S({},n),{subtasks:o});t.push(_)}return t}filterSubtasksRecursively(i,e){let t=[];for(let n of i){if(e.has(n.id)||n.completed)continue;let o=this.filterSubtasksRecursively(n.subtasks,e),_=P(S({},n),{subtasks:o});t.push(_)}return t}filterTasksRecursively(i,e){let t=[];for(let n of i){let o=e(n),_=this.filterTasksRecursively(n.subtasks,e);if(o||_.length>0){let k=P(S({},n),{subtasks:_});t.push(k)}}return t}getProjectName(i){return this.projectService.activeProjects().find(t=>t.id===i)?.name||this.translations().unknownProject}getProjectIcon(i){return i==="no-project"?"\u{1F4CB}":this.projectService.activeProjects().find(t=>t.id===i)?.icon||"\u{1F4CB}"}getProjectColor(i){return i==="no-project"?"#6b7280":this.projectService.activeProjects().find(t=>t.id===i)?.color||"#6b7280"}addFocus(i){return v(this,null,function*(){yield this.focusService.addToTodaysFocus(i)})}removeFocus(i){return v(this,null,function*(){yield this.focusService.removeFromTodaysFocus(i)})}onFocusToggle(i){return v(this,null,function*(){console.log("FocusComponent: Received focusToggle event for task:",i);let e=window.pageYOffset||document.documentElement.scrollTop;try{yield this.focusService.toggleTodaysFocus(i),console.log("FocusComponent: Successfully toggled focus for task:",i)}catch(t){console.error("FocusComponent: Error toggling focus for task:",i,t)}setTimeout(()=>{window.scrollTo(0,e)},0)})}onTodayTaskToggle(i){return v(this,null,function*(){console.log("FocusComponent: Received todayTaskToggle event for task:",i);let e=window.pageYOffset||document.documentElement.scrollTop;try{yield this.focusService.toggleTodaysTasks(i),console.log("FocusComponent: Successfully toggled today task for task:",i)}catch(t){console.error("FocusComponent: Error toggling today task for task:",i,t)}setTimeout(()=>{window.scrollTo(0,e)},0)})}clearAllFocus(){return v(this,null,function*(){confirm(this.translations().clearAllFocusConfirm)&&(yield this.focusService.clearTodaysFocus())})}clearAllTodayTasks(){return v(this,null,function*(){confirm(this.translations().clearAllTodayTasksConfirm)&&(yield this.focusService.clearTodaysTasks())})}updateSearch(i){let e=i.target;this.searchQuery=e.value}updateProjectFilter(){}toggleFocusPanelExpansion(){this.focusPanelExpanded.set(!this.focusPanelExpanded())}toggleAvailableTasksPanelExpansion(){this.availableTasksPanelExpanded.set(!this.availableTasksPanelExpanded())}toggleTodayTasksPanelExpansion(){this.todayTasksPanelExpanded.set(!this.todayTasksPanelExpanded())}toggleProjectExpansion(i){let e=this.expandedProjects(),t=new Set(e);if(e.size===0&&!this.hasUserInteracted){let n=this.groupedAvailableTasks().map(o=>o.projectId);t=new Set(n)}this.hasUserInteracted=!0,t.has(i)?t.delete(i):t.add(i),this.expandedProjects.set(t)}isProjectExpanded(i){let e=this.expandedProjects();return e.size===0&&!this.hasUserInteracted?!0:e.has(i)}onFocusTaskDragStart(i,e){this.draggingIndex.set(i),this.dragOverIndex.set(i);try{e.dataTransfer?.setData("text/plain",String(i)),e.dataTransfer?.setDragImage(new Image,0,0),e.dataTransfer.effectAllowed="move"}catch{}}onFocusTaskDragEnter(i,e){e.preventDefault(),this.draggingIndex()!==null&&this.draggingIndex()!==i&&this.dragOverIndex.set(i)}onFocusTaskDragOver(i,e){e.preventDefault(),this.draggingIndex()!==null&&(e.dataTransfer.dropEffect="move",this.dragOverIndex.set(i))}onFocusTaskDragLeave(i,e){e.preventDefault(),this.dragOverIndex()===i&&this.dragOverIndex.set(null)}onFocusTaskDrop(i,e){return v(this,null,function*(){e.preventDefault();let t=this.draggingIndex();t===null||t===i||(yield this.focusService.reorderFocusTasks(t,i),this.draggingIndex.set(null),this.dragOverIndex.set(null))})}onFocusTaskDragEnd(){this.draggingIndex.set(null),this.dragOverIndex.set(null)}onTodayTaskDragStart(i,e){this.draggingTodayTaskIndex.set(i),this.dragOverTodayTaskIndex.set(i);try{e.dataTransfer?.setData("text/plain",String(i)),e.dataTransfer?.setDragImage(new Image,0,0),e.dataTransfer.effectAllowed="move"}catch{}}onTodayTaskDragEnter(i,e){e.preventDefault(),this.draggingTodayTaskIndex()!==null&&this.draggingTodayTaskIndex()!==i&&this.dragOverTodayTaskIndex.set(i)}onTodayTaskDragOver(i,e){e.preventDefault(),this.draggingTodayTaskIndex()!==null&&(e.dataTransfer.dropEffect="move",this.dragOverTodayTaskIndex.set(i))}onTodayTaskDragLeave(i,e){e.preventDefault(),this.dragOverTodayTaskIndex()===i&&this.dragOverTodayTaskIndex.set(null)}onTodayTaskDrop(i,e){return v(this,null,function*(){e.preventDefault();let t=this.draggingTodayTaskIndex();t===null||t===i||(yield this.focusService.reorderTodaysTasks(t,i),this.draggingTodayTaskIndex.set(null),this.dragOverTodayTaskIndex.set(null))})}onTodayTaskDragEnd(){this.draggingTodayTaskIndex.set(null),this.dragOverTodayTaskIndex.set(null)}onToggleTodo(i){return v(this,null,function*(){yield this.todoService.toggleTodo(i)})}onDeleteTodo(i){return v(this,null,function*(){let e=this.findTodoById(i);if(!e)return;(yield this.confirmationService.open(this.translations().deleteTaskConfirm,`${this.translations().deleteTaskConfirm} "${e.title}"? ${this.translations().deleteTaskSubtext}`,this.translations().deleteAction,this.translations().cancelAction,!1))==="confirm"&&(yield this.todoService.deleteTodo(i))})}onDuplicateTodo(i){return v(this,null,function*(){try{yield this.todoService.duplicateTodo(i)}catch(e){console.error("Failed to duplicate todo:",e)}})}onArchiveTodo(i){return v(this,null,function*(){this.todoService.archiveTodo(i)})}onUnarchiveTodo(i){return v(this,null,function*(){this.todoService.unarchiveTodo(i)})}onUpdateTodo(i){return v(this,null,function*(){yield this.todoService.updateTodo(i.id,i.updates)})}onAddSubtask(i){return v(this,null,function*(){this.todoService.addSubtask(i.parentId,i.subtaskData)})}onToggleExpanded(i){let e=this.virtualScrollItems().some(t=>t.type==="task"&&t.task?.id===i);if(this.viewport&&e){let t=this.viewport.measureScrollOffset();this.todoService.toggleExpanded(i),setTimeout(()=>{this.viewport.checkViewportSize(),this.viewport.scrollToOffset(t,"auto")})}else this.todoService.toggleExpanded(i)}onSubtaskDrop(i){return v(this,null,function*(){console.log("Subtask drop not implemented yet:",i)})}openTaskEditorById(i){let e=this.todoService.getTodoById(i);e&&(this.editingTodo=e,this.taskEditor.open())}onSaveTask(i){return v(this,null,function*(){this.editingTodo&&(yield this.todoService.updateTodo(this.editingTodo.id,i),this.editingTodo=null,this.taskEditor.onClose())})}onCancelEdit(){this.editingTodo=null}findTodoById(i){let e=this.focusService.todaysFocusTasks(),t=this.findTodoByIdRecursive(e,i);if(t)return t;let n=this.focusService.availableTasks();return this.findTodoByIdRecursive(n,i)}findTodoByIdRecursive(i,e){for(let t of i){if(t.id===e)return t;if(t.subtasks.length>0){let n=this.findTodoByIdRecursive(t.subtasks,e);if(n)return n}}}formatTime(i){if(i<60)return`${i}m`;let e=Math.floor(i/60),t=i%60;return t>0?`${e}h ${t}m`:`${e}h`}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=R({type:s,selectors:[["app-focus"]],viewQuery:function(e,t){if(e&1&&(O(le,5),O(L,5)),e&2){let n;M(n=D())&&(t.taskEditor=n.first),M(n=D())&&(t.viewport=n.first)}},decls:68,vars:44,consts:[["taskEditor",""],[1,"focus-container"],[1,"focus-header"],[1,"header-content"],[1,"focus-icon"],[1,"focus-subtitle"],["class","focus-progress",4,"ngIf"],[1,"focus-content"],[1,"focus-section"],[1,"section-header"],[1,"section-title"],[1,"expand-toggle",3,"click","title"],["width","16","height","16","viewBox","0 0 20 20","fill","currentColor",1,"chevron"],["fill-rule","evenodd","d","M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707A1 1 0 118.707 5.293l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule","evenodd"],[1,"section-icon"],[1,"task-count"],[1,"section-actions"],["class","btn btn-secondary btn-sm",3,"title","click",4,"ngIf"],["id","focus-tasks-content"],["class","empty-state",4,"ngIf"],["class","focus-tasks-list",4,"ngIf"],["id","today-tasks-content"],[1,"available-section"],["type","text",1,"search-input",3,"ngModelChange","input","placeholder","ngModel"],[1,"filter-select",3,"ngModelChange","change","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["id","available-tasks-content"],["class","available-tasks-virtual-container",4,"ngIf"],[3,"save","cancel","todo"],[1,"focus-progress"],[1,"progress-stats"],[1,"stat"],["class","stat",4,"ngIf"],[1,"progress-bar"],[1,"progress-fill"],[1,"progress-text"],[1,"btn","btn-secondary","btn-sm",3,"click","title"],[1,"empty-state"],[1,"empty-icon"],[1,"focus-tasks-list"],["class","focus-task-item","draggable","true",3,"dragging","drag-over","dragstart","dragenter","dragover","dragleave","drop","dragend",4,"ngFor","ngForOf"],["draggable","true",1,"focus-task-item",3,"dragstart","dragenter","dragover","dragleave","drop","dragend"],[1,"task-order-container"],[1,"task-order"],["class","task-project-badge",4,"ngIf"],["class","task-project-badge no-project",4,"ngIf"],[1,"task-content"],[3,"toggle","delete","archive","unarchive","update","addSubtaskEvent","toggleExpanded","subtaskDrop","edit","editSubtask","focusToggle","todayTaskToggle","duplicate","todo","highlightedTaskId","showFocusToggle","hideConversionButtons"],[1,"task-project-badge"],[1,"project-label"],[1,"task-project-badge","no-project"],[3,"value"],[4,"ngIf"],[1,"available-tasks-virtual-container"],["itemSize","80",1,"virtual-scroll-viewport"],["class","virtual-scroll-item",4,"cdkVirtualFor","cdkVirtualForOf"],[1,"virtual-scroll-item"],["class","project-header virtual-project-header",3,"expanded","click",4,"ngIf"],["class","virtual-task-item",4,"ngIf"],[1,"project-header","virtual-project-header",3,"click"],[1,"expand-toggle"],[1,"project-icon"],[1,"project-name"],[1,"virtual-task-item"]],template:function(e,t){if(e&1){let n=b();p(0,"div",1)(1,"div",2)(2,"div",3)(3,"h1")(4,"span",4),u(5,"\u{1F3AF}"),d(),u(6),d(),p(7,"p",5),u(8),d()(),f(9,_e,15,9,"div",6),d(),p(10,"div",7)(11,"div",8)(12,"div",9)(13,"div",10)(14,"button",11),T("click",function(){return c(n),l(t.toggleFocusPanelExpansion())}),F(),p(15,"svg",12),w(16,"path",13),d()(),I(),p(17,"h2")(18,"span",14),u(19,"\u2B50"),d(),u(20),p(21,"span",15),u(22),d()()(),p(23,"div",16),f(24,ue,2,2,"button",17),d()(),p(25,"div",18),f(26,ge,7,2,"div",19)(27,xe,2,1,"div",20),d()(),p(28,"div",8)(29,"div",9)(30,"div",10)(31,"button",11),T("click",function(){return c(n),l(t.toggleTodayTasksPanelExpansion())}),F(),p(32,"svg",12),w(33,"path",13),d()(),I(),p(34,"h2")(35,"span",14),u(36,"\u{1F4CB}"),d(),u(37),p(38,"span",15),u(39),d()()(),p(40,"div",16),f(41,Te,2,2,"button",17),d()(),p(42,"div",21),f(43,he,7,2,"div",19)(44,ye,2,1,"div",20),d()(),p(45,"div",22)(46,"div",9)(47,"div",10)(48,"button",11),T("click",function(){return c(n),l(t.toggleAvailableTasksPanelExpansion())}),F(),p(49,"svg",12),w(50,"path",13),d()(),I(),p(51,"h2")(52,"span",14),u(53,"\u{1F4CB}"),d(),u(54),p(55,"span",15),u(56),d()()(),p(57,"div",16)(58,"input",23),z("ngModelChange",function(_){return c(n),N(t.searchQuery,_)||(t.searchQuery=_),l(_)}),T("input",function(_){return c(n),l(t.updateSearch(_))}),d(),p(59,"select",24),z("ngModelChange",function(_){return c(n),N(t.selectedProject,_)||(t.selectedProject=_),l(_)}),T("change",function(){return c(n),l(t.updateProjectFilter())}),p(60,"option",25),u(61),d(),f(62,we,2,2,"option",26),d()()(),p(63,"div",27),f(64,Fe,7,3,"div",19)(65,Ve,3,3,"div",28),d()()(),p(66,"app-task-editor",29,0),T("save",function(_){return c(n),l(t.onSaveTask(_))})("cancel",function(){return c(n),l(t.onCancelEdit())}),d()()}e&2&&(a(6),x(" ",t.translations().todaysFocus," "),a(2),m(t.translations().planAndTrackTasks),a(),g("ngIf",t.focusService.focusProgress().total>0),a(5),h("expanded",t.focusPanelExpanded()),g("title",t.focusPanelExpanded()?t.translations().collapseFocusTasks:t.translations().expandFocusTasks),E("aria-expanded",t.focusPanelExpanded())("aria-controls","focus-tasks-content"),a(6),x(" ",t.translations().focusTasks," "),a(2),x("(",t.focusService.todaysFocusTasks().length,")"),a(2),g("ngIf",t.focusService.todaysFocusTasks().length>0),a(),h("collapsed",!t.focusPanelExpanded()),a(),g("ngIf",t.focusService.todaysFocusTasks().length===0),a(),g("ngIf",t.focusService.todaysFocusTasks().length>0),a(4),h("expanded",t.todayTasksPanelExpanded()),g("title",t.todayTasksPanelExpanded()?t.translations().collapseTodayTasks:t.translations().expandTodayTasks),E("aria-expanded",t.todayTasksPanelExpanded())("aria-controls","today-tasks-content"),a(6),x(" ",t.translations().todaysTasks," "),a(2),x("(",t.focusService.todaysTasks().length,")"),a(2),g("ngIf",t.focusService.todaysTasks().length>0),a(),h("collapsed",!t.todayTasksPanelExpanded()),a(),g("ngIf",t.focusService.todaysTasks().length===0),a(),g("ngIf",t.focusService.todaysTasks().length>0),a(4),h("expanded",t.availableTasksPanelExpanded()),g("title",t.availableTasksPanelExpanded()?t.translations().collapseAvailableTasks:t.translations().expandAvailableTasks),E("aria-expanded",t.availableTasksPanelExpanded())("aria-controls","available-tasks-content"),a(6),x(" ",t.translations().availableTasks," "),a(2),x("(",t.filteredAvailableTasks().length,")"),a(2),g("placeholder",t.translations().searchTasks),A("ngModel",t.searchQuery),a(),A("ngModel",t.selectedProject),a(2),m(t.translations().allProjects),a(),g("ngForOf",t.projectService.activeProjects()),a(),h("collapsed",!t.availableTasksPanelExpanded()),a(),g("ngIf",t.virtualScrollItems().length===0),a(),g("ngIf",t.virtualScrollItems().length>0),a(),g("todo",t.editingTodo))},dependencies:[W,$,U,Y,Z,K,X,H,J,G,q,L,re,ae,de,se],styles:[".focus-container[_ngcontent-%COMP%]{padding:2rem;max-width:1200px;margin:0 auto;min-height:100vh;overflow-anchor:none}.focus-header[_ngcontent-%COMP%]{margin-bottom:2rem;padding-bottom:1.5rem;border-bottom:1px solid #e5e7eb}.header-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;margin:0 0 .5rem;font-size:2.5rem;font-weight:700;color:#1f2937}.focus-icon[_ngcontent-%COMP%]{font-size:2.5rem}.focus-subtitle[_ngcontent-%COMP%]{margin:0;color:#6b7280;font-size:1.125rem}.focus-progress[_ngcontent-%COMP%]{margin-top:1.5rem;padding:1.5rem;background:linear-gradient(135deg,#f3f4f6,#e5e7eb);border-radius:12px;border:1px solid #d1d5db}.progress-stats[_ngcontent-%COMP%]{display:flex;gap:2rem;margin-bottom:1rem;flex-wrap:wrap}.stat[_ngcontent-%COMP%]{color:#374151;font-size:.875rem}.stat[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#1f2937;font-size:1.125rem}.progress-bar[_ngcontent-%COMP%]{width:100%;height:8px;background:#e5e7eb;border-radius:4px;overflow:hidden;margin-bottom:.5rem}.progress-fill[_ngcontent-%COMP%]{height:100%;background:linear-gradient(90deg,#10b981,#059669);border-radius:4px;transition:width .3s ease}.progress-text[_ngcontent-%COMP%]{font-size:.875rem;color:#6b7280;font-weight:500}.focus-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem}.focus-section[_ngcontent-%COMP%], .available-section[_ngcontent-%COMP%]{background:#fff;border-radius:12px;border:1px solid #e5e7eb;overflow:visible;position:relative}.section-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1.5rem;background:#f9fafb;border-bottom:1px solid #e5e7eb;position:sticky;top:0;z-index:10;border-radius:12px 12px 0 0}.focus-section[_ngcontent-%COMP%]:nth-of-type(1)   .section-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#dbeafe,#bfdbfe);border-bottom:1px solid #93c5fd}.focus-section[_ngcontent-%COMP%]:nth-of-type(1){border-color:#3b82f6;box-shadow:0 0 0 1px #3b82f61a}.focus-section[_ngcontent-%COMP%]:nth-of-type(2)   .section-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#dcfce7,#bbf7d0);border-bottom:1px solid #86efac}.focus-section[_ngcontent-%COMP%]:nth-of-type(2){border-color:#10b981;box-shadow:0 0 0 1px #10b9811a}.available-section[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f3e8ff,#e9d5ff);border-bottom:1px solid #c4b5fd}.available-section[_ngcontent-%COMP%]{border-color:#8b5cf6;box-shadow:0 0 0 1px #8b5cf61a}.section-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.section-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin:0;font-size:1.25rem;font-weight:600;color:#1f2937}.section-icon[_ngcontent-%COMP%]{font-size:1.25rem}.task-count[_ngcontent-%COMP%]{color:#6b7280;font-weight:400;font-size:1rem}.section-actions[_ngcontent-%COMP%]{display:flex;gap:.75rem;align-items:center}.search-input[_ngcontent-%COMP%]{padding:.5rem .75rem;border:1px solid #d1d5db;border-radius:6px;font-size:.875rem;width:200px}.search-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.filter-select[_ngcontent-%COMP%]{padding:.5rem .75rem;border:1px solid #d1d5db;border-radius:6px;font-size:.875rem;background:#fff;min-width:150px}.filter-select[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.btn[_ngcontent-%COMP%]{padding:.5rem 1rem;border:none;border-radius:6px;font-size:.875rem;font-weight:500;cursor:pointer;transition:all .2s ease;display:inline-flex;align-items:center;gap:.5rem}.btn-sm[_ngcontent-%COMP%]{padding:.375rem .75rem;font-size:.8125rem}.btn-secondary[_ngcontent-%COMP%]{background:#f3f4f6;color:#374151;border:1px solid #d1d5db}.btn-secondary[_ngcontent-%COMP%]:hover{background:#e5e7eb;border-color:#9ca3af}.expand-toggle[_ngcontent-%COMP%]{background:none;border:none;padding:.25rem;cursor:pointer;border-radius:4px;color:#6b7280;transition:all .2s ease;display:flex;align-items:center;justify-content:center}.expand-toggle[_ngcontent-%COMP%]:hover{background:#e5e7eb;color:#374151}.expand-toggle[_ngcontent-%COMP%]   .chevron[_ngcontent-%COMP%]{transition:transform .2s ease;transform:rotate(0)}.collapsed[_ngcontent-%COMP%]{display:none}.empty-state[_ngcontent-%COMP%]{padding:3rem 2rem;text-align:center;color:#6b7280}.empty-icon[_ngcontent-%COMP%]{font-size:3rem;margin-bottom:1rem}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 .5rem;color:#374151;font-size:1.25rem;font-weight:600}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.875rem}.focus-tasks-list[_ngcontent-%COMP%]{padding:1rem;overflow-anchor:none}.focus-task-item[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:1rem;padding:1rem;margin-bottom:.75rem;background:#f8fafc;border:1px solid #e2e8f0;border-radius:8px;cursor:move;transition:all .2s ease}.focus-task-item[_ngcontent-%COMP%]:hover{background:#f1f5f9;border-color:#cbd5e1}.focus-task-item.dragging[_ngcontent-%COMP%]{opacity:.5;transform:rotate(2deg)}.focus-task-item.drag-over[_ngcontent-%COMP%]{border-color:#3b82f6;background:#eff6ff}.task-order-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:.25rem;flex-shrink:0;margin-top:.25rem;margin-right:.75rem}.task-order[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:2rem;height:2rem;background:#3b82f6;color:#fff;border-radius:50%;font-weight:600;font-size:.875rem;flex-shrink:0}.task-project-badge[_ngcontent-%COMP%]{flex-shrink:0}.task-project-badge[_ngcontent-%COMP%]   .project-label[_ngcontent-%COMP%]{font-size:10px;font-weight:500;padding:3px 6px;border-radius:12px;background:#e5e7eb;color:#374151;white-space:nowrap;text-transform:uppercase;letter-spacing:.5px;display:inline-block}.task-project-badge.no-project[_ngcontent-%COMP%]   .project-label[_ngcontent-%COMP%]{background:#f3f4f6;color:#9ca3af;font-style:italic;text-transform:none;letter-spacing:0}.task-content[_ngcontent-%COMP%]{flex:1;min-width:0}.available-tasks-list[_ngcontent-%COMP%]{padding:1rem;overflow-anchor:none}.project-group[_ngcontent-%COMP%]{margin-bottom:1.5rem}.project-group[_ngcontent-%COMP%]:last-child{margin-bottom:0}.project-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.75rem 1rem;margin-bottom:.75rem;background:#f8fafc;border:1px solid #e2e8f0;border-radius:8px;font-weight:500;cursor:pointer;transition:all .2s ease;-webkit-user-select:none;user-select:none}.project-header[_ngcontent-%COMP%]:hover{background:#f1f5f9;border-color:#cbd5e1}.expand-toggle[_ngcontent-%COMP%]{background:none;border:none;color:#6b7280;cursor:pointer;padding:0;display:flex;align-items:center;justify-content:center;transition:transform .2s ease}.expand-toggle[_ngcontent-%COMP%]   .chevron[_ngcontent-%COMP%]{transition:transform .2s ease}.expand-toggle.expanded[_ngcontent-%COMP%]   .chevron[_ngcontent-%COMP%]{transform:rotate(90deg)}.project-icon[_ngcontent-%COMP%]{font-size:1.125rem}.project-name[_ngcontent-%COMP%]{margin:0;font-size:1rem;font-weight:600;color:#374151}.project-tasks[_ngcontent-%COMP%]{margin-left:.5rem;border-left:2px solid #f1f5f9;padding-left:1rem;transition:all .3s ease;overflow:visible}.project-tasks.collapsed[_ngcontent-%COMP%]{max-height:0;opacity:0;margin-bottom:0;padding-top:0;padding-bottom:0}@media (max-width: 768px){.focus-container[_ngcontent-%COMP%]{padding:1rem}.header-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], .focus-icon[_ngcontent-%COMP%]{font-size:2rem}.section-header[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch;gap:1rem}.section-actions[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.search-input[_ngcontent-%COMP%], .filter-select[_ngcontent-%COMP%]{width:100%}.progress-stats[_ngcontent-%COMP%]{gap:1rem}.focus-task-item[_ngcontent-%COMP%], .available-task-item[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch;gap:.75rem}.task-order[_ngcontent-%COMP%], .remove-focus-btn[_ngcontent-%COMP%], .add-focus-btn[_ngcontent-%COMP%]{align-self:flex-start}}.available-tasks-virtual-container[_ngcontent-%COMP%]{height:400px;border:1px solid var(--border-color, #e5e7eb);border-radius:8px;overflow:hidden;background:#fff}.virtual-scroll-viewport[_ngcontent-%COMP%]{height:100%!important;width:100%}.virtual-scroll-item[_ngcontent-%COMP%]{min-height:80px;border-bottom:1px solid var(--border-color, #f3f4f6);display:flex;flex-direction:column}.virtual-scroll-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.virtual-project-header[_ngcontent-%COMP%]{background:var(--background-secondary, #f9fafb);border-bottom:1px solid var(--border-color, #e5e7eb);padding:12px 16px;cursor:pointer;transition:background-color .2s ease;min-height:48px;display:flex;align-items:center;gap:8px;flex-shrink:0}.virtual-project-header[_ngcontent-%COMP%]:hover{background:var(--background-hover, #f3f4f6)}.virtual-task-item[_ngcontent-%COMP%]{padding:4px 8px;min-height:76px;flex:1;display:flex;align-items:center}.virtual-task-item[_ngcontent-%COMP%]   app-todo-item[_ngcontent-%COMP%]{display:block;width:100%}@media (max-width: 768px){.available-tasks-virtual-container[_ngcontent-%COMP%]{height:300px}}@media (min-width: 1200px){.available-tasks-virtual-container[_ngcontent-%COMP%]{height:500px}}"]})};export{ce as FocusComponent};
