import{C as f}from"./chunk-CGXEH5ZA.js";import{Hb as i,R as u,W as n,c as a,ja as T}from"./chunk-7QHQU2NT.js";var l=class d{todoService=n(f);focusDateSignal=T(new Date);todaysFocusTasks=i(()=>{let s=this.todoService.todos();return this.flattenTodos(s).filter(o=>o.focusToday&&!o.archived).sort((o,t)=>(o.focusOrder||0)-(t.focusOrder||0))});availableTasks=i(()=>{let s=this.todoService.todos();return this.flattenTodos(s).filter(o=>!o.focusToday&&!o.completed&&!o.archived)});focusProgress=i(()=>{let s=this.todaysFocusTasks(),e=s.filter(c=>c.completed),o=s.filter(c=>!c.completed),t=s.length,r=e.length;return{total:t,completed:r,remaining:o.length,percentage:t>0?Math.round(r/t*100):0}});addToTodaysFocus(s){return a(this,null,function*(){let e=this.todaysFocusTasks(),o=Math.max(0,...e.map(t=>t.focusOrder||0));yield this.todoService.updateTodo(s,{focusToday:!0,focusOrder:o+1})})}removeFromTodaysFocus(s){return a(this,null,function*(){yield this.todoService.updateTodo(s,{focusToday:!1,focusOrder:void 0})})}toggleTodaysFocus(s){return a(this,null,function*(){let e=this.todoService.getTodoById(s);e&&(e.focusToday?yield this.removeFromTodaysFocus(s):yield this.addToTodaysFocus(s))})}reorderFocusTasks(s,e){return a(this,null,function*(){let o=this.todaysFocusTasks();if(s<0||s>=o.length||e<0||e>=o.length)return;let t=[...o],[r]=t.splice(s,1);t.splice(e,0,r);let c=t.map((m,v)=>this.todoService.updateTodo(m.id,{focusOrder:v+1}));yield Promise.all(c)})}clearTodaysFocus(){return a(this,null,function*(){let e=this.todaysFocusTasks().map(o=>this.todoService.updateTodo(o.id,{focusToday:!1,focusOrder:void 0}));yield Promise.all(e)})}getFocusTimeEstimate(){return this.todaysFocusTasks().reduce((e,o)=>e+(o.duration||0),0)}flattenTodos(s){let e=[];for(let o of s)e.push(o),o.subtasks&&o.subtasks.length>0&&e.push(...this.flattenTodos(o.subtasks));return e}get focusDate(){return this.focusDateSignal()}setFocusDate(s){this.focusDateSignal.set(s)}static \u0275fac=function(e){return new(e||d)};static \u0275prov=u({token:d,factory:d.\u0275fac,providedIn:"root"})};export{l as a};
