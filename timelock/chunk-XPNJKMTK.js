import{a as oe}from"./chunk-NQWYQVL4.js";import{e as se}from"./chunk-MXTSN7X2.js";import{a as ie}from"./chunk-UPOVYYGJ.js";import{C as ne,h as W,j as Y,k as H,n as G,r as q,s as J,t as K,x as X,y as te}from"./chunk-ZHH3AUGI.js";import{$ as r,$b as $,Ga as A,Ib as R,Ka as T,Ua as I,W as y,Xa as g,Ya as c,Za as l,_a as S,_b as Q,a as w,aa as d,b as P,ba as F,c as m,ca as E,cb as C,db as x,dc as U,eb as s,gb as N,hb as B,ib as z,ja as h,kb as O,kc as Z,lb as k,lc as ee,nb as u,ob as v,pb as f,qb as L,tb as j,ub as M,vb as D,wa as a}from"./chunk-BIN6KA2U.js";var re=["taskEditor"];function de(p,o){if(p&1&&(c(0,"span",32)(1,"strong"),u(2),l(),u(3),l()),p&2){let e=s(2);a(2),v(e.formatTime(e.timeEstimate())),a(),f(" ",e.translations().estimated," ")}}function ce(p,o){if(p&1&&(c(0,"div",30)(1,"div",31)(2,"span",32)(3,"strong"),u(4),l(),u(5),l(),c(6,"span",32)(7,"strong"),u(8),l(),u(9),l(),T(10,de,4,2,"span",33),l(),c(11,"div",34),S(12,"div",35),l(),c(13,"span",36),u(14),l()()),p&2){let e=s();a(4),v(e.focusService.focusProgress().completed),a(),f(" ",e.translations().completed," "),a(3),v(e.focusService.focusProgress().remaining),a(),f(" ",e.translations().remaining," "),a(),g("ngIf",e.timeEstimate()>0),a(2),O("width",e.focusService.focusProgress().percentage,"%"),a(2),L("",e.focusService.focusProgress().percentage,"% ",e.translations().complete)}}function le(p,o){if(p&1){let e=C();c(0,"button",37),x("click",function(){r(e);let n=s();return d(n.clearAllFocus())}),u(1),l()}if(p&2){let e=s();g("title",e.translations().clearAllFocusTasks),a(),f(" ",e.translations().clearAll," ")}}function pe(p,o){if(p&1&&(c(0,"div",38)(1,"div",39),u(2,"\u{1F3AF}"),l(),c(3,"h3"),u(4),l(),c(5,"p"),u(6),l()()),p&2){let e=s();a(4),v(e.translations().noFocusTasksYet),a(2),v(e.translations().selectTasksFromAvailable)}}function _e(p,o){if(p&1){let e=C();c(0,"div",42),x("dragstart",function(n){let i=r(e).index,_=s(2);return d(_.onFocusTaskDragStart(i,n))})("dragenter",function(n){let i=r(e).index,_=s(2);return d(_.onFocusTaskDragEnter(i,n))})("dragover",function(n){let i=r(e).index,_=s(2);return d(_.onFocusTaskDragOver(i,n))})("dragleave",function(n){let i=r(e).index,_=s(2);return d(_.onFocusTaskDragLeave(i,n))})("drop",function(n){let i=r(e).index,_=s(2);return d(_.onFocusTaskDrop(i,n))})("dragend",function(){r(e);let n=s(2);return d(n.onFocusTaskDragEnd())}),c(1,"div",43),u(2),l(),c(3,"div",44)(4,"app-todo-item",45),x("toggle",function(n){r(e);let i=s(2);return d(i.onToggleTodo(n))})("delete",function(n){r(e);let i=s(2);return d(i.onDeleteTodo(n))})("archive",function(n){r(e);let i=s(2);return d(i.onArchiveTodo(n))})("unarchive",function(n){r(e);let i=s(2);return d(i.onUnarchiveTodo(n))})("update",function(n){r(e);let i=s(2);return d(i.onUpdateTodo(n))})("addSubtaskEvent",function(n){r(e);let i=s(2);return d(i.onAddSubtask(n))})("toggleExpanded",function(n){r(e);let i=s(2);return d(i.onToggleExpanded(n))})("subtaskDrop",function(n){r(e);let i=s(2);return d(i.onSubtaskDrop(n))})("edit",function(){let n=r(e).$implicit,i=s(2);return d(i.openTaskEditorById(n.id))})("editSubtask",function(n){r(e);let i=s(2);return d(i.openTaskEditorById(n))})("focusToggle",function(n){r(e);let i=s(2);return d(i.onFocusToggle(n))})("duplicate",function(n){r(e);let i=s(2);return d(i.onDuplicateTodo(n))}),l()()()}if(p&2){let e=o.$implicit,t=o.index,n=s(2);k("dragging",n.draggingIndex()===t)("drag-over",n.dragOverIndex()===t&&n.draggingIndex()!==t),a(2),v(t+1),a(2),g("todo",e)("highlightedTaskId",(n.editingTodo==null?null:n.editingTodo.id)||null)("showFocusToggle",!0)("hideConversionButtons",!0)}}function ue(p,o){if(p&1&&(c(0,"div",40),T(1,_e,5,9,"div",41),l()),p&2){let e=s();a(),g("ngForOf",e.focusService.todaysFocusTasks())}}function ge(p,o){if(p&1){let e=C();c(0,"button",37),x("click",function(){r(e);let n=s();return d(n.clearAllTodayTasks())}),u(1),l()}if(p&2){let e=s();g("title",e.translations().clearAllTodayTasks),a(),f(" ",e.translations().clearAll," ")}}function me(p,o){if(p&1&&(c(0,"div",38)(1,"div",39),u(2,"\u{1F4CB}"),l(),c(3,"h3"),u(4),l(),c(5,"p"),u(6),l()()),p&2){let e=s();a(4),v(e.translations().noTasksForTodayYet),a(2),v(e.translations().selectTasksForToday)}}function ve(p,o){if(p&1){let e=C();c(0,"div",42),x("dragstart",function(n){let i=r(e).index,_=s(2);return d(_.onTodayTaskDragStart(i,n))})("dragenter",function(n){let i=r(e).index,_=s(2);return d(_.onTodayTaskDragEnter(i,n))})("dragover",function(n){let i=r(e).index,_=s(2);return d(_.onTodayTaskDragOver(i,n))})("dragleave",function(n){let i=r(e).index,_=s(2);return d(_.onTodayTaskDragLeave(i,n))})("drop",function(n){let i=r(e).index,_=s(2);return d(_.onTodayTaskDrop(i,n))})("dragend",function(){r(e);let n=s(2);return d(n.onTodayTaskDragEnd())}),c(1,"div",43),u(2),l(),c(3,"div",44)(4,"app-todo-item",46),x("toggle",function(n){r(e);let i=s(2);return d(i.onToggleTodo(n))})("delete",function(n){r(e);let i=s(2);return d(i.onDeleteTodo(n))})("archive",function(n){r(e);let i=s(2);return d(i.onArchiveTodo(n))})("unarchive",function(n){r(e);let i=s(2);return d(i.onUnarchiveTodo(n))})("update",function(n){r(e);let i=s(2);return d(i.onUpdateTodo(n))})("addSubtaskEvent",function(n){r(e);let i=s(2);return d(i.onAddSubtask(n))})("toggleExpanded",function(n){r(e);let i=s(2);return d(i.onToggleExpanded(n))})("subtaskDrop",function(n){r(e);let i=s(2);return d(i.onSubtaskDrop(n))})("edit",function(){let n=r(e).$implicit,i=s(2);return d(i.openTaskEditorById(n.id))})("editSubtask",function(n){r(e);let i=s(2);return d(i.openTaskEditorById(n))})("focusToggle",function(n){r(e);let i=s(2);return d(i.onFocusToggle(n))})("todayTaskToggle",function(n){r(e);let i=s(2);return d(i.onTodayTaskToggle(n))})("duplicate",function(n){r(e);let i=s(2);return d(i.onDuplicateTodo(n))}),l()()()}if(p&2){let e=o.$implicit,t=o.index,n=s(2);k("dragging",n.draggingTodayTaskIndex()===t)("drag-over",n.dragOverTodayTaskIndex()===t&&n.draggingTodayTaskIndex()!==t),a(2),v(t+1),a(2),g("todo",e)("highlightedTaskId",(n.editingTodo==null?null:n.editingTodo.id)||null)("showFocusToggle",!0)("hideConversionButtons",!0)}}function fe(p,o){if(p&1&&(c(0,"div",40),T(1,ve,5,9,"div",41),l()),p&2){let e=s();a(),g("ngForOf",e.focusService.todaysTasks())}}function Te(p,o){if(p&1&&(c(0,"option",47),u(1),l()),p&2){let e=o.$implicit;g("value",e.id),a(),f(" ",e.name," ")}}function xe(p,o){if(p&1&&(c(0,"p"),u(1),l()),p&2){let e=s(2);a(),v(e.translations().tryAdjustingFilters)}}function ke(p,o){if(p&1&&(c(0,"p"),u(1),l()),p&2){let e=s(2);a(),v(e.translations().allTasksInFocusOrCompleted)}}function he(p,o){if(p&1&&(c(0,"div",38)(1,"div",39),u(2,"\u2705"),l(),c(3,"h3"),u(4),l(),T(5,xe,2,1,"p",48)(6,ke,2,1,"p",48),l()),p&2){let e=s();a(4),v(e.translations().noAvailableTasks),a(),g("ngIf",e.searchQuery||e.selectedProject),a(),g("ngIf",!e.searchQuery&&!e.selectedProject)}}function Ce(p,o){if(p&1){let e=C();c(0,"div",55),x("click",function(){r(e);let n=s().$implicit,i=s(2);return d(i.toggleProjectExpansion(n.projectId))}),c(1,"button",56),F(),c(2,"svg",12),S(3,"path",13),l()(),E(),c(4,"span",57),u(5),l(),c(6,"h3",58),u(7),l(),c(8,"span",15),u(9),l()()}if(p&2){let e=s().$implicit,t=s(2);k("expanded",t.isProjectExpanded(e.projectId)),a(),k("expanded",t.isProjectExpanded(e.projectId)),I("aria-expanded",t.isProjectExpanded(e.projectId))("aria-controls","project-tasks-"+e.projectId),a(3),O("color",t.getProjectColor(e.projectId)),a(),f(" ",t.getProjectIcon(e.projectId)," "),a(2),v(e.projectName),a(2),f("(",e.tasks.length,")")}}function be(p,o){if(p&1){let e=C();c(0,"app-todo-item",46),x("toggle",function(n){r(e);let i=s(3);return d(i.onToggleTodo(n))})("delete",function(n){r(e);let i=s(3);return d(i.onDeleteTodo(n))})("archive",function(n){r(e);let i=s(3);return d(i.onArchiveTodo(n))})("unarchive",function(n){r(e);let i=s(3);return d(i.onUnarchiveTodo(n))})("update",function(n){r(e);let i=s(3);return d(i.onUpdateTodo(n))})("addSubtaskEvent",function(n){r(e);let i=s(3);return d(i.onAddSubtask(n))})("toggleExpanded",function(n){r(e);let i=s(3);return d(i.onToggleExpanded(n))})("subtaskDrop",function(n){r(e);let i=s(3);return d(i.onSubtaskDrop(n))})("edit",function(){let n=r(e).$implicit,i=s(3);return d(i.openTaskEditorById(n.id))})("editSubtask",function(n){r(e);let i=s(3);return d(i.openTaskEditorById(n))})("focusToggle",function(n){r(e);let i=s(3);return d(i.onFocusToggle(n))})("todayTaskToggle",function(n){r(e);let i=s(3);return d(i.onTodayTaskToggle(n))})("duplicate",function(n){r(e);let i=s(3);return d(i.onDuplicateTodo(n))}),l()}if(p&2){let e=o.$implicit,t=s(3);g("todo",e)("highlightedTaskId",(t.editingTodo==null?null:t.editingTodo.id)||null)("showFocusToggle",!0)("hideConversionButtons",!0)}}function ye(p,o){if(p&1&&(c(0,"div",51),T(1,Ce,10,11,"div",52),c(2,"div",53),T(3,be,1,4,"app-todo-item",54),l()()),p&2){let e=o.$implicit,t=s(2);a(),g("ngIf",!t.selectedProject),a(),k("collapsed",!t.selectedProject&&!t.isProjectExpanded(e.projectId)),g("id","project-tasks-"+e.projectId),a(),g("ngForOf",e.tasks)}}function Se(p,o){if(p&1&&(c(0,"div",49),T(1,ye,4,5,"div",50),l()),p&2){let e=s();a(),g("ngForOf",e.groupedAvailableTasks())}}var ae=class p{focusService=y(oe);todoService=y(ne);projectService=y(Z);confirmationService=y(te);translationService=y(ee);taskEditor;translations=R(()=>({todaysFocus:this.translationService.translate("focus.todaysFocus"),planAndTrackTasks:this.translationService.translate("focus.planAndTrackTasks"),completed:this.translationService.translate("focus.completed"),remaining:this.translationService.translate("focus.remaining"),estimated:this.translationService.translate("focus.estimated"),complete:this.translationService.translate("focus.complete"),focusTasks:this.translationService.translate("focus.focusTasks"),clearAll:this.translationService.translate("focus.clearAll"),clearAllFocusTasks:this.translationService.translate("focus.clearAllFocusTasks"),collapseFocusTasks:this.translationService.translate("focus.collapseFocusTasks"),expandFocusTasks:this.translationService.translate("focus.expandFocusTasks"),noFocusTasksYet:this.translationService.translate("focus.noFocusTasksYet"),selectTasksFromAvailable:this.translationService.translate("focus.selectTasksFromAvailable"),todaysTasks:this.translationService.translate("focus.todaysTasks"),clearAllTodayTasks:this.translationService.translate("focus.clearAllTodayTasks"),collapseTodayTasks:this.translationService.translate("focus.collapseTodayTasks"),expandTodayTasks:this.translationService.translate("focus.expandTodayTasks"),noTasksForTodayYet:this.translationService.translate("focus.noTasksForTodayYet"),selectTasksForToday:this.translationService.translate("focus.selectTasksForToday"),availableTasks:this.translationService.translate("focus.availableTasks"),collapseAvailableTasks:this.translationService.translate("focus.collapseAvailableTasks"),expandAvailableTasks:this.translationService.translate("focus.expandAvailableTasks"),searchTasks:this.translationService.translate("focus.searchTasks"),noAvailableTasks:this.translationService.translate("focus.noAvailableTasks"),tryAdjustingFilters:this.translationService.translate("focus.tryAdjustingFilters"),allTasksInFocusOrCompleted:this.translationService.translate("focus.allTasksInFocusOrCompleted"),allProjects:this.translationService.translate("common.allProjects"),noProject:this.translationService.translate("common.noProject"),unknownProject:this.translationService.translate("common.unknownProject"),clearAllFocusConfirm:this.translationService.translate("focus.clearAllFocusConfirm"),clearAllTodayTasksConfirm:this.translationService.translate("focus.clearAllTodayTasksConfirm"),deleteTaskConfirm:this.translationService.translate("searchPage.deleteTaskConfirm"),deleteTaskSubtext:this.translationService.translate("searchPage.deleteTaskSubtext"),deleteAction:this.translationService.translate("actions.delete"),cancelAction:this.translationService.translate("actions.cancel")}));editingTodo=null;searchQuery="";selectedProject="";expandedProjects=h(new Set);hasUserInteracted=!1;focusPanelExpanded=h(!0);availableTasksPanelExpanded=h(!0);todayTasksPanelExpanded=h(!0);draggingIndex=h(null);dragOverIndex=h(null);draggingTodayTaskIndex=h(null);dragOverTodayTaskIndex=h(null);timeEstimate=()=>this.focusService.getFocusTimeEstimate();filteredAvailableTasks=()=>{let o=this.focusService.availableTasks(),e=new Set(this.getAllTaskIds(this.focusService.todaysFocusTasks())),t=new Set(this.getAllTaskIds(this.focusService.todaysTasks())),n=new Set([...e,...t]),i=this.processTasksWithSmartSubtaskFiltering(o,n),_=i;if(this.searchQuery){let b=this.searchQuery.toLowerCase();_=this.filterTasksRecursively(i,V=>V.title.toLowerCase().includes(b)||(V.description?.toLowerCase().includes(b)??!1)||(V.category?.toLowerCase().includes(b)??!1))}return this.selectedProject&&(_=_.filter(b=>b.projectId===this.selectedProject)),_};groupedAvailableTasks=()=>{let o=this.filteredAvailableTasks();if(this.selectedProject)return[{projectId:this.selectedProject,projectName:this.getProjectName(this.selectedProject),tasks:o}];let e=new Map;for(let n of o){let i=n.projectId||"no-project",_=n.projectId?this.getProjectName(n.projectId):this.translations().noProject;e.has(i)||e.set(i,{projectId:i,projectName:_,tasks:[]}),e.get(i).tasks.push(n)}return Array.from(e.values()).sort((n,i)=>n.projectId==="no-project"?1:i.projectId==="no-project"?-1:n.projectName.localeCompare(i.projectName))};getAllTaskIds(o){let e=[];for(let t of o)e.push(t.id),t.subtasks.length>0&&e.push(...this.getAllTaskIds(t.subtasks));return e}processTasksWithSmartSubtaskFiltering(o,e){let t=[];for(let n of o)if(!e.has(n.id))if(n.completed){let i=this.getOrphanedSubtasks(n.subtasks,e);t.push(...i)}else{let i=this.filterSubtasksRecursively(n.subtasks,e),_=P(w({},n),{subtasks:i});t.push(_)}return t}getOrphanedSubtasks(o,e){let t=[];for(let n of o)if(!e.has(n.id))if(n.completed)n.subtasks.length>0&&t.push(...this.getOrphanedSubtasks(n.subtasks,e));else{let i=this.filterSubtasksRecursively(n.subtasks,e),_=P(w({},n),{subtasks:i});t.push(_)}return t}filterSubtasksRecursively(o,e){let t=[];for(let n of o){if(e.has(n.id)||n.completed)continue;let i=this.filterSubtasksRecursively(n.subtasks,e),_=P(w({},n),{subtasks:i});t.push(_)}return t}filterTasksRecursively(o,e){let t=[];for(let n of o){let i=e(n),_=this.filterTasksRecursively(n.subtasks,e);if(i||_.length>0){let b=P(w({},n),{subtasks:_});t.push(b)}}return t}getProjectName(o){return this.projectService.activeProjects().find(t=>t.id===o)?.name||this.translations().unknownProject}getProjectIcon(o){return o==="no-project"?"\u{1F4CB}":this.projectService.activeProjects().find(t=>t.id===o)?.icon||"\u{1F4CB}"}getProjectColor(o){return o==="no-project"?"#6b7280":this.projectService.activeProjects().find(t=>t.id===o)?.color||"#6b7280"}addFocus(o){return m(this,null,function*(){yield this.focusService.addToTodaysFocus(o)})}removeFocus(o){return m(this,null,function*(){yield this.focusService.removeFromTodaysFocus(o)})}onFocusToggle(o){return m(this,null,function*(){console.log("FocusComponent: Received focusToggle event for task:",o);let e=window.pageYOffset||document.documentElement.scrollTop;try{yield this.focusService.toggleTodaysFocus(o),console.log("FocusComponent: Successfully toggled focus for task:",o)}catch(t){console.error("FocusComponent: Error toggling focus for task:",o,t)}setTimeout(()=>{window.scrollTo(0,e)},0)})}onTodayTaskToggle(o){return m(this,null,function*(){console.log("FocusComponent: Received todayTaskToggle event for task:",o);let e=window.pageYOffset||document.documentElement.scrollTop;try{yield this.focusService.toggleTodaysTasks(o),console.log("FocusComponent: Successfully toggled today task for task:",o)}catch(t){console.error("FocusComponent: Error toggling today task for task:",o,t)}setTimeout(()=>{window.scrollTo(0,e)},0)})}clearAllFocus(){return m(this,null,function*(){confirm(this.translations().clearAllFocusConfirm)&&(yield this.focusService.clearTodaysFocus())})}clearAllTodayTasks(){return m(this,null,function*(){confirm(this.translations().clearAllTodayTasksConfirm)&&(yield this.focusService.clearTodaysTasks())})}updateSearch(o){let e=o.target;this.searchQuery=e.value}updateProjectFilter(){}toggleFocusPanelExpansion(){this.focusPanelExpanded.set(!this.focusPanelExpanded())}toggleAvailableTasksPanelExpansion(){this.availableTasksPanelExpanded.set(!this.availableTasksPanelExpanded())}toggleTodayTasksPanelExpansion(){this.todayTasksPanelExpanded.set(!this.todayTasksPanelExpanded())}toggleProjectExpansion(o){let e=this.expandedProjects(),t=new Set(e);if(e.size===0&&!this.hasUserInteracted){let n=this.groupedAvailableTasks().map(i=>i.projectId);t=new Set(n)}this.hasUserInteracted=!0,t.has(o)?t.delete(o):t.add(o),this.expandedProjects.set(t)}isProjectExpanded(o){let e=this.expandedProjects();return e.size===0&&!this.hasUserInteracted?!0:e.has(o)}onFocusTaskDragStart(o,e){this.draggingIndex.set(o),this.dragOverIndex.set(o);try{e.dataTransfer?.setData("text/plain",String(o)),e.dataTransfer?.setDragImage(new Image,0,0),e.dataTransfer.effectAllowed="move"}catch{}}onFocusTaskDragEnter(o,e){e.preventDefault(),this.draggingIndex()!==null&&this.draggingIndex()!==o&&this.dragOverIndex.set(o)}onFocusTaskDragOver(o,e){e.preventDefault(),this.draggingIndex()!==null&&(e.dataTransfer.dropEffect="move",this.dragOverIndex.set(o))}onFocusTaskDragLeave(o,e){e.preventDefault(),this.dragOverIndex()===o&&this.dragOverIndex.set(null)}onFocusTaskDrop(o,e){return m(this,null,function*(){e.preventDefault();let t=this.draggingIndex();t===null||t===o||(yield this.focusService.reorderFocusTasks(t,o),this.draggingIndex.set(null),this.dragOverIndex.set(null))})}onFocusTaskDragEnd(){this.draggingIndex.set(null),this.dragOverIndex.set(null)}onTodayTaskDragStart(o,e){this.draggingTodayTaskIndex.set(o),this.dragOverTodayTaskIndex.set(o);try{e.dataTransfer?.setData("text/plain",String(o)),e.dataTransfer?.setDragImage(new Image,0,0),e.dataTransfer.effectAllowed="move"}catch{}}onTodayTaskDragEnter(o,e){e.preventDefault(),this.draggingTodayTaskIndex()!==null&&this.draggingTodayTaskIndex()!==o&&this.dragOverTodayTaskIndex.set(o)}onTodayTaskDragOver(o,e){e.preventDefault(),this.draggingTodayTaskIndex()!==null&&(e.dataTransfer.dropEffect="move",this.dragOverTodayTaskIndex.set(o))}onTodayTaskDragLeave(o,e){e.preventDefault(),this.dragOverTodayTaskIndex()===o&&this.dragOverTodayTaskIndex.set(null)}onTodayTaskDrop(o,e){return m(this,null,function*(){e.preventDefault();let t=this.draggingTodayTaskIndex();t===null||t===o||(yield this.focusService.reorderTodaysTasks(t,o),this.draggingTodayTaskIndex.set(null),this.dragOverTodayTaskIndex.set(null))})}onTodayTaskDragEnd(){this.draggingTodayTaskIndex.set(null),this.dragOverTodayTaskIndex.set(null)}onToggleTodo(o){return m(this,null,function*(){yield this.todoService.toggleTodo(o)})}onDeleteTodo(o){return m(this,null,function*(){let e=this.findTodoById(o);if(!e)return;(yield this.confirmationService.open(this.translations().deleteTaskConfirm,`${this.translations().deleteTaskConfirm} "${e.title}"? ${this.translations().deleteTaskSubtext}`,this.translations().deleteAction,this.translations().cancelAction,!1))==="confirm"&&(yield this.todoService.deleteTodo(o))})}onDuplicateTodo(o){return m(this,null,function*(){try{yield this.todoService.duplicateTodo(o)}catch(e){console.error("Failed to duplicate todo:",e)}})}onArchiveTodo(o){return m(this,null,function*(){this.todoService.archiveTodo(o)})}onUnarchiveTodo(o){return m(this,null,function*(){this.todoService.unarchiveTodo(o)})}onUpdateTodo(o){return m(this,null,function*(){yield this.todoService.updateTodo(o.id,o.updates)})}onAddSubtask(o){return m(this,null,function*(){this.todoService.addSubtask(o.parentId,o.subtaskData)})}onToggleExpanded(o){this.todoService.toggleExpanded(o)}onSubtaskDrop(o){return m(this,null,function*(){console.log("Subtask drop not implemented yet:",o)})}openTaskEditorById(o){let e=this.todoService.getTodoById(o);e&&(this.editingTodo=e,this.taskEditor.open())}onSaveTask(o){return m(this,null,function*(){this.editingTodo&&(yield this.todoService.updateTodo(this.editingTodo.id,o),this.editingTodo=null,this.taskEditor.onClose())})}onCancelEdit(){this.editingTodo=null}findTodoById(o){let e=this.focusService.todaysFocusTasks(),t=this.findTodoByIdRecursive(e,o);if(t)return t;let n=this.focusService.availableTasks();return this.findTodoByIdRecursive(n,o)}findTodoByIdRecursive(o,e){for(let t of o){if(t.id===e)return t;if(t.subtasks.length>0){let n=this.findTodoByIdRecursive(t.subtasks,e);if(n)return n}}}formatTime(o){if(o<60)return`${o}m`;let e=Math.floor(o/60),t=o%60;return t>0?`${e}h ${t}m`:`${e}h`}static \u0275fac=function(e){return new(e||p)};static \u0275cmp=A({type:p,selectors:[["app-focus"]],viewQuery:function(e,t){if(e&1&&N(re,5),e&2){let n;B(n=z())&&(t.taskEditor=n.first)}},decls:68,vars:44,consts:[["taskEditor",""],[1,"focus-container"],[1,"focus-header"],[1,"header-content"],[1,"focus-icon"],[1,"focus-subtitle"],["class","focus-progress",4,"ngIf"],[1,"focus-content"],[1,"focus-section"],[1,"section-header"],[1,"section-title"],[1,"expand-toggle",3,"click","title"],["width","16","height","16","viewBox","0 0 20 20","fill","currentColor",1,"chevron"],["fill-rule","evenodd","d","M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707A1 1 0 118.707 5.293l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule","evenodd"],[1,"section-icon"],[1,"task-count"],[1,"section-actions"],["class","btn btn-secondary btn-sm",3,"title","click",4,"ngIf"],["id","focus-tasks-content"],["class","empty-state",4,"ngIf"],["class","focus-tasks-list",4,"ngIf"],["id","today-tasks-content"],[1,"available-section"],["type","text",1,"search-input",3,"ngModelChange","input","placeholder","ngModel"],[1,"filter-select",3,"ngModelChange","change","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["id","available-tasks-content"],["class","available-tasks-list",4,"ngIf"],[3,"save","cancel","todo"],[1,"focus-progress"],[1,"progress-stats"],[1,"stat"],["class","stat",4,"ngIf"],[1,"progress-bar"],[1,"progress-fill"],[1,"progress-text"],[1,"btn","btn-secondary","btn-sm",3,"click","title"],[1,"empty-state"],[1,"empty-icon"],[1,"focus-tasks-list"],["class","focus-task-item","draggable","true",3,"dragging","drag-over","dragstart","dragenter","dragover","dragleave","drop","dragend",4,"ngFor","ngForOf"],["draggable","true",1,"focus-task-item",3,"dragstart","dragenter","dragover","dragleave","drop","dragend"],[1,"task-order"],[1,"task-content"],[3,"toggle","delete","archive","unarchive","update","addSubtaskEvent","toggleExpanded","subtaskDrop","edit","editSubtask","focusToggle","duplicate","todo","highlightedTaskId","showFocusToggle","hideConversionButtons"],[3,"toggle","delete","archive","unarchive","update","addSubtaskEvent","toggleExpanded","subtaskDrop","edit","editSubtask","focusToggle","todayTaskToggle","duplicate","todo","highlightedTaskId","showFocusToggle","hideConversionButtons"],[3,"value"],[4,"ngIf"],[1,"available-tasks-list"],["class","project-group",4,"ngFor","ngForOf"],[1,"project-group"],["class","project-header",3,"expanded","click",4,"ngIf"],[1,"project-tasks",3,"id"],[3,"todo","highlightedTaskId","showFocusToggle","hideConversionButtons","toggle","delete","archive","unarchive","update","addSubtaskEvent","toggleExpanded","subtaskDrop","edit","editSubtask","focusToggle","todayTaskToggle","duplicate",4,"ngFor","ngForOf"],[1,"project-header",3,"click"],[1,"expand-toggle"],[1,"project-icon"],[1,"project-name"]],template:function(e,t){if(e&1){let n=C();c(0,"div",1)(1,"div",2)(2,"div",3)(3,"h1")(4,"span",4),u(5,"\u{1F3AF}"),l(),u(6),l(),c(7,"p",5),u(8),l()(),T(9,ce,15,9,"div",6),l(),c(10,"div",7)(11,"div",8)(12,"div",9)(13,"div",10)(14,"button",11),x("click",function(){return r(n),d(t.toggleFocusPanelExpansion())}),F(),c(15,"svg",12),S(16,"path",13),l()(),E(),c(17,"h2")(18,"span",14),u(19,"\u2B50"),l(),u(20),c(21,"span",15),u(22),l()()(),c(23,"div",16),T(24,le,2,2,"button",17),l()(),c(25,"div",18),T(26,pe,7,2,"div",19)(27,ue,2,1,"div",20),l()(),c(28,"div",8)(29,"div",9)(30,"div",10)(31,"button",11),x("click",function(){return r(n),d(t.toggleTodayTasksPanelExpansion())}),F(),c(32,"svg",12),S(33,"path",13),l()(),E(),c(34,"h2")(35,"span",14),u(36,"\u{1F4CB}"),l(),u(37),c(38,"span",15),u(39),l()()(),c(40,"div",16),T(41,ge,2,2,"button",17),l()(),c(42,"div",21),T(43,me,7,2,"div",19)(44,fe,2,1,"div",20),l()(),c(45,"div",22)(46,"div",9)(47,"div",10)(48,"button",11),x("click",function(){return r(n),d(t.toggleAvailableTasksPanelExpansion())}),F(),c(49,"svg",12),S(50,"path",13),l()(),E(),c(51,"h2")(52,"span",14),u(53,"\u{1F4CB}"),l(),u(54),c(55,"span",15),u(56),l()()(),c(57,"div",16)(58,"input",23),D("ngModelChange",function(_){return r(n),M(t.searchQuery,_)||(t.searchQuery=_),d(_)}),x("input",function(_){return r(n),d(t.updateSearch(_))}),l(),c(59,"select",24),D("ngModelChange",function(_){return r(n),M(t.selectedProject,_)||(t.selectedProject=_),d(_)}),x("change",function(){return r(n),d(t.updateProjectFilter())}),c(60,"option",25),u(61),l(),T(62,Te,2,2,"option",26),l()()(),c(63,"div",27),T(64,he,7,3,"div",19)(65,Se,2,1,"div",28),l()()(),c(66,"app-task-editor",29,0),x("save",function(_){return r(n),d(t.onSaveTask(_))})("cancel",function(){return r(n),d(t.onCancelEdit())}),l()()}e&2&&(a(6),f(" ",t.translations().todaysFocus," "),a(2),v(t.translations().planAndTrackTasks),a(),g("ngIf",t.focusService.focusProgress().total>0),a(5),k("expanded",t.focusPanelExpanded()),g("title",t.focusPanelExpanded()?t.translations().collapseFocusTasks:t.translations().expandFocusTasks),I("aria-expanded",t.focusPanelExpanded())("aria-controls","focus-tasks-content"),a(6),f(" ",t.translations().focusTasks," "),a(2),f("(",t.focusService.todaysFocusTasks().length,")"),a(2),g("ngIf",t.focusService.todaysFocusTasks().length>0),a(),k("collapsed",!t.focusPanelExpanded()),a(),g("ngIf",t.focusService.todaysFocusTasks().length===0),a(),g("ngIf",t.focusService.todaysFocusTasks().length>0),a(4),k("expanded",t.todayTasksPanelExpanded()),g("title",t.todayTasksPanelExpanded()?t.translations().collapseTodayTasks:t.translations().expandTodayTasks),I("aria-expanded",t.todayTasksPanelExpanded())("aria-controls","today-tasks-content"),a(6),f(" ",t.translations().todaysTasks," "),a(2),f("(",t.focusService.todaysTasks().length,")"),a(2),g("ngIf",t.focusService.todaysTasks().length>0),a(),k("collapsed",!t.todayTasksPanelExpanded()),a(),g("ngIf",t.focusService.todaysTasks().length===0),a(),g("ngIf",t.focusService.todaysTasks().length>0),a(4),k("expanded",t.availableTasksPanelExpanded()),g("title",t.availableTasksPanelExpanded()?t.translations().collapseAvailableTasks:t.translations().expandAvailableTasks),I("aria-expanded",t.availableTasksPanelExpanded())("aria-controls","available-tasks-content"),a(6),f(" ",t.translations().availableTasks," "),a(2),f("(",t.filteredAvailableTasks().length,")"),a(2),g("placeholder",t.translations().searchTasks),j("ngModel",t.searchQuery),a(),j("ngModel",t.selectedProject),a(2),v(t.translations().allProjects),a(),g("ngForOf",t.projectService.activeProjects()),a(),k("collapsed",!t.availableTasksPanelExpanded()),a(),g("ngIf",t.filteredAvailableTasks().length===0),a(),g("ngIf",t.filteredAvailableTasks().length>0),a(),g("todo",t.editingTodo))},dependencies:[U,Q,$,W,X,J,K,Y,q,H,G,se,ie],styles:[".focus-container[_ngcontent-%COMP%]{padding:2rem;max-width:1200px;margin:0 auto;min-height:100vh;overflow-anchor:none}.focus-header[_ngcontent-%COMP%]{margin-bottom:2rem;padding-bottom:1.5rem;border-bottom:1px solid #e5e7eb}.header-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;margin:0 0 .5rem;font-size:2.5rem;font-weight:700;color:#1f2937}.focus-icon[_ngcontent-%COMP%]{font-size:2.5rem}.focus-subtitle[_ngcontent-%COMP%]{margin:0;color:#6b7280;font-size:1.125rem}.focus-progress[_ngcontent-%COMP%]{margin-top:1.5rem;padding:1.5rem;background:linear-gradient(135deg,#f3f4f6,#e5e7eb);border-radius:12px;border:1px solid #d1d5db}.progress-stats[_ngcontent-%COMP%]{display:flex;gap:2rem;margin-bottom:1rem;flex-wrap:wrap}.stat[_ngcontent-%COMP%]{color:#374151;font-size:.875rem}.stat[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#1f2937;font-size:1.125rem}.progress-bar[_ngcontent-%COMP%]{width:100%;height:8px;background:#e5e7eb;border-radius:4px;overflow:hidden;margin-bottom:.5rem}.progress-fill[_ngcontent-%COMP%]{height:100%;background:linear-gradient(90deg,#10b981,#059669);border-radius:4px;transition:width .3s ease}.progress-text[_ngcontent-%COMP%]{font-size:.875rem;color:#6b7280;font-weight:500}.focus-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem}.focus-section[_ngcontent-%COMP%], .available-section[_ngcontent-%COMP%]{background:#fff;border-radius:12px;border:1px solid #e5e7eb;overflow:visible}.section-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1.5rem;background:#f9fafb;border-bottom:1px solid #e5e7eb}.section-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.section-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin:0;font-size:1.25rem;font-weight:600;color:#1f2937}.section-icon[_ngcontent-%COMP%]{font-size:1.25rem}.task-count[_ngcontent-%COMP%]{color:#6b7280;font-weight:400;font-size:1rem}.section-actions[_ngcontent-%COMP%]{display:flex;gap:.75rem;align-items:center}.search-input[_ngcontent-%COMP%]{padding:.5rem .75rem;border:1px solid #d1d5db;border-radius:6px;font-size:.875rem;width:200px}.search-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.filter-select[_ngcontent-%COMP%]{padding:.5rem .75rem;border:1px solid #d1d5db;border-radius:6px;font-size:.875rem;background:#fff;min-width:150px}.filter-select[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.btn[_ngcontent-%COMP%]{padding:.5rem 1rem;border:none;border-radius:6px;font-size:.875rem;font-weight:500;cursor:pointer;transition:all .2s ease;display:inline-flex;align-items:center;gap:.5rem}.btn-sm[_ngcontent-%COMP%]{padding:.375rem .75rem;font-size:.8125rem}.btn-secondary[_ngcontent-%COMP%]{background:#f3f4f6;color:#374151;border:1px solid #d1d5db}.btn-secondary[_ngcontent-%COMP%]:hover{background:#e5e7eb;border-color:#9ca3af}.expand-toggle[_ngcontent-%COMP%]{background:none;border:none;padding:.25rem;cursor:pointer;border-radius:4px;color:#6b7280;transition:all .2s ease;display:flex;align-items:center;justify-content:center}.expand-toggle[_ngcontent-%COMP%]:hover{background:#e5e7eb;color:#374151}.expand-toggle[_ngcontent-%COMP%]   .chevron[_ngcontent-%COMP%]{transition:transform .2s ease;transform:rotate(0)}.collapsed[_ngcontent-%COMP%]{display:none}.empty-state[_ngcontent-%COMP%]{padding:3rem 2rem;text-align:center;color:#6b7280}.empty-icon[_ngcontent-%COMP%]{font-size:3rem;margin-bottom:1rem}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 .5rem;color:#374151;font-size:1.25rem;font-weight:600}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.875rem}.focus-tasks-list[_ngcontent-%COMP%]{padding:1rem;overflow-anchor:none}.focus-task-item[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:1rem;padding:1rem;margin-bottom:.75rem;background:#f8fafc;border:1px solid #e2e8f0;border-radius:8px;cursor:move;transition:all .2s ease}.focus-task-item[_ngcontent-%COMP%]:hover{background:#f1f5f9;border-color:#cbd5e1}.focus-task-item.dragging[_ngcontent-%COMP%]{opacity:.5;transform:rotate(2deg)}.focus-task-item.drag-over[_ngcontent-%COMP%]{border-color:#3b82f6;background:#eff6ff}.task-order[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:2rem;height:2rem;background:#3b82f6;color:#fff;border-radius:50%;font-weight:600;font-size:.875rem;flex-shrink:0;margin-top:.25rem}.task-content[_ngcontent-%COMP%]{flex:1;min-width:0}.available-tasks-list[_ngcontent-%COMP%]{padding:1rem;overflow-anchor:none}.project-group[_ngcontent-%COMP%]{margin-bottom:1.5rem}.project-group[_ngcontent-%COMP%]:last-child{margin-bottom:0}.project-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.75rem 1rem;margin-bottom:.75rem;background:#f8fafc;border:1px solid #e2e8f0;border-radius:8px;font-weight:500;cursor:pointer;transition:all .2s ease;-webkit-user-select:none;user-select:none}.project-header[_ngcontent-%COMP%]:hover{background:#f1f5f9;border-color:#cbd5e1}.expand-toggle[_ngcontent-%COMP%]{background:none;border:none;color:#6b7280;cursor:pointer;padding:0;display:flex;align-items:center;justify-content:center;transition:transform .2s ease}.expand-toggle[_ngcontent-%COMP%]   .chevron[_ngcontent-%COMP%]{transition:transform .2s ease}.expand-toggle.expanded[_ngcontent-%COMP%]   .chevron[_ngcontent-%COMP%]{transform:rotate(90deg)}.project-icon[_ngcontent-%COMP%]{font-size:1.125rem}.project-name[_ngcontent-%COMP%]{margin:0;font-size:1rem;font-weight:600;color:#374151}.project-tasks[_ngcontent-%COMP%]{margin-left:.5rem;border-left:2px solid #f1f5f9;padding-left:1rem;transition:all .3s ease;overflow:visible}.project-tasks.collapsed[_ngcontent-%COMP%]{max-height:0;opacity:0;margin-bottom:0;padding-top:0;padding-bottom:0}@media (max-width: 768px){.focus-container[_ngcontent-%COMP%]{padding:1rem}.header-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], .focus-icon[_ngcontent-%COMP%]{font-size:2rem}.section-header[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch;gap:1rem}.section-actions[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.search-input[_ngcontent-%COMP%], .filter-select[_ngcontent-%COMP%]{width:100%}.progress-stats[_ngcontent-%COMP%]{gap:1rem}.focus-task-item[_ngcontent-%COMP%], .available-task-item[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch;gap:.75rem}.task-order[_ngcontent-%COMP%], .remove-focus-btn[_ngcontent-%COMP%], .add-focus-btn[_ngcontent-%COMP%]{align-self:flex-start}}"]})};export{ae as FocusComponent};
