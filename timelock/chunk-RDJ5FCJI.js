import{a as Ve}from"./chunk-KUROZOC7.js";import{a as Be}from"./chunk-G5S5IS6X.js";import{C as ee,h as we,i as Ce,j as Se,k as De,n as Pe,r as ye,s as Me,t as Oe,x as Ee}from"./chunk-RVASHVHN.js";import{$ as h,$a as F,$b as X,Ab as fe,Bb as $,Cb as _e,Db as Z,Eb as xe,Ga as U,Ib as C,Ka as T,Ua as ie,Va as oe,W as L,Wa as ae,Xa as _,Ya as r,Za as s,Zb as be,_a as y,_b as q,a as j,aa as f,ab as z,ac as ve,b as W,ba as Y,bb as re,bc as ke,c as R,ca as G,cb as O,cc as Te,db as b,dc as Q,eb as p,gb as se,hb as le,ib as ce,ja as w,jb as de,kb as B,kc as J,lb as D,lc as K,mb as H,mc as Ie,nb as c,ob as v,pb as u,qb as M,sb as ge,tb as E,ub as I,vb as V,wa as a,wb as ue,yb as me,zb as he}from"./chunk-NENYJKRB.js";var He=()=>[1,2,3,4],Ne=l=>({task:l,level:0}),Re=(l,n)=>({task:l,level:n});function $e(l,n){if(l&1&&(r(0,"option",59),c(1),s()),l&2){let e=n.$implicit,t=p(3);_("value",e.id),a(),ge(" ",e.icon," ",e.name," (",t.getProjectTaskCount(e.id)," ",t.t().tasks,") ")}}function Ye(l,n){if(l&1){let e=O();r(0,"div",55)(1,"label",56),c(2),s(),r(3,"select",57),b("ngModelChange",function(i){h(e);let o=p(2);return f(o.setSelectedProject(i))}),T(4,$e,2,5,"option",58),s()()}if(l&2){let e=p(2);a(2),v(e.t().selectProject),a(),_("ngModel",e.selectedProjectId()),a(),_("ngForOf",e.projectsWithTasks())}}function Ge(l,n){if(l&1){let e=O();r(0,"div",65),b("click",function(){let i=h(e).$implicit,o=p(3);return f(o.toggleTagSelection(i.name))}),c(1),s()}if(l&2){let e=n.$implicit,t=p(3);B("background-color",e.color)("color",t.getTagTextColor(e.color)),D("selected",t.selectedTags().includes(e.name)),a(),M(" ",e.name," (",e.taskCount,") ")}}function Ue(l,n){if(l&1){let e=O();r(0,"div",60)(1,"label"),c(2),s(),r(3,"div",61),T(4,Ge,2,8,"div",62),s(),r(5,"div",63)(6,"button",64),b("click",function(){h(e);let i=p(2);return f(i.selectAllTags())}),c(7),s(),r(8,"button",64),b("click",function(){h(e);let i=p(2);return f(i.clearTagSelection())}),c(9),s()()()}if(l&2){let e=p(2);a(2),v(e.t().selectTags),a(2),_("ngForOf",e.tagsWithTasks()),a(3),u(" ",e.t().selectAllTags," "),a(2),u(" ",e.t().clearTags," ")}}function Ze(l,n){l&1&&re(0)}function qe(l,n){if(l&1&&(F(0),T(1,Ze,1,0,"ng-container",66),z()),l&2){let e=n.$implicit;p();let t=de(38);a(),_("ngTemplateOutlet",t)("ngTemplateOutletContext",he(2,Ne,e))}}function Xe(l,n){if(l&1&&y(0,"div",80),l&2){let e=p().level;B("width",e*20,"px")}}function Qe(l,n){l&1&&(r(0,"span",81),c(1,"\u{1F4C1}"),s())}function Je(l,n){l&1&&(r(0,"span",81),c(1,"\u{1F4C4}"),s())}function Ke(l,n){l&1&&(r(0,"span",81),c(1,"\u{1F4DD}"),s())}function et(l,n){if(l&1&&(r(0,"span",82),c(1),s()),l&2){let e=p().task,t=p(2);a(),v(t.getProjectName(e.projectId))}}function tt(l,n){if(l&1&&(r(0,"span",83),c(1),s()),l&2){let e=p().task,t=p(2);a(),u(" ",t.formatDuration(e.duration)," ")}}function nt(l,n){if(l&1&&(r(0,"span",84),c(1),$(2,"date"),s()),l&2){let e=p().task,t=p(2);a(),M(" ",t.t().due," ",Z(2,2,e.dueDate,"MMM d")," ")}}function it(l,n){if(l&1&&(r(0,"span",85),c(1),s()),l&2){let e=p().task,t=p(2);a(),M(" ",t.getSubtaskCount(e)," ",t.getSubtaskCount(e)>1?t.t().subtasks:t.t().subtask," ")}}function ot(l,n){l&1&&re(0)}function at(l,n){if(l&1&&(F(0),T(1,ot,1,0,"ng-container",66),z()),l&2){let e=n.$implicit,t=p().level;p();let i=de(38);a(),_("ngTemplateOutlet",i)("ngTemplateOutletContext",fe(2,Re,e,t+1))}}function rt(l,n){if(l&1){let e=O();r(0,"div",67),b("click",function(){let i=h(e).task,o=p(2);return f(o.toggleTaskSelection(i))}),T(1,Xe,1,2,"div",68),r(2,"div",69)(3,"input",70),b("change",function(){let i=h(e).task,o=p(2);return f(o.toggleTaskSelection(i))})("click",function(i){return h(e),f(i.stopPropagation())}),s()(),r(4,"div",71)(5,"div",72),T(6,Qe,2,0,"span",73)(7,Je,2,0,"span",73)(8,Ke,2,0,"span",73),c(9),s(),r(10,"div",74)(11,"span",75),c(12),s(),T(13,et,2,1,"span",76)(14,tt,2,1,"span",77)(15,nt,3,5,"span",78)(16,it,2,2,"span",79),s()()(),T(17,at,2,5,"ng-container",17)}if(l&2){let e=n.task,t=n.level,i=p(2);B("margin-left",t*20,"px"),D("main-task",t===0)("subtask",t>0)("selected",i.selectedTasks().has(e.id))("has-subtasks",e.subtasks&&e.subtasks.length>0)("filter-match",i.isFilterMatch(e))("context-item",!i.isFilterMatch(e)),a(),_("ngIf",t>0),a(2),_("checked",i.selectedTasks().has(e.id)),a(3),_("ngIf",t===0&&e.subtasks&&e.subtasks.length>0),a(),_("ngIf",t===0&&(!e.subtasks||e.subtasks.length===0)),a(),_("ngIf",t>0),a(),u(" ",e.title," "),a(2),H("priority-"+e.priority),a(),u(" ",e.priority," "),a(),_("ngIf",t===0),a(),_("ngIf",e.duration),a(),_("ngIf",e.dueDate),a(),_("ngIf",e.subtasks&&e.subtasks.length>0),a(),_("ngForOf",e.subtasks)}}function st(l,n){if(l&1){let e=O();r(0,"div",86)(1,"label"),c(2),s(),r(3,"input",23),V("ngModelChange",function(i){h(e);let o=p(2);return I(o.preferences.lunchBreak.start,i)||(o.preferences.lunchBreak.start=i),f(i)}),s(),r(4,"label"),c(5),s(),r(6,"select",28),V("ngModelChange",function(i){h(e);let o=p(2);return I(o.preferences.lunchBreak.duration,i)||(o.preferences.lunchBreak.duration=i),f(i)}),r(7,"option",35),c(8),s(),r(9,"option",36),c(10),s(),r(11,"option",37),c(12),s(),r(13,"option",38),c(14),s(),r(15,"option",39),c(16),s()()()}if(l&2){let e=p(2);a(2),v(e.t().time),a(),E("ngModel",e.preferences.lunchBreak.start),a(2),v(e.t().duration),a(),E("ngModel",e.preferences.lunchBreak.duration),a(2),u("30 ",e.t().min),a(2),u("45 ",e.t().min),a(2),u("1 ",e.t().hour),a(2),u("1.5 ",e.t().hours),a(2),u("2 ",e.t().hours)}}function lt(l,n){if(l&1){let e=O();r(0,"div",87)(1,"label"),c(2),s(),r(3,"select",28),V("ngModelChange",function(i){h(e);let o=p(2);return I(o.preferences.shortBreaks.duration,i)||(o.preferences.shortBreaks.duration=i),f(i)}),r(4,"option",30),c(5),s(),r(6,"option",31),c(7),s(),r(8,"option",32),c(9),s(),r(10,"option",33),c(11),s(),r(12,"option",34),c(13),s(),r(14,"option",35),c(15),s()(),r(16,"label"),c(17),s(),r(18,"select",28),V("ngModelChange",function(i){h(e);let o=p(2);return I(o.preferences.shortBreaks.frequency,i)||(o.preferences.shortBreaks.frequency=i),f(i)}),r(19,"option",37),c(20),s(),r(21,"option",38),c(22),s(),r(23,"option",39),c(24),s()()()}if(l&2){let e=p(2);a(2),v(e.t().breakDuration),a(),E("ngModel",e.preferences.shortBreaks.duration),a(2),u("5 ",e.t().min),a(2),u("10 ",e.t().min),a(2),u("15 ",e.t().min),a(2),u("20 ",e.t().min),a(2),u("25 ",e.t().min),a(2),u("30 ",e.t().min),a(2),v(e.t().every),a(),E("ngModel",e.preferences.shortBreaks.frequency),a(2),u("1 ",e.t().hour),a(2),u("1.5 ",e.t().hours),a(2),u("2 ",e.t().hours)}}function ct(l,n){if(l&1){let e=O();r(0,"div",88)(1,"label"),c(2),s(),r(3,"select",28),V("ngModelChange",function(i){h(e);let o=p(2);return I(o.preferences.taskChunking.maxChunkSize,i)||(o.preferences.taskChunking.maxChunkSize=i),f(i)}),r(4,"option",32),c(5),s(),r(6,"option",33),c(7),s(),r(8,"option",34),c(9),s(),r(10,"option",35),c(11),s(),r(12,"option",36),c(13),s(),r(14,"option",37),c(15),s(),r(16,"option",38),c(17),s(),r(18,"option",39),c(19),s()()()}if(l&2){let e=p(2);a(2),v(e.t().maximumChunkSize),a(),E("ngModel",e.preferences.taskChunking.maxChunkSize),a(2),u("15 ",e.t().min),a(2),u("20 ",e.t().min),a(2),u("25 ",e.t().min),a(2),u("30 ",e.t().min),a(2),u("45 ",e.t().min),a(2),u("1 ",e.t().hour),a(2),u("1.5 ",e.t().hours),a(2),u("2 ",e.t().hours)}}function dt(l,n){if(l&1){let e=O();r(0,"div",89)(1,"label"),c(2),s(),r(3,"input",23),V("ngModelChange",function(i){h(e);let o=p(2);return I(o.preferences.peakHours.start,i)||(o.preferences.peakHours.start=i),f(i)}),s(),r(4,"span"),c(5),s(),r(6,"input",23),V("ngModelChange",function(i){h(e);let o=p(2);return I(o.preferences.peakHours.end,i)||(o.preferences.peakHours.end=i),f(i)}),s()()}if(l&2){let e=p(2);a(2),v(e.t().peakHours),a(),E("ngModel",e.preferences.peakHours.start),a(2),v(e.t().to),a(),E("ngModel",e.preferences.peakHours.end)}}function pt(l,n){if(l&1&&(r(0,"div",95),c(1),s()),l&2){let e=p().$implicit;a(),v(e.reason)}}function gt(l,n){if(l&1&&(r(0,"div",90)(1,"div",91),c(2),$(3,"date"),$(4,"date"),s(),r(5,"div",92)(6,"div",93),c(7),s(),T(8,pt,2,1,"div",94),s()()),l&2){let e=n.$implicit;H("item-"+e.type),a(2),M(" ",Z(3,6,e.startTime,"shortTime")," - ",Z(4,9,e.endTime,"shortTime")," "),a(5),v(e.title),a(),_("ngIf",e.reason)}}function ut(l,n){if(l&1&&y(0,"span",96),l&2){let e=n.$implicit,t=p(2);D("active",t.currentStep()===e)("completed",t.currentStep()>e)}}function mt(l,n){if(l&1){let e=O();r(0,"button",50),b("click",function(){h(e);let i=p(2);return f(i.nextStep())}),c(1),s()}if(l&2){let e=p(2);_("disabled",!e.canProceed()),a(),u(" ",e.t().next," \u2192 ")}}function ht(l,n){if(l&1){let e=O();r(0,"button",97),b("click",function(){h(e);let i=p(2);return f(i.applySchedule())}),c(1),s()}if(l&2){let e=p(2);_("disabled",e.scheduledTasks().length===0),a(),u(" \u2705 ",e.t().applySchedule," ")}}function ft(l,n){if(l&1){let e=O();r(0,"div",2),b("click",function(){h(e);let i=p();return f(i.closeDialog())}),r(1,"div",3),b("click",function(i){return h(e),f(i.stopPropagation())}),r(2,"header",4)(3,"h2"),c(4),s(),r(5,"button",5),b("click",function(){h(e);let i=p();return f(i.closeDialog())}),c(6,"\xD7"),s()(),r(7,"div",6)(8,"div",7)(9,"h3"),c(10),s(),r(11,"input",8),b("ngModelChange",function(i){h(e);let o=p();return f(o.onDateChange(i))}),s(),r(12,"p",9),c(13),s()(),r(14,"div",7)(15,"h3"),c(16),s(),r(17,"div",10)(18,"div",11)(19,"button",12),b("click",function(){h(e);let i=p();return f(i.setTaskFilter("all"))}),c(20),s(),r(21,"button",12),b("click",function(){h(e);let i=p();return f(i.setTaskFilter("high"))}),c(22),s(),r(23,"button",12),b("click",function(){h(e);let i=p();return f(i.setTaskFilter("due"))}),c(24),s(),r(25,"button",13),b("click",function(){h(e);let i=p();return f(i.setTaskFilter("project"))}),c(26),s(),r(27,"button",13),b("click",function(){h(e);let i=p();return f(i.setTaskFilter("tags"))}),c(28),s(),r(29,"button",13),b("click",function(){h(e);let i=p();return f(i.setTaskFilter("focus"))}),c(30),s(),r(31,"button",12),b("click",function(){h(e);let i=p();return f(i.setTaskFilter("duration"))}),c(32),s()(),T(33,Ye,5,3,"div",14)(34,Ue,10,4,"div",15),r(35,"div",16),T(36,qe,2,4,"ng-container",17)(37,rt,18,28,"ng-template",null,0,xe),s(),r(39,"div",18)(40,"button",19),b("click",function(){h(e);let i=p();return f(i.selectAllTasks())}),c(41),s(),r(42,"button",19),b("click",function(){h(e);let i=p();return f(i.clearTaskSelection())}),c(43),s()()()(),r(44,"div",7)(45,"h3"),c(46),s(),r(47,"div",20)(48,"div",21)(49,"h4"),c(50),s(),r(51,"div",22)(52,"label"),c(53),s(),r(54,"input",23),V("ngModelChange",function(i){h(e);let o=p();return I(o.preferences.workingHours.start,i)||(o.preferences.workingHours.start=i),f(i)}),s(),r(55,"label"),c(56),s(),r(57,"input",23),V("ngModelChange",function(i){h(e);let o=p();return I(o.preferences.workingHours.end,i)||(o.preferences.workingHours.end=i),f(i)}),s()()(),r(58,"div",21)(59,"h4"),c(60),s(),r(61,"label",24)(62,"input",25),V("ngModelChange",function(i){h(e);let o=p();return I(o.preferences.lunchBreak.enabled,i)||(o.preferences.lunchBreak.enabled=i),f(i)}),s(),c(63),s(),T(64,st,17,9,"div",26),s(),r(65,"div",21)(66,"h4"),c(67),s(),r(68,"label",24)(69,"input",25),V("ngModelChange",function(i){h(e);let o=p();return I(o.preferences.shortBreaks.enabled,i)||(o.preferences.shortBreaks.enabled=i),f(i)}),s(),c(70),s(),T(71,lt,25,13,"div",27),s(),r(72,"div",21)(73,"h4"),c(74),s(),r(75,"label"),c(76),s(),r(77,"select",28),V("ngModelChange",function(i){h(e);let o=p();return I(o.preferences.bufferTime,i)||(o.preferences.bufferTime=i),f(i)}),r(78,"option",29),c(79),s(),r(80,"option",30),c(81),s(),r(82,"option",31),c(83),s(),r(84,"option",32),c(85),s(),r(86,"option",33),c(87),s(),r(88,"option",34),c(89),s(),r(90,"option",35),c(91),s()()(),r(92,"div",21)(93,"h4"),c(94),s(),r(95,"label"),c(96),s(),r(97,"select",28),V("ngModelChange",function(i){h(e);let o=p();return I(o.preferences.defaultTaskDuration,i)||(o.preferences.defaultTaskDuration=i),f(i)}),r(98,"option",32),c(99),s(),r(100,"option",35),c(101),s(),r(102,"option",36),c(103),s(),r(104,"option",37),c(105),s(),r(106,"option",38),c(107),s(),r(108,"option",39),c(109),s()()(),r(110,"div",21)(111,"h4"),c(112),s(),r(113,"label",24)(114,"input",25),V("ngModelChange",function(i){h(e);let o=p();return I(o.preferences.taskChunking.enabled,i)||(o.preferences.taskChunking.enabled=i),f(i)}),s(),c(115),r(116,"span",40),c(117),s()(),T(118,ct,20,10,"div",41),s(),r(119,"div",21)(120,"h4"),c(121),s(),r(122,"div")(123,"label",24)(124,"input",25),V("ngModelChange",function(i){h(e);let o=p();return I(o.preferences.energyOptimization,i)||(o.preferences.energyOptimization=i),f(i)}),s(),c(125),r(126,"span",40),c(127),s()()(),T(128,dt,7,4,"div",42),r(129,"div")(130,"label",24)(131,"input",25),V("ngModelChange",function(i){h(e);let o=p();return I(o.preferences.projectGrouping,i)||(o.preferences.projectGrouping=i),f(i)}),s(),c(132),r(133,"span",40),c(134),s()()()()()(),r(135,"div",7)(136,"h3"),c(137),s(),r(138,"div",43)(139,"div",44)(140,"h4"),c(141),s(),r(142,"div",45)(143,"span"),c(144),s(),r(145,"span"),c(146),s(),r(147,"span"),c(148),s()()(),r(149,"div",46),T(150,gt,9,12,"div",47),s()()()(),r(151,"footer",48)(152,"div",49)(153,"button",50),b("click",function(){h(e);let i=p();return f(i.previousStep())}),c(154),s(),r(155,"div",51),T(156,ut,1,4,"span",52),s(),T(157,mt,2,2,"button",53)(158,ht,2,2,"button",54),s()()()()}if(l&2){let e=p();a(4),v(e.t().title),a(4),D("active",e.currentStep()===1),a(2),u("\u{1F4C5} ",e.t().selectDate),a(),_("ngModel",e.selectedDateStr()),a(2),v(e.t().chooseDateDescription),a(),D("active",e.currentStep()===2),a(2),u("\u{1F4CB} ",e.t().selectTasks),a(3),D("active",e.taskFilter()==="all"),a(),M(" ",e.t().allUnscheduled," (",e.unscheduledTasks().length,") "),a(),D("active",e.taskFilter()==="high"),a(),M(" ",e.t().highPriority," (",e.highPriorityTasks().length,") "),a(),D("active",e.taskFilter()==="due"),a(),M(" ",e.t().dueSoon," (",e.dueSoonTasks().length,") "),a(),D("active",e.taskFilter()==="project"),_("disabled",e.projectsWithTasks().length===0),a(),M(" ",e.t().byProject," (",e.projectsWithTasks().length,") "),a(),D("active",e.taskFilter()==="tags"),_("disabled",e.tagsWithTasks().length===0),a(),M(" ",e.t().byTags," (",e.tagsWithTasks().length,") "),a(),D("active",e.taskFilter()==="focus"),_("disabled",e.focusTasks().length===0),a(),M(" \u{1F3AF} ",e.t().focusTasks," (",e.focusTasks().length,") "),a(),D("active",e.taskFilter()==="duration"),a(),M(" \u23F1\uFE0F ",e.t().withDuration," (",e.tasksWithDuration().length,") "),a(),_("ngIf",e.taskFilter()==="project"&&e.projectsWithTasks().length>0),a(),_("ngIf",e.taskFilter()==="tags"&&e.tagsWithTasks().length>0),a(2),_("ngForOf",e.hierarchicalTasks()),a(5),u(" ",e.t().selectAll," "),a(2),u(" ",e.t().clearAll," "),a(),D("active",e.currentStep()===3),a(2),u("\u2699\uFE0F ",e.t().planningPreferences),a(4),u("\u{1F550} ",e.t().workingHours),a(3),v(e.t().start),a(),E("ngModel",e.preferences.workingHours.start),a(2),v(e.t().end),a(),E("ngModel",e.preferences.workingHours.end),a(3),u("\u{1F37D}\uFE0F ",e.t().lunchBreak),a(2),E("ngModel",e.preferences.lunchBreak.enabled),a(),u(" ",e.t().enableLunchBreak," "),a(),_("ngIf",e.preferences.lunchBreak.enabled),a(3),u("\u2615 ",e.t().shortBreaks),a(2),E("ngModel",e.preferences.shortBreaks.enabled),a(),u(" ",e.t().addShortBreaks," "),a(),_("ngIf",e.preferences.shortBreaks.enabled),a(3),u("\u23F1\uFE0F ",e.t().bufferTime),a(2),v(e.t().minutesBetweenTasks),a(),E("ngModel",e.preferences.bufferTime),a(2),v(e.t().noBuffer),a(2),u("5 ",e.t().min),a(2),u("10 ",e.t().min),a(2),u("15 ",e.t().min),a(2),u("20 ",e.t().min),a(2),u("25 ",e.t().min),a(2),u("30 ",e.t().min),a(3),u("\u{1F4CF} ",e.t().defaultTaskDuration),a(2),v(e.t().durationForTasksWithoutSpecified),a(),E("ngModel",e.preferences.defaultTaskDuration),a(2),u("15 ",e.t().min),a(2),u("30 ",e.t().min),a(2),u("45 ",e.t().min),a(2),u("1 ",e.t().hour),a(2),u("1.5 ",e.t().hours),a(2),u("2 ",e.t().hours),a(3),u("\u2702\uFE0F ",e.t().taskChunking),a(2),E("ngModel",e.preferences.taskChunking.enabled),a(),u(" ",e.t().breakLongTasks," "),a(2),v(e.t().splitTasksHelp),a(),_("ngIf",e.preferences.taskChunking.enabled),a(3),u("\u{1F9E0} ",e.t().smartScheduling),a(3),E("ngModel",e.preferences.energyOptimization),a(),u(" ",e.t().energyOptimization," "),a(2),v(e.t().placeDemandingTasks),a(),_("ngIf",e.preferences.energyOptimization),a(3),E("ngModel",e.preferences.projectGrouping),a(),u(" ",e.t().projectGrouping," "),a(2),v(e.t().groupTasksFromSameProject),a(),D("active",e.currentStep()===4),a(2),u("\u{1F440} ",e.t().schedulePreview),a(4),v(e.formatDate(e.selectedDate())),a(3),M("",e.scheduledTasks().length," ",e.t().tasks),a(2),M("",e.getTotalScheduledTime()," ",e.t().scheduled),a(2),M("",e.getAvailableTime()," ",e.t().available),a(2),_("ngForOf",e.schedulePreview()),a(3),_("disabled",e.currentStep()===1),a(),u(" \u2190 ",e.t().previous," "),a(2),_("ngForOf",me(109,He)),a(),_("ngIf",e.currentStep()<4),a(),_("ngIf",e.currentStep()===4)}}var te=class l{todoService=L(ee);projectService=L(J);tagsService=L(Ie);focusService=L(Ve);translationService=L(K);currentLocale=C(()=>this.translationService.currentLanguage()==="fr"?"fr-FR":"en-US");t=C(()=>({title:this.translationService.translate("autoPlan.title"),selectDate:this.translationService.translate("autoPlan.selectDate"),chooseDateDescription:this.translationService.translate("autoPlan.chooseDateDescription"),selectTasks:this.translationService.translate("autoPlan.selectTasks"),allUnscheduled:this.translationService.translate("autoPlan.allUnscheduled"),highPriority:this.translationService.translate("autoPlan.highPriority"),dueSoon:this.translationService.translate("autoPlan.dueSoon"),byProject:this.translationService.translate("autoPlan.byProject"),byTags:this.translationService.translate("autoPlan.byTags"),focusTasks:this.translationService.translate("autoPlan.focusTasks"),withDuration:this.translationService.translate("autoPlan.withDuration"),selectProject:this.translationService.translate("autoPlan.selectProject"),selectTags:this.translationService.translate("autoPlan.selectTags"),selectAllTags:this.translationService.translate("autoPlan.selectAllTags"),clearTags:this.translationService.translate("autoPlan.clearTags"),selectAll:this.translationService.translate("autoPlan.selectAll"),clearAll:this.translationService.translate("autoPlan.clearAll"),planningPreferences:this.translationService.translate("autoPlan.planningPreferences"),workingHours:this.translationService.translate("autoPlan.workingHours"),start:this.translationService.translate("autoPlan.start"),end:this.translationService.translate("autoPlan.end"),lunchBreak:this.translationService.translate("autoPlan.lunchBreak"),enableLunchBreak:this.translationService.translate("autoPlan.enableLunchBreak"),time:this.translationService.translate("autoPlan.time"),duration:this.translationService.translate("autoPlan.duration"),shortBreaks:this.translationService.translate("autoPlan.shortBreaks"),addShortBreaks:this.translationService.translate("autoPlan.addShortBreaks"),breakDuration:this.translationService.translate("autoPlan.breakDuration"),every:this.translationService.translate("autoPlan.every"),bufferTime:this.translationService.translate("autoPlan.bufferTime"),minutesBetweenTasks:this.translationService.translate("autoPlan.minutesBetweenTasks"),noBuffer:this.translationService.translate("autoPlan.noBuffer"),defaultTaskDuration:this.translationService.translate("autoPlan.defaultTaskDuration"),durationForTasksWithoutSpecified:this.translationService.translate("autoPlan.durationForTasksWithoutSpecified"),taskChunking:this.translationService.translate("autoPlan.taskChunking"),breakLongTasks:this.translationService.translate("autoPlan.breakLongTasks"),splitTasksHelp:this.translationService.translate("autoPlan.splitTasksHelp"),maximumChunkSize:this.translationService.translate("autoPlan.maximumChunkSize"),smartScheduling:this.translationService.translate("autoPlan.smartScheduling"),energyOptimization:this.translationService.translate("autoPlan.energyOptimization"),placeDemandingTasks:this.translationService.translate("autoPlan.placeDemandingTasks"),peakHours:this.translationService.translate("autoPlan.peakHours"),to:this.translationService.translate("autoPlan.to"),projectGrouping:this.translationService.translate("autoPlan.projectGrouping"),groupTasksFromSameProject:this.translationService.translate("autoPlan.groupTasksFromSameProject"),schedulePreview:this.translationService.translate("autoPlan.schedulePreview"),tasks:this.translationService.translate("autoPlan.tasks"),scheduled:this.translationService.translate("autoPlan.scheduled"),available:this.translationService.translate("autoPlan.available"),regenerate:this.translationService.translate("autoPlan.regenerate"),export:this.translationService.translate("autoPlan.export"),previous:this.translationService.translate("autoPlan.previous"),next:this.translationService.translate("autoPlan.next"),applySchedule:this.translationService.translate("autoPlan.applySchedule"),lunchBreakTitle:this.translationService.translate("autoPlan.lunchBreakTitle"),scheduledBreak:this.translationService.translate("autoPlan.scheduledBreak"),subtask:this.translationService.translate("autoPlan.subtask"),subtasks:this.translationService.translate("autoPlan.subtasks"),due:this.translationService.translate("autoPlan.due"),min:this.translationService.translate("autoPlan.min"),hour:this.translationService.translate("autoPlan.hour"),hours:this.translationService.translate("autoPlan.hours")}));isOpenSignal=w(!1);isOpen=this.isOpenSignal.asReadonly();currentStepSignal=w(1);currentStep=this.currentStepSignal.asReadonly();selectedDateStrSignal=w(new Date().toISOString().split("T")[0]);selectedDateStr=this.selectedDateStrSignal.asReadonly();selectedDate=C(()=>{let[n,e,t]=this.selectedDateStrSignal().split("-").map(Number);return new Date(n,e-1,t)});taskFilterSignal=w("all");taskFilter=this.taskFilterSignal.asReadonly();selectedProjectIdSignal=w(null);selectedProjectId=this.selectedProjectIdSignal.asReadonly();selectedTagsSignal=w([]);selectedTags=this.selectedTagsSignal.asReadonly();selectedTasksSignal=w(new Set);selectedTasks=this.selectedTasksSignal.asReadonly();preferences={workingHours:{start:"09:00",end:"17:00"},lunchBreak:{enabled:!0,start:"12:00",duration:60},shortBreaks:{enabled:!0,duration:10,frequency:120},bufferTime:10,defaultTaskDuration:60,taskChunking:{enabled:!1,maxChunkSize:30},energyOptimization:!0,projectGrouping:!0,peakHours:{start:"09:00",end:"11:00"}};scheduledTasksSignal=w([]);scheduledTasks=this.scheduledTasksSignal.asReadonly();unscheduledTasks=C(()=>this.flattenTodos(this.todoService.todos()).filter(e=>!e.archived&&!e.completed&&!e.startDateTime&&!e.endDateTime));highPriorityTasks=C(()=>this.unscheduledTasks().filter(n=>n.priority==="high"));dueSoonTasks=C(()=>{let n=new Date;return n.setDate(n.getDate()+3),this.unscheduledTasks().filter(e=>e.dueDate&&new Date(e.dueDate)<=n)});focusTasks=C(()=>{let n=new Set(this.focusService.todaysFocusTasks().map(e=>e.id));return this.unscheduledTasks().filter(e=>n.has(e.id))});tasksWithDuration=C(()=>this.unscheduledTasks().filter(n=>!!(n.duration&&n.duration>0)));projectTasks=C(()=>{let n=this.selectedProjectId();return n?this.unscheduledTasks().filter(e=>e.projectId===n):[]});tagTasks=C(()=>{let n=this.selectedTags();return n.length===0?[]:this.unscheduledTasks().filter(e=>!e.tags||e.tags.length===0?!1:n.some(t=>e.tags.some(i=>i.toLowerCase()===t.toLowerCase())))});tagsWithTasks=C(()=>{let n=this.unscheduledTasks(),e=new Map;return n.forEach(t=>{t.tags&&t.tags.length>0&&t.tags.forEach(i=>{let o=i.toLowerCase();e.set(o,(e.get(o)||0)+1)})}),this.tagsService.tags().filter(t=>e.has(t.name.toLowerCase())).map(t=>W(j({},t),{taskCount:e.get(t.name.toLowerCase())||0}))});projectsWithTasks=C(()=>{let n=this.unscheduledTasks(),e=new Set(n.map(t=>t.projectId).filter(Boolean));return this.projectService.activeProjects().filter(t=>e.has(t.id))});filteredTasks=C(()=>{switch(this.taskFilter()){case"high":return this.highPriorityTasks();case"due":return this.dueSoonTasks();case"project":return this.projectTasks();case"tags":return this.tagTasks();case"focus":return this.focusTasks();case"duration":return this.tasksWithDuration();default:return this.unscheduledTasks()}});hierarchicalTasks=C(()=>{let n=this.filteredTasks(),e=this.unscheduledTasks(),t=new Map,i=[],o=new Set;e.forEach(m=>t.set(m.id,m));let d=m=>{for(let x of e)if(x.subtasks?.some(k=>k.id===m))return d(x.id)||x;return null};n.forEach(m=>{let x=d(m.id);x?o.add(x.id):o.add(m.id)});let g=m=>{if(!m.subtasks||m.subtasks.length===0)return[];let x=[];return m.subtasks.forEach(k=>{if(t.has(k.id)){let S=W(j({},k),{subtasks:g(k)});x.push(S)}}),x};return o.forEach(m=>{let x=t.get(m);if(x){let k=g(x),S=W(j({},x),{subtasks:k});i.push(S)}}),i});schedulePreview=C(()=>{let n=this.scheduledTasks(),e=[];if(n.forEach(t=>{e.push({type:"task",startTime:t.startTime,endTime:t.endTime,title:t.todo.title,reason:t.reason})}),this.preferences.lunchBreak.enabled){let t=this.parseTimeToDate(this.preferences.lunchBreak.start),i=new Date(t.getTime()+this.preferences.lunchBreak.duration*6e4);e.push({type:"lunch",startTime:t,endTime:i,title:`\u{1F37D}\uFE0F ${this.t().lunchBreakTitle}`,reason:this.t().scheduledBreak})}return this.preferences.shortBreaks.enabled&&n.length>0&&this.addShortBreaksToPreview(e,n),this.preferences.bufferTime>0&&n.length>1&&this.addBufferTimeToPreview(e,n),e.sort((t,i)=>t.startTime.getTime()-i.startTime.getTime())});open(){this.isOpenSignal.set(!0),this.currentStepSignal.set(1),this.generateSchedule()}closeDialog(){this.isOpenSignal.set(!1),this.currentStepSignal.set(1),this.selectedTasksSignal.set(new Set),this.scheduledTasksSignal.set([]),this.taskFilterSignal.set("all"),this.selectedProjectIdSignal.set(null),this.selectedTagsSignal.set([])}nextStep(){if(this.canProceed()){let n=this.currentStep()+1;this.currentStepSignal.set(n),n===4&&this.generateSchedule()}}previousStep(){this.currentStep()>1&&this.currentStepSignal.set(this.currentStep()-1)}canProceed(){switch(this.currentStep()){case 1:return!!this.selectedDateStr;case 2:return this.selectedTasks().size>0;case 3:return!0;default:return!0}}setTaskFilter(n){this.taskFilterSignal.set(n),n==="project"&&!this.selectedProjectId()&&this.projectsWithTasks().length>0&&this.selectedProjectIdSignal.set(this.projectsWithTasks()[0].id),n==="tags"&&this.selectedTags().length===0&&this.tagsWithTasks().length>0&&this.selectedTagsSignal.set([this.tagsWithTasks()[0].name])}setSelectedProject(n){this.selectedProjectIdSignal.set(n),this.taskFilter()!=="project"&&this.taskFilterSignal.set("project")}toggleTagSelection(n){let e=[...this.selectedTags()],t=e.indexOf(n);t===-1?e.push(n):e.splice(t,1),this.selectedTagsSignal.set(e),e.length>0&&this.taskFilter()!=="tags"&&this.taskFilterSignal.set("tags")}selectAllTags(){let n=this.tagsWithTasks().map(e=>e.name);this.selectedTagsSignal.set(n)}clearTagSelection(){this.selectedTagsSignal.set([])}toggleTaskSelection(n){let e=new Set(this.selectedTasks());e.has(n.id)?e.delete(n.id):e.add(n.id),this.selectedTasksSignal.set(e)}selectAllTasks(){let n=new Set;this.hierarchicalTasks().forEach(e=>{n.add(e.id),e.subtasks?.forEach(t=>{n.add(t.id)})}),this.selectedTasksSignal.set(n)}clearTaskSelection(){this.selectedTasksSignal.set(new Set)}onDateChange(n){this.selectedDateStrSignal.set(n),this.currentStep()===4&&this.generateSchedule()}flattenTodos(n){let e=[];for(let t of n)e.push(t),t.subtasks&&t.subtasks.length>0&&e.push(...this.flattenTodos(t.subtasks));return e}getProjectName(n){return this.projectService.projects().find(t=>t.id===n)?.name||"No Project"}getProjectTaskCount(n){return this.unscheduledTasks().filter(e=>e.projectId===n).length}getSubtaskCount(n){let e=t=>!t.subtasks||t.subtasks.length===0?0:t.subtasks.length+t.subtasks.reduce((i,o)=>i+e(o),0);return e(n)}isFilterMatch(n){let e=this.taskFilter(),t=this.selectedProjectId(),i=this.selectedTags(),o=new Set(this.focusService.todaysFocusTasks().map(d=>d.id));switch(e){case"high":return n.priority==="high";case"due":let d=new Date;return d.setDate(d.getDate()+3),n.dueDate?new Date(n.dueDate)<=d:!1;case"project":return t?n.projectId===t:!1;case"tags":return i.length===0||!n.tags||n.tags.length===0?!1:i.some(g=>n.tags.some(m=>m.toLowerCase()===g.toLowerCase()));case"focus":return o.has(n.id);case"duration":return!!(n.duration&&n.duration>0);case"all":default:return!0}}formatDuration(n){if(n<60)return`${n}m`;let e=Math.floor(n/60),t=n%60;return t===0?`${e}h`:`${e}h ${t}m`}getTagTextColor(n){let e=n.replace("#",""),t=parseInt(e.substr(0,2),16),i=parseInt(e.substr(2,2),16),o=parseInt(e.substr(4,2),16);return(t*299+i*587+o*114)/1e3>128?"#000000":"#ffffff"}parseTimeToDate(n){let[e,t]=n.split(":").map(Number),i=new Date(this.selectedDate());return i.setHours(e,t,0,0),i}getTotalScheduledTime(){let n=this.scheduledTasks().reduce((e,t)=>{let i=t.endTime.getTime()-t.startTime.getTime();return e+i},0);return this.formatDuration(n/6e4)}getAvailableTime(){let n=this.parseTimeToDate(this.preferences.workingHours.start),t=this.parseTimeToDate(this.preferences.workingHours.end).getTime()-n.getTime(),i=this.scheduledTasks().reduce((d,g)=>{let m=g.endTime.getTime()-g.startTime.getTime();return d+m},0),o=t-i;return this.formatDuration(o/6e4)}formatDate(n){return n.toLocaleDateString(this.currentLocale(),{weekday:"long",year:"numeric",month:"long",day:"numeric"})}generateSchedule(){let n=this.selectedTasks(),e=this.unscheduledTasks().filter(i=>n.has(i.id));if(e.length===0){this.scheduledTasksSignal.set([]);return}console.log(" Auto-plan generating schedule for:",this.selectedDateStr()),console.log(" Selected date object:",this.selectedDate()),console.log(" Work start time:",this.parseTimeToDate(this.preferences.workingHours.start)),console.log(" Work end time:",this.parseTimeToDate(this.preferences.workingHours.end));let t=this.scheduleTasksIntelligently(e);this.scheduledTasksSignal.set(t)}scheduleTasksIntelligently(n){let e=this.generateTimeSlots(),t=this.prioritizeTasks(n),i=this.preferences.taskChunking.enabled?this.createTaskChunks(t):t,o=[],d=this.parseTimeToDate(this.preferences.workingHours.start),g=new Date(d);for(let m of i){let x=m.duration||this.preferences.defaultTaskDuration;if(this.preferences.shortBreaks.enabled&&o.length>0&&(d.getTime()-g.getTime())/6e4>=this.preferences.shortBreaks.frequency&&(d=new Date(d.getTime()+this.preferences.shortBreaks.duration*6e4),g=new Date(d)),this.preferences.lunchBreak.enabled){let S=this.parseTimeToDate(this.preferences.lunchBreak.start),P=new Date(S.getTime()+this.preferences.lunchBreak.duration*6e4),A=new Date(d.getTime()+x*6e4);d<P&&A>S&&(d=new Date(P))}let k=this.findBestTimeSlotFromTime(e,x,d,m);if(k){let S=new Date(k.start),P=new Date(S.getTime()+x*6e4);o.push({todo:m,startTime:S,endTime:P,reason:this.getSchedulingReason(m,k)}),this.updateTimeSlots(e,S,P),d=new Date(P.getTime()+this.preferences.bufferTime*6e4)}}return o}createTaskChunks(n){let e=[];for(let t of n){let i=t.duration||this.preferences.defaultTaskDuration,o=this.preferences.taskChunking.maxChunkSize;if(i<=o)e.push(t);else{let d=Math.ceil(i/o);for(let g=0;g<d;g++){let x=g===d-1?i-g*o:o,k=W(j({},t),{id:`${t.id}_chunk_${g+1}`,title:`${t.title} (${g+1}/${d})`,duration:x,description:t.description?`${t.description}

[Chunk ${g+1} of ${d} - ${this.formatDuration(x)}]`:`[Chunk ${g+1} of ${d} - ${this.formatDuration(x)}]`});e.push(k)}}}return e}generateTimeSlots(){let n=[],e=this.parseTimeToDate(this.preferences.workingHours.start),t=this.parseTimeToDate(this.preferences.workingHours.end),i=this.getExistingTasksForSelectedDate(),o=new Date(e);for(;o<t;){if(this.preferences.lunchBreak.enabled){let m=this.parseTimeToDate(this.preferences.lunchBreak.start),x=new Date(m.getTime()+this.preferences.lunchBreak.duration*6e4);if(o>=m&&o<x){o=new Date(x);continue}}let d=new Date(o.getTime()+15*6e4);!i.some(m=>{let x=new Date(m.startDateTime),k=new Date(m.endDateTime);return o<k&&d>x})&&d<=t&&n.push({start:new Date(o),end:d,duration:15,type:"work"}),o=d}return n}getExistingTasksForSelectedDate(){let n=this.selectedDate();return this.flattenTodos(this.todoService.todos()).filter(t=>{if(!t.startDateTime||!t.endDateTime||t.archived)return!1;let i=new Date(t.startDateTime),o=new Date(t.endDateTime),d=new Date(n);d.setHours(0,0,0,0);let g=new Date(n);return g.setHours(23,59,59,999),i<g&&o>d})}prioritizeTasks(n){return n.sort((e,t)=>{let i={high:3,medium:2,low:1},o=i[t.priority]-i[e.priority];if(o!==0)return o;if(e.dueDate&&t.dueDate){let m=new Date(e.dueDate).getTime()-new Date(t.dueDate).getTime();if(m!==0)return m}if(e.dueDate&&!t.dueDate)return-1;if(!e.dueDate&&t.dueDate)return 1;let d=e.duration||60,g=t.duration||60;return d-g})}findBestTimeSlot(n,e,t,i){for(let o=t;o<n.length;o++){let d=this.getConsecutiveSlots(n,o,e);if(d.length*15>=e)return{start:d[0].start,end:d[d.length-1].end,duration:e,type:"work"}}return null}findBestTimeSlotFromTime(n,e,t,i){let o=n.findIndex(g=>g.start>=t);if(o===-1)return null;let d=this.getExistingTasksForSelectedDate();if(this.preferences.energyOptimization&&i.priority==="high"){let g=this.parseTimeToDate(this.preferences.peakHours.start),m=this.parseTimeToDate(this.preferences.peakHours.end);for(let x=o;x<n.length;x++){let k=n[x];if(k.start>=g&&k.start<m){let S=this.getConsecutiveSlots(n,x,e);if(S.length*15>=e){let P=S[0].start,A=new Date(P.getTime()+e*6e4);if(!this.hasOverlapWithExistingTasks(P,A,d))return{start:P,end:A,duration:e,type:"work"}}}}}for(let g=o;g<n.length;g++){let m=this.getConsecutiveSlots(n,g,e);if(m.length*15>=e){let x=m[0].start,k=new Date(x.getTime()+e*6e4);if(!this.hasOverlapWithExistingTasks(x,k,d))return{start:x,end:k,duration:e,type:"work"}}}return null}getConsecutiveSlots(n,e,t){let i=[],o=0;for(let d=e;d<n.length&&o<t;d++){let g=n[d];if(g.type==="work")i.push(g),o+=g.duration;else break}return i}updateTimeSlots(n,e,t){for(let i=n.length-1;i>=0;i--){let o=n[i];o.start<t&&o.end>e&&n.splice(i,1)}}getSchedulingReason(n,e){let t=[];if(n.priority==="high"&&t.push("High priority"),n.dueDate&&Math.ceil((new Date(n.dueDate).getTime()-Date.now())/864e5)<=1&&t.push("Due soon"),this.preferences.energyOptimization){let i=this.parseTimeToDate(this.preferences.peakHours.start),o=this.parseTimeToDate(this.preferences.peakHours.end);e.start>=i&&e.start<o&&t.push("Peak hours")}return t.join(", ")||"Available time slot"}addShortBreaksToPreview(n,e){let t=this.parseTimeToDate(this.preferences.workingHours.start),i=new Date(t);for(let o=0;o<e.length;o++){let d=e[o];if((d.startTime.getTime()-i.getTime())/(1e3*60)>=this.preferences.shortBreaks.frequency&&o>0){let m=new Date(d.startTime.getTime()-this.preferences.shortBreaks.duration*6e4),x=new Date(d.startTime);n.push({type:"break",startTime:m,endTime:x,title:"\u2615 Short Break",reason:`${this.preferences.shortBreaks.duration} min break`}),i=x}}}addBufferTimeToPreview(n,e){for(let t=0;t<e.length-1;t++){let i=e[t],o=e[t+1],d=i.endTime,g=new Date(d.getTime()+this.preferences.bufferTime*6e4);g<=o.startTime&&n.push({type:"buffer",startTime:d,endTime:g,title:"\u23F1\uFE0F Buffer Time",reason:`${this.preferences.bufferTime} min buffer`})}}hasOverlapWithExistingTasks(n,e,t){return t.some(i=>{if(!i.startDateTime||!i.endDateTime)return!1;let o=new Date(i.startDateTime),d=new Date(i.endDateTime);return n<d&&e>o})}regenerateSchedule(){this.generateSchedule()}exportSchedule(){let e=this.schedulePreview().map(t=>`${t.startTime.toLocaleTimeString()} - ${t.endTime.toLocaleTimeString()}: ${t.title}`).join(`
`);navigator.clipboard.writeText(e)}applySchedule(){return R(this,null,function*(){let n=this.scheduledTasks();try{let e=new Map;for(let t of n){let i=t.todo.id.includes("_chunk_")?t.todo.id.split("_chunk_")[0]:t.todo.id;e.has(i)||e.set(i,[]),e.get(i).push(t)}for(let[t,i]of e)if(i.length===1&&!i[0].todo.id.includes("_chunk_")){let o=i[0];console.log(" Applying schedule for task:",o.todo.title),console.log(" Start time:",o.startTime),console.log(" End time:",o.endTime),yield this.todoService.updateTodo(o.todo.id,{startDateTime:o.startTime,endDateTime:o.endTime,isAutoPlanned:!0})}else{let o=i.sort((g,m)=>g.startTime.getTime()-m.startTime.getTime()),d=this.unscheduledTasks().find(g=>g.id===t);console.log(" Applying chunked schedule for task:",d?.title),console.log(" Total chunks:",i.length);for(let g=0;g<o.length;g++){let m=o[g],x=`${d?.title} (${g+1}/${i.length})`;console.log(` Creating chunk ${g+1}: ${x}`),console.log(` Chunk time: ${m.startTime} - ${m.endTime}`),this.todoService.addSubtask(t,{title:x,description:`Chunk ${g+1} of ${i.length} - ${this.formatDuration(m.todo.duration||this.preferences.defaultTaskDuration)}`,priority:d?.priority||"medium",projectId:d?.projectId,startDateTime:m.startTime,endDateTime:m.endTime,duration:m.todo.duration,completed:!1,isAutoPlanned:!0})}yield this.todoService.updateTodo(t,{isAutoPlanned:!0,description:d?.description?`${d.description}

[Auto-planned into ${i.length} chunks]`:`[Auto-planned into ${i.length} chunks]`})}this.closeDialog()}catch(e){console.error("Failed to apply schedule:",e)}})}static \u0275fac=function(e){return new(e||l)};static \u0275cmp=U({type:l,selectors:[["app-auto-plan-dialog"]],decls:1,vars:1,consts:[["taskTemplate",""],["class","auto-plan-overlay",3,"click",4,"ngIf"],[1,"auto-plan-overlay",3,"click"],[1,"auto-plan-dialog",3,"click"],[1,"dialog-header"],[1,"close-btn",3,"click"],[1,"dialog-content"],[1,"step"],["type","date",1,"date-input",3,"ngModelChange","ngModel"],[1,"step-description"],[1,"task-selection"],[1,"task-filters"],[1,"filter-btn",3,"click"],[1,"filter-btn",3,"click","disabled"],["class","project-selection",4,"ngIf"],["class","tag-selection",4,"ngIf"],[1,"task-list"],[4,"ngFor","ngForOf"],[1,"task-actions"],[1,"action-btn","secondary",3,"click"],[1,"preferences-grid"],[1,"pref-group"],[1,"time-range"],["type","time",1,"time-input",3,"ngModelChange","ngModel"],[1,"checkbox-label"],["type","checkbox",3,"ngModelChange","ngModel"],["class","lunch-settings",4,"ngIf"],["class","break-settings",4,"ngIf"],[1,"duration-select",3,"ngModelChange","ngModel"],["value","0"],["value","5"],["value","10"],["value","15"],["value","20"],["value","25"],["value","30"],["value","45"],["value","60"],["value","90"],["value","120"],[1,"help-text"],["class","chunk-settings",4,"ngIf"],["class","peak-hours",4,"ngIf"],[1,"preview-container"],[1,"preview-header"],[1,"preview-stats"],[1,"schedule-preview"],["class","schedule-item",3,"class",4,"ngFor","ngForOf"],[1,"dialog-footer"],[1,"step-navigation"],[1,"nav-btn",3,"click","disabled"],[1,"step-indicator"],["class","step-dot",3,"active","completed",4,"ngFor","ngForOf"],["class","nav-btn",3,"disabled","click",4,"ngIf"],["class","action-btn primary",3,"disabled","click",4,"ngIf"],[1,"project-selection"],["for","project-select"],["id","project-select",1,"project-select",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"tag-selection"],[1,"tag-chips"],["class","tag-chip",3,"selected","background-color","color","click",4,"ngFor","ngForOf"],[1,"tag-actions"],[1,"action-btn","secondary","small",3,"click"],[1,"tag-chip",3,"click"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"task-item",3,"click"],["class","task-indent",3,"width",4,"ngIf"],[1,"task-checkbox"],["type","checkbox",3,"change","click","checked"],[1,"task-info"],[1,"task-title"],["class","task-icon",4,"ngIf"],[1,"task-meta"],[1,"priority"],["class","project",4,"ngIf"],["class","duration",4,"ngIf"],["class","due-date",4,"ngIf"],["class","subtask-count",4,"ngIf"],[1,"task-indent"],[1,"task-icon"],[1,"project"],[1,"duration"],[1,"due-date"],[1,"subtask-count"],[1,"lunch-settings"],[1,"break-settings"],[1,"chunk-settings"],[1,"peak-hours"],[1,"schedule-item"],[1,"time-slot"],[1,"item-content"],[1,"item-title"],["class","item-reason",4,"ngIf"],[1,"item-reason"],[1,"step-dot"],[1,"action-btn","primary",3,"click","disabled"]],template:function(e,t){e&1&&T(0,ft,159,110,"div",1),e&2&&_("ngIf",t.isOpen())},dependencies:[Q,q,X,ve,Ee,Me,Oe,Se,Ce,ye,De,Pe,Te],styles:['.auto-plan-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.auto-plan-dialog[_ngcontent-%COMP%]{background:#fff;border-radius:12px;box-shadow:0 20px 60px #0000004d;width:90vw;max-width:800px;max-height:90vh;display:flex;flex-direction:column;overflow:hidden}.dialog-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:20px 24px;border-bottom:1px solid #e5e7eb;background:#f9fafb}.dialog-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.5rem;font-weight:600;color:#1f2937}.close-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:24px;color:#6b7280;cursor:pointer;padding:4px;border-radius:4px;transition:all .2s ease}.close-btn[_ngcontent-%COMP%]:hover{background:#f3f4f6;color:#374151}.dialog-content[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:24px}.step[_ngcontent-%COMP%]{display:none;animation:_ngcontent-%COMP%_fadeIn .3s ease-in-out}.step.active[_ngcontent-%COMP%]{display:block}.step[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 16px;font-size:1.25rem;font-weight:600;color:#1f2937}.step-description[_ngcontent-%COMP%]{color:#6b7280;margin-bottom:20px;font-size:.875rem}.date-input[_ngcontent-%COMP%]{padding:12px 16px;border:1px solid #d1d5db;border-radius:8px;font-size:1rem;width:200px;transition:border-color .2s ease}.date-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.task-selection[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.task-filters[_ngcontent-%COMP%]{display:flex;gap:8px;flex-wrap:wrap}.filter-btn[_ngcontent-%COMP%]{padding:8px 16px;border:1px solid #d1d5db;background:#fff;border-radius:6px;cursor:pointer;transition:all .2s ease;font-size:.875rem;font-weight:500}.filter-btn[_ngcontent-%COMP%]:hover{background:#f9fafb;border-color:#9ca3af}.filter-btn.active[_ngcontent-%COMP%]{background:#3b82f6;color:#fff;border-color:#3b82f6}.filter-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.filter-btn[_ngcontent-%COMP%]:disabled:hover{background:#fff;border-color:#d1d5db}.project-selection[_ngcontent-%COMP%]{margin-bottom:16px;padding:12px;background:#f9fafb;border-radius:8px;border:1px solid #e5e7eb}.project-selection[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;font-weight:500;color:#1f2937;font-size:.875rem}.project-select[_ngcontent-%COMP%]{width:100%;padding:8px 12px;border:1px solid #d1d5db;border-radius:6px;background:#fff;color:#1f2937;font-size:14px;cursor:pointer;transition:border-color .2s ease}.project-select[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 2px #3b82f61a}.tag-selection[_ngcontent-%COMP%]{margin-bottom:16px;padding:16px;background:#f9fafb;border-radius:8px;border:1px solid #e5e7eb}.tag-selection[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:12px;font-weight:500;color:#1f2937;font-size:.875rem}.tag-chips[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:12px;min-height:40px;padding:8px;background:#fff;border:1px solid #e5e7eb;border-radius:6px}.tag-chip[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:6px 12px;border-radius:16px;font-size:.75rem;font-weight:500;cursor:pointer;transition:all .2s ease;border:2px solid transparent;white-space:nowrap;-webkit-user-select:none;user-select:none}.tag-chip[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 2px 4px #0000001a}.tag-chip.selected[_ngcontent-%COMP%]{border-color:#3b82f6;box-shadow:0 0 0 2px #3b82f633;transform:translateY(-1px)}.tag-actions[_ngcontent-%COMP%]{display:flex;gap:8px;flex-wrap:wrap}.tag-actions[_ngcontent-%COMP%]   .action-btn.small[_ngcontent-%COMP%]{padding:6px 12px;font-size:.75rem;border-radius:4px}.task-list[_ngcontent-%COMP%]{max-height:300px;overflow-y:auto;border:1px solid #e5e7eb;border-radius:8px;background:#f9fafb}.task-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px 16px;border-bottom:1px solid #e5e7eb;cursor:pointer;transition:background-color .2s ease}.task-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.task-item[_ngcontent-%COMP%]:hover{background:#f3f4f6}.task-item.selected[_ngcontent-%COMP%]{background:#eff6ff;border-color:#3b82f6}.task-checkbox[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin:0;cursor:pointer}.task-info[_ngcontent-%COMP%]{flex:1;min-width:0}.task-title[_ngcontent-%COMP%]{font-weight:600;color:#1f2937;margin-bottom:4px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.task-meta[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center;font-size:.75rem;color:#6b7280;flex-wrap:wrap}.priority[_ngcontent-%COMP%]{padding:2px 6px;border-radius:4px;font-weight:600;text-transform:uppercase;font-size:.6875rem}.priority-high[_ngcontent-%COMP%]{background:#fef2f2;color:#991b1b}.priority-medium[_ngcontent-%COMP%]{background:#fffbeb;color:#92400e}.priority-low[_ngcontent-%COMP%]{background:#f0fdf4;color:#065f46}.project[_ngcontent-%COMP%]{background:#f3f4f6;padding:2px 6px;border-radius:4px}.duration[_ngcontent-%COMP%], .due-date[_ngcontent-%COMP%]{background:#eff6ff;color:#1d4ed8;padding:2px 6px;border-radius:4px}.task-actions[_ngcontent-%COMP%]{display:flex;gap:8px;margin-top:12px}.preferences-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:24px}.pref-group[_ngcontent-%COMP%]{background:#f9fafb;padding:16px;border-radius:8px;border:1px solid #e5e7eb}.pref-group[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 12px;font-size:1rem;font-weight:600;color:#1f2937}.time-range[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto 1fr auto 1fr;gap:8px;align-items:center}.time-input[_ngcontent-%COMP%]{padding:8px 12px;border:1px solid #d1d5db;border-radius:6px;font-size:.875rem}.time-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 2px #3b82f61a}.duration-select[_ngcontent-%COMP%]{padding:8px 12px;border:1px solid #d1d5db;border-radius:6px;font-size:.875rem;background:#fff}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:8px;margin-bottom:12px;cursor:pointer;font-size:.875rem}.checkbox-label[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-top:2px}.help-text[_ngcontent-%COMP%]{display:block;color:#6b7280;font-size:.75rem;margin-top:2px}.lunch-settings[_ngcontent-%COMP%], .break-settings[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto 1fr;gap:8px;align-items:center;margin-top:8px;padding-left:20px}.peak-hours[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto 1fr auto 1fr;gap:8px;align-items:center;margin-top:8px;padding-left:20px}.preview-container[_ngcontent-%COMP%]{background:#f9fafb;border:1px solid #e5e7eb;border-radius:8px;overflow:hidden}.preview-header[_ngcontent-%COMP%]{padding:16px;background:#fff;border-bottom:1px solid #e5e7eb}.preview-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 8px;font-size:1.125rem;font-weight:600;color:#1f2937}.preview-stats[_ngcontent-%COMP%]{display:flex;gap:16px;font-size:.875rem;color:#6b7280}.schedule-preview[_ngcontent-%COMP%]{max-height:400px;overflow-y:auto}.schedule-item[_ngcontent-%COMP%]{display:flex;gap:16px;padding:12px 16px;border-bottom:1px solid #e5e7eb;transition:background-color .2s ease}.schedule-item[_ngcontent-%COMP%]:hover{background:#f3f4f6}.schedule-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.item-task[_ngcontent-%COMP%]{border-left:4px solid #3b82f6}.item-lunch[_ngcontent-%COMP%]{border-left:4px solid #f59e0b;background:#fffbeb}.item-break[_ngcontent-%COMP%]{border-left:4px solid #10b981;background:#f0fdf4}.item-buffer[_ngcontent-%COMP%]{border-left:4px solid #8b5cf6;background:#faf5ff}.time-slot[_ngcontent-%COMP%]{font-weight:600;color:#374151;min-width:120px;font-size:.875rem}.item-content[_ngcontent-%COMP%]{flex:1}.item-title[_ngcontent-%COMP%]{font-weight:600;color:#1f2937;margin-bottom:2px}.item-reason[_ngcontent-%COMP%]{font-size:.75rem;color:#6b7280;font-style:italic}.preview-actions[_ngcontent-%COMP%]{padding:16px;background:#fff;border-top:1px solid #e5e7eb;display:flex;gap:8px}.dialog-footer[_ngcontent-%COMP%]{padding:20px 24px;border-top:1px solid #e5e7eb;background:#f9fafb}.step-navigation[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.nav-btn[_ngcontent-%COMP%]{padding:10px 20px;border:1px solid #d1d5db;background:#fff;border-radius:6px;cursor:pointer;font-weight:500;transition:all .2s ease}.nav-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#f9fafb;border-color:#9ca3af}.nav-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.step-indicator[_ngcontent-%COMP%]{display:flex;gap:8px}.step-dot[_ngcontent-%COMP%]{width:10px;height:10px;border-radius:50%;background:#d1d5db;transition:background-color .2s ease}.step-dot.active[_ngcontent-%COMP%]{background:#3b82f6}.step-dot.completed[_ngcontent-%COMP%]{background:#10b981}.action-btn[_ngcontent-%COMP%]{padding:10px 20px;border:none;border-radius:6px;cursor:pointer;font-weight:600;font-size:.875rem;transition:all .2s ease;display:inline-flex;align-items:center;gap:6px}.action-btn.primary[_ngcontent-%COMP%]{background:#3b82f6;color:#fff}.action-btn.primary[_ngcontent-%COMP%]:hover:not(:disabled){background:#2563eb}.action-btn.secondary[_ngcontent-%COMP%]{background:#f3f4f6;color:#374151;border:1px solid #d1d5db}.action-btn.secondary[_ngcontent-%COMP%]:hover{background:#e5e7eb}.action-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}@media (max-width: 768px){.auto-plan-dialog[_ngcontent-%COMP%]{width:95vw;max-height:95vh}.preferences-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.task-meta[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:4px}.step-navigation[_ngcontent-%COMP%]{flex-direction:column;gap:16px}.preview-stats[_ngcontent-%COMP%]{flex-direction:column;gap:4px}}@media (max-width: 480px){.dialog-content[_ngcontent-%COMP%], .dialog-header[_ngcontent-%COMP%], .dialog-footer[_ngcontent-%COMP%]{padding:16px}.time-range[_ngcontent-%COMP%], .lunch-settings[_ngcontent-%COMP%], .break-settings[_ngcontent-%COMP%], .peak-hours[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:8px}.schedule-item[_ngcontent-%COMP%]{flex-direction:column;gap:8px}.time-slot[_ngcontent-%COMP%]{min-width:auto}}.task-item.main-task[_ngcontent-%COMP%]{background:#fff;border-left:4px solid #3b82f6}.task-item.main-task[_ngcontent-%COMP%]:hover{background:#f8fafc}.task-item.main-task.selected[_ngcontent-%COMP%]{background:#eff6ff;border-left-color:#1d4ed8}.task-item.subtask[_ngcontent-%COMP%]{background:#f8fafc;border-left:4px solid #e5e7eb;margin-left:0}.task-item.subtask[_ngcontent-%COMP%]:hover{background:#f1f5f9}.task-item.subtask.selected[_ngcontent-%COMP%]{background:#f0f9ff;border-left-color:#3b82f6}.subtask-indent[_ngcontent-%COMP%]{width:24px;height:100%;display:flex;align-items:center;justify-content:center;color:#9ca3af;font-size:12px}.subtask-indent[_ngcontent-%COMP%]:before{content:"\\2514\\2500";color:#9ca3af}.task-icon[_ngcontent-%COMP%]{margin-right:8px;font-size:14px}.subtask-count[_ngcontent-%COMP%]{background:#e0f2fe;color:#0369a1;padding:2px 6px;border-radius:4px;font-size:.6875rem;font-weight:600}.main-task[_ngcontent-%COMP%]   .task-title[_ngcontent-%COMP%]{font-weight:600;color:#1f2937}.subtask[_ngcontent-%COMP%]   .task-title[_ngcontent-%COMP%]{font-weight:500;color:#4b5563;font-size:.9em}.task-item.main-task[_ngcontent-%COMP%]{margin-bottom:2px}.task-item.subtask[_ngcontent-%COMP%]{margin-bottom:1px}.task-item.subtask[_ngcontent-%COMP%]:last-of-type{margin-bottom:8px}.task-item.filter-match[_ngcontent-%COMP%]{position:relative;background:linear-gradient(135deg,#eff6ff,#dbeafe)!important;border-left:4px solid #3b82f6!important;box-shadow:0 2px 4px #3b82f61a}.task-item.filter-match[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#dbeafe,#bfdbfe)!important;box-shadow:0 4px 8px #3b82f626}.task-item.filter-match.selected[_ngcontent-%COMP%]{background:linear-gradient(135deg,#bfdbfe,#93c5fd)!important;border-left-color:#1d4ed8!important;box-shadow:0 4px 12px #3b82f633}.task-item.filter-match[_ngcontent-%COMP%]   .task-title[_ngcontent-%COMP%]{color:#1e40af!important;font-weight:600!important}.task-item.filter-match[_ngcontent-%COMP%]   .priority[_ngcontent-%COMP%]{box-shadow:0 1px 3px #0000001a;font-weight:700}.task-item.context-item[_ngcontent-%COMP%]{opacity:.6;background:#f8fafc!important;border-left:4px solid #e2e8f0!important}.task-item.context-item[_ngcontent-%COMP%]:hover{opacity:.8;background:#f1f5f9!important}.task-item.context-item.selected[_ngcontent-%COMP%]{opacity:.9;background:#e2e8f0!important;border-left-color:#94a3b8!important}.task-item.context-item[_ngcontent-%COMP%]   .task-title[_ngcontent-%COMP%]{color:#64748b!important;font-weight:400!important}.task-item.context-item[_ngcontent-%COMP%]   .task-meta[_ngcontent-%COMP%]{opacity:.7}.task-item.filter-match.main-task[_ngcontent-%COMP%]:before{position:absolute;left:-2px;top:50%;transform:translateY(-50%);font-size:12px;z-index:1}.task-item.filter-match.subtask[_ngcontent-%COMP%]:before{position:absolute;left:-2px;top:50%;transform:translateY(-50%);font-size:10px;z-index:1}.task-item[_ngcontent-%COMP%]{transition:all .3s ease}.task-item.context-item[_ngcontent-%COMP%]   .task-checkbox[_ngcontent-%COMP%]{opacity:.5}.task-item.filter-match[_ngcontent-%COMP%]   .task-checkbox[_ngcontent-%COMP%]{opacity:1}']})};var _t=["taskEditor"],xt=["autoPlanDialog"];function bt(l,n){if(l&1){let e=O();r(0,"button",43),b("click",function(){let i=h(e).$implicit,o=p();return f(o.setZoomLevel(i))}),c(1),s()}if(l&2){let e=n.$implicit,t=p();D("active",t.zoomLevel()===e),_("title",ue("Zoom to ",e,"%")),a(),u(" ",e,"% ")}}function vt(l,n){if(l&1&&c(0),l&2){let e=p();u(" ",e.formatDate(e.selectedDate())," ")}}function kt(l,n){if(l&1&&c(0),l&2){let e=p();u(" ",e.formatWeekRange(e.weekStart())," ")}}function Tt(l,n){if(l&1&&c(0),l&2){let e=p();u(" ",e.t().today," ")}}function wt(l,n){if(l&1&&c(0),l&2){let e=p();u(" ",e.t().thisWeek," ")}}function Ct(l,n){if(l&1&&(r(0,"div",47),c(1),s()),l&2){let e=n.$implicit;a(),v(e.formatted)}}function St(l,n){if(l&1&&(r(0,"div",44),y(1,"div",45),T(2,Ct,2,1,"div",46),s()),l&2){let e=p();B("grid-template-columns","60px repeat(7, 1fr)"),a(2),_("ngForOf",e.weekDaysFormatted())}}function Dt(l,n){if(l&1&&(F(0),r(1,"div",48),c(2),s(),z()),l&2){let e=n.$implicit,t=p();a(),B("grid-row",e*12+1+" / span 1"),a(),v(t.formatHour(e))}}function Pt(l,n){if(l&1&&(F(0),y(1,"div",49),z()),l&2){let e=n.$implicit;a(),B("grid-row",e+1+" / span 1"),D("hour-line",e%12===0)}}function yt(l,n){if(l&1&&(F(0),y(1,"div",50),z()),l&2){let e=n.$implicit;a(),B("grid-row",e*6+1+" / span 1")}}function Mt(l,n){if(l&1&&y(0,"div",52),l&2){let e=p().index;B("grid-column",e+1+" / "+(e+2))}}function Ot(l,n){if(l&1&&(F(0),T(1,Mt,1,2,"div",51),z()),l&2){let e=n.index;a(),_("ngIf",e>0)}}function Et(l,n){if(l&1&&(F(0),T(1,Ot,2,1,"ng-container",37),z()),l&2){let e=p();a(),_("ngForOf",e.weekDays())}}function It(l,n){if(l&1){let e=O();r(0,"div",54),b("click",function(){let i=h(e).$implicit,o=p(2);return f(o.openEditor(i.todo))})("dragstart",function(i){let o=h(e).$implicit,d=p(2);return f(d.onDragStart(i,o))})("dragend",function(i){h(e);let o=p(2);return f(o.onDragEnd(i))})("mouseenter",function(i){let o=h(e).$implicit,d=p(2);return f(!d.isDragging()&&d.showTooltip(i,o))})("mousemove",function(i){h(e);let o=p(2);return f(!o.isDragging()&&o.moveTooltip(i))})("mouseleave",function(){h(e);let i=p(2);return f(i.hideTooltip())}),r(1,"div",55)(2,"div",56),c(3),s(),r(4,"div",57),c(5),s()()()}if(l&2){let e=n.$implicit,t=p(2);H("priority-"+e.todo.priority+(e.todo.completed?" completed":"")+(e.todo.archived?" archived":"")+(t.isDragging()&&t.draggedBlock()&&t.draggedBlock().todo.id===e.todo.id?" dragging":"")),B("grid-row",t.isDragging()&&t.draggedBlock()&&t.draggedBlock().todo.id===e.todo.id?t.dragPreviewRow()+" / "+(t.dragPreviewRow()+(e.rowEnd-e.rowStart)):e.rowStart+" / "+e.rowEnd)("width",e.width||100,"%")("left",e.left||0,"%")("position",e.width&&e.width<100?"relative":"static")("background",t.getProjectBackgroundColor(e.todo.projectId)),ie("aria-describedby",t.tooltipVisible()&&t.isTooltipFor(e)?"tt-"+e.todo.id:null),a(3),v(e.todo.title),a(2),v(e.displayTime)}}function Vt(l,n){if(l&1&&(F(0),T(1,It,6,15,"div",53),z()),l&2){let e=p();a(),_("ngForOf",e.timetableBlocksDay())}}function Bt(l,n){if(l&1){let e=O();r(0,"div",59),b("click",function(){let i=h(e).$implicit,o=p(2);return f(o.openEditor(i.todo))})("dragstart",function(i){let o=h(e).$implicit,d=p(2);return f(d.onDragStart(i,o))})("dragend",function(i){h(e);let o=p(2);return f(o.onDragEnd(i))})("mouseenter",function(i){let o=h(e).$implicit,d=p(2);return f(!d.isDragging()&&d.showTooltip(i,o))})("mousemove",function(i){h(e);let o=p(2);return f(!o.isDragging()&&o.moveTooltip(i))})("mouseleave",function(){h(e);let i=p(2);return f(i.hideTooltip())}),r(1,"div",55)(2,"div",56),c(3),s(),r(4,"div",57),c(5),s()()()}if(l&2){let e=n.$implicit,t=p(2);H("priority-"+e.todo.priority+(e.todo.completed?" completed":"")+(e.todo.archived?" archived":"")+(t.isDragging()&&t.draggedBlock()&&t.draggedBlock().todo.id===e.todo.id?" dragging":"")),B("grid-row",t.isDragging()&&t.draggedBlock()&&t.draggedBlock().todo.id===e.todo.id?t.dragPreviewRow()+" / "+(t.dragPreviewRow()+(e.rowEnd-e.rowStart)):e.rowStart+" / "+e.rowEnd)("grid-column",t.isDragging()&&t.draggedBlock()&&t.draggedBlock().todo.id===e.todo.id?t.dragPreviewCol()+1+" / "+(t.dragPreviewCol()+2):e.col+1+" / "+(e.col+2))("width",e.width||100,"%")("left",e.left||0,"%")("position",e.width&&e.width<100?"relative":"static")("background",t.getProjectBackgroundColor(e.todo.projectId)),ie("aria-describedby",t.tooltipVisible()&&t.isTooltipFor(e)?"tt-"+e.todo.id:null),a(3),v(e.todo.title),a(2),v(e.displayTime)}}function At(l,n){if(l&1&&(F(0),T(1,Bt,6,17,"div",58),z()),l&2){let e=p();a(),_("ngForOf",e.timetableBlocksWeek())}}function Ft(l,n){if(l&1&&(r(0,"div",60),y(1,"div",61)(2,"div",62),s()),l&2){let e=p();B("grid-row",e.getCurrentTimeGridRow()+" / span 1")("grid-column",e.getCurrentTimeGridColumn())}}function zt(l,n){l&1&&(r(0,"span",72),c(1,"\u2713"),s())}function jt(l,n){if(l&1&&(r(0,"div",68)(1,"span",69),c(2),s(),c(3),s()),l&2){let e=p().ngIf,t=p();a(2),u("",t.t().category,":"),a(),u(" ",e.todo.category)}}function Wt(l,n){if(l&1&&(r(0,"div",73),c(1),s()),l&2){let e=p().ngIf;a(),v(e.todo.description)}}function Lt(l,n){if(l&1&&(r(0,"div",63)(1,"div",64),y(2,"span",65),r(3,"span",66),c(4),s(),T(5,zt,2,0,"span",67),s(),r(6,"div",68)(7,"span",69),c(8),s(),c(9),s(),r(10,"div",68)(11,"span",69),c(12),s(),c(13),$(14,"titlecase"),s(),r(15,"div",68)(16,"span",69),c(17),s(),c(18),s(),T(19,jt,4,2,"div",70)(20,Wt,2,1,"div",71),s()),l&2){let e=n.ngIf,t=p();B("left",t.tooltipX(),"px")("top",t.tooltipY(),"px"),_("id","tt-"+e.todo.id),a(2),H("prio-"+e.todo.priority),a(),D("completed",e.todo.completed),a(),v(e.todo.title),a(),_("ngIf",e.todo.completed),a(3),u("",t.t().when,":"),a(),u(" ",e.displayTime),a(3),u("",t.t().priority,":"),a(),u(" ",_e(14,19,e.todo.priority)),a(4),u("",t.t().status,":"),a(),u(" ",e.todo.completed?t.t().completed:t.t().active),a(),_("ngIf",e.todo.category),a(),_("ngIf",e.todo.description)}}function Ht(l,n){if(l&1&&(r(0,"div",74)(1,"div",75),c(2,"\u{1F5D3}\uFE0F"),s(),r(3,"h3"),c(4),s(),r(5,"p"),c(6),s()()),l&2){let e=p();a(4),v(e.t().noScheduledTasksDay),a(2),v(e.t().scheduledTasksDescription)}}function Nt(l,n){if(l&1&&(r(0,"div",74)(1,"div",75),c(2,"\u{1F5D3}\uFE0F"),s(),r(3,"h3"),c(4),s(),r(5,"p"),c(6),s()()),l&2){let e=p();a(4),v(e.t().noScheduledTasksWeek),a(2),v(e.t().scheduledTasksDescription)}}var Ae=class l{taskEditor;autoPlanDialog;editingTodo=w(null);tooltipVisible=w(!1);tooltipBlock=w(null);tooltipX=w(0);tooltipY=w(0);isDragging=w(!1);draggedBlock=w(null);dragStartY=w(0);dragStartRow=w(0);dragPreviewRow=w(0);dragPreviewCol=w(0);showTooltip(n,e){this.tooltipBlock.set(e),this.tooltipVisible.set(!0),this.positionTooltip(n)}moveTooltip(n){this.tooltipVisible()&&this.positionTooltip(n)}hideTooltip(){this.tooltipVisible.set(!1),this.tooltipBlock.set(null)}positionTooltip(n){let o=n.clientX+12,d=n.clientY+12,g=window.innerWidth,m=window.innerHeight;o+280>g&&(o=Math.max(8,n.clientX-280-12)),d+140>m&&(d=Math.max(8,n.clientY-140-12)),this.tooltipX.set(o),this.tooltipY.set(d)}todoService=L(ee);projectService=L(J);translationService=L(K);currentLocale=C(()=>this.translationService.currentLanguage()==="fr"?"fr-FR":"en-US");t=C(()=>({timetable:this.translationService.translate("nav.timetable"),day:this.translationService.translate("time.day"),week:this.translationService.translate("time.week"),hide:this.translationService.translate("calendar.hide"),show:this.translationService.translate("calendar.show"),archived:this.translationService.translate("common.archived"),zoomOut:this.translationService.translate("timetable.zoomOut"),zoomIn:this.translationService.translate("timetable.zoomIn"),reset:this.translationService.translate("timetable.reset"),resetZoom:this.translationService.translate("timetable.resetZoom"),autoPlan:this.translationService.translate("timetable.autoPlan"),autoPlanTooltip:this.translationService.translate("timetable.autoPlanTooltip"),removeAutoPlan:this.translationService.translate("timetable.removeAutoPlan"),removeAutoPlanTooltip:this.translationService.translate("timetable.removeAutoPlanTooltip"),today:this.translationService.translate("time.today"),thisWeek:this.translationService.translate("calendar.thisWeek"),high:this.translationService.translate("priority.high"),medium:this.translationService.translate("priority.medium"),low:this.translationService.translate("priority.low"),completed:this.translationService.translate("common.completed"),when:this.translationService.translate("timetable.when"),priority:this.translationService.translate("tasks.priority"),status:this.translationService.translate("common.status"),category:this.translationService.translate("tasks.category"),active:this.translationService.translate("common.active"),noScheduledTasksDay:this.translationService.translate("timetable.noScheduledTasksDay"),noScheduledTasksWeek:this.translationService.translate("timetable.noScheduledTasksWeek"),scheduledTasksDescription:this.translationService.translate("timetable.scheduledTasksDescription")}));showArchivedSignal=w(!1);showArchived=this.showArchivedSignal.asReadonly();currentTimeSignal=w(new Date);currentTime=this.currentTimeSignal.asReadonly();timeUpdateInterval;constructor(){this.timeUpdateInterval=window.setInterval(()=>{this.currentTimeSignal.set(new Date)},6e4)}ngOnDestroy(){this.timeUpdateInterval&&clearInterval(this.timeUpdateInterval)}openEditor(n){this.editingTodo.set(n),setTimeout(()=>this.taskEditor?.open())}closeEditor(){this.taskEditor?.closeAndReset?.(),this.editingTodo.set(null)}onSave(n){return R(this,null,function*(){let e=this.editingTodo();if(e)try{yield this.todoService.updateTodo(e.id,n),this.closeEditor()}catch(t){if(t&&t.message==="OVERLAP_CANCELLED")return;console.error("Failed to update task:",t)}})}currentViewSignal=w("day");currentView=this.currentViewSignal.asReadonly();zoomLevelSignal=w(100);zoomLevel=this.zoomLevelSignal.asReadonly();zoomPresets=[25,50,75,100,125,150,200,300];rowHeight=C(()=>4*this.zoomLevel()/100);selectedDateSignal=w(new Date);selectedDate=this.selectedDateSignal.asReadonly();hours=Array.from({length:24},(n,e)=>e);fiveMinutes=Array.from({length:288},(n,e)=>e);halfHours=Array.from({length:48},(n,e)=>e);setView(n){this.currentViewSignal.set(n)}toggleShowArchived(){this.showArchivedSignal.set(!this.showArchived())}setZoomLevel(n){let e=Math.max(25,Math.min(500,n));this.zoomLevelSignal.set(e)}zoomIn(){let n=this.zoomLevel(),e=Math.min(500,n+25);this.setZoomLevel(e)}zoomOut(){let n=this.zoomLevel(),e=Math.max(25,n-25);this.setZoomLevel(e)}resetZoom(){this.setZoomLevel(100)}previous(){return this.currentView()==="day"?this.previousDay():this.previousWeek()}next(){return this.currentView()==="day"?this.nextDay():this.nextWeek()}flattenTodos(n){let e=[];for(let t of n)e.push(t),t.subtasks&&t.subtasks.length>0&&e.push(...this.flattenTodos(t.subtasks));return e}scheduledForDay=C(()=>{let n=this.selectedDate();return this.flattenTodos(this.todoService.todos()).filter(t=>(this.showArchived()||!t.archived)&&t.startDateTime&&t.endDateTime&&this.isTaskOnDate(t,n))});timetableBlocksDay=C(()=>{let n=this.selectedDate(),e=new Date(n);e.setHours(0,0,0,0);let t=new Date(n);t.setHours(23,59,59,999);let i=this.scheduledForDay().map(o=>{let d=new Date(o.startDateTime),g=new Date(o.endDateTime),m=d<e?e:d,x=g>t?t:g,k=this.timeToRow(m),S=Math.max(k+1,this.timeToRowEnd(x));return{todo:o,rowStart:k,rowEnd:S,displayTime:this.getDisplayRange(o)}}).sort((o,d)=>o.rowStart-d.rowStart);return this.calculateOverlaps(i)});getStartOfWeek(n){let e=new Date(n),t=e.getDay(),i=e.getDate()-t;return e.setDate(i),e.setHours(0,0,0,0),e}weekStart=C(()=>this.getStartOfWeek(this.selectedDate()));weekDays=C(()=>{let n=this.weekStart();return Array.from({length:7},(e,t)=>{let i=new Date(n);return i.setDate(n.getDate()+t),i})});weekDaysFormatted=C(()=>{let n=this.currentLocale();return this.weekDays().map(e=>({date:e,formatted:e.toLocaleDateString(n,{weekday:"short",month:"short",day:"numeric"})}))});timetableBlocksWeek=C(()=>{let n=this.flattenTodos(this.todoService.todos()).filter(o=>(this.showArchived()||!o.archived)&&o.startDateTime&&o.endDateTime),e=this.weekStart(),t=this.weekDays(),i=[];return t.forEach((o,d)=>{let g=new Date(o);g.setHours(0,0,0,0);let m=new Date(o);m.setHours(23,59,59,999);let k=n.filter(P=>{let A=new Date(P.startDateTime),N=new Date(P.endDateTime);return A<=m&&N>=g}).map(P=>{let A=new Date(P.startDateTime),N=new Date(P.endDateTime),ne=A<g?g:A,Fe=N>m?m:N,pe=this.timeToRow(ne),ze=Math.max(pe+1,this.timeToRowEnd(Fe));return{todo:P,rowStart:pe,rowEnd:ze,displayTime:this.getDisplayRange(P,!0),col:d+1}}),S=this.calculateOverlapsForDay(k);i.push(...S)}),i.sort((o,d)=>o.col-d.col||o.rowStart-d.rowStart)});previousDay(){let n=this.selectedDate(),e=new Date(n);e.setDate(n.getDate()-1),this.selectedDateSignal.set(e)}nextDay(){let n=this.selectedDate(),e=new Date(n);e.setDate(n.getDate()+1),this.selectedDateSignal.set(e)}previousWeek(){let n=this.selectedDate(),e=new Date(n);e.setDate(n.getDate()-7),this.selectedDateSignal.set(e)}nextWeek(){let n=this.selectedDate(),e=new Date(n);e.setDate(n.getDate()+7),this.selectedDateSignal.set(e)}goToToday(){this.selectedDateSignal.set(new Date)}isToday(n){let e=new Date;return this.isSameDay(n,e)}isSameDay(n,e){return n.getFullYear()===e.getFullYear()&&n.getMonth()===e.getMonth()&&n.getDate()===e.getDate()}isTaskOnDate(n,e){if(!n.startDateTime&&!n.endDateTime)return!1;let t=n.startDateTime?new Date(n.startDateTime):null,i=n.endDateTime?new Date(n.endDateTime):null,o=new Date(e);o.setHours(0,0,0,0);let d=new Date(e);return d.setHours(23,59,59,999),t&&i?t<=d&&i>=o:!1}timeToRow(n){let e=n.getHours()*60+n.getMinutes();return Math.floor(e/5)+1}timeToRowEnd(n){let e=n.getHours()*60+n.getMinutes();return Math.ceil(e/5)+1}formatDate(n){return n.toLocaleDateString(this.currentLocale(),{weekday:"long",year:"numeric",month:"long",day:"numeric"})}formatHour(n){let e=new Date;e.setHours(n,0,0,0);let t=this.currentLocale(),i=t==="en-US";return e.toLocaleTimeString(t,{hour:"numeric",hour12:i})}formatWeekRange(n){let e=new Date(n);e.setDate(n.getDate()+6);let t=this.currentLocale(),i=n.toLocaleDateString(t,{month:"short",day:"numeric"}),o=e.toLocaleDateString(t,{month:"short",day:"numeric",year:"numeric"});return`${i} - ${o}`}isTooltipFor(n){let e=this.tooltipBlock();return!!e&&e.todo.id===n.todo.id}calculateOverlaps(n){if(n.length===0)return n;let e=[];for(let i of n){let o=!1;for(let d of e)if(d.some(g=>this.blocksOverlap(i,g))){d.push(i),o=!0;break}o||e.push([i])}let t=[];for(let i of e)if(i.length===1)t.push(W(j({},i[0]),{width:100,left:0}));else{let o=i.sort((g,m)=>g.rowStart-m.rowStart||g.rowEnd-m.rowEnd),d=100/o.length;o.forEach((g,m)=>{t.push(W(j({},g),{width:d,left:d*m}))})}return t.sort((i,o)=>i.rowStart-o.rowStart)}blocksOverlap(n,e){let t=new Date(n.todo.startDateTime),i=new Date(n.todo.endDateTime),o=new Date(e.todo.startDateTime),d=new Date(e.todo.endDateTime);return t<d&&i>o}calculateOverlapsForDay(n){if(n.length===0)return n;let e=[];for(let i of n){let o=!1;for(let d of e)if(d.some(g=>this.blocksOverlap(i,g))){d.push(i),o=!0;break}o||e.push([i])}let t=[];for(let i of e)if(i.length===1)t.push(W(j({},i[0]),{width:100,left:0}));else{let o=i.sort((g,m)=>g.rowStart-m.rowStart||g.rowEnd-m.rowEnd),d=100/o.length;o.forEach((g,m)=>{t.push(W(j({},g),{width:d,left:d*m}))})}return t}getDisplayRange(n,e=!1){let t=new Date(n.startDateTime),i=new Date(n.endDateTime),o=this.currentLocale(),g={hour:"numeric",minute:"2-digit",hour12:o==="en-US"};if(!e)return`${t.toLocaleTimeString(o,g)} - ${i.toLocaleTimeString(o,g)}`;let m={weekday:"short"},x=t.toLocaleDateString(o,m),k=i.toLocaleDateString(o,m);return this.isSameDay(t,i)?`${x} ${t.toLocaleTimeString(o,g)} - ${i.toLocaleTimeString(o,g)}`:`${x} ${t.toLocaleTimeString(o,g)} - ${k} ${i.toLocaleTimeString(o,g)}`}getProjectColor(n){return this.projectService.projects().find(t=>t.id===n)?.color||"#6b7280"}getProjectName(n){return this.projectService.projects().find(t=>t.id===n)?.name||"No Project"}getProjectBackgroundColor(n){let t=this.getProjectColor(n).replace("#",""),i=parseInt(t.substr(0,2),16),o=parseInt(t.substr(2,2),16),d=parseInt(t.substr(4,2),16),g=Math.round(i*.15+255*.85),m=Math.round(o*.15+255*.85),x=Math.round(d*.15+255*.85);return`rgb(${g}, ${m}, ${x})`}shouldShowCurrentTimeIndicator(){let n=this.currentTime();if(this.currentView()==="day")return this.isSameDay(n,this.selectedDate());if(this.currentView()==="week"){let e=this.weekStart(),t=new Date(e);return t.setDate(e.getDate()+6),n>=e&&n<=t}return!1}getCurrentTimeGridRow(){let n=this.currentTime(),e=n.getHours(),t=n.getMinutes(),i=e*60+t;return Math.floor(i/5)+1}getCurrentTimeGridColumn(){if(this.currentView()==="day")return"2 / 3";if(this.currentView()==="week"){let n=this.currentTime(),t=this.weekDays().findIndex(i=>this.isSameDay(i,n));if(t>=0){let i=t+2,o=i+1;return`${i} / ${o}`}}return"1 / -1"}openAutoPlan(){this.autoPlanDialog.open()}removeAutoPlannedTasks(){return R(this,null,function*(){if(this.getAutoPlannedTasksCount()!==0)try{yield this.todoService.removeAutoPlannedTasks()}catch(e){console.error("Failed to remove auto-planned tasks:",e)}})}getAutoPlannedTasksCount(){return this.todoService.getAutoPlannedTasksCount()}onDragStart(n,e){this.isDragging.set(!0),this.draggedBlock.set(e),this.dragStartRow.set(e.rowStart),this.dragPreviewRow.set(e.rowStart),this.dragPreviewCol.set(e.col||1);let t=n.target.closest(".timetable-grid");if(t){let i=t.getBoundingClientRect();this.dragStartY.set(n.clientY-i.top)}if(this.hideTooltip(),n.dataTransfer?.setData("text/plain",e.todo.id),n.dataTransfer){n.dataTransfer.effectAllowed="move";let i=document.createElement("div");i.style.opacity="0",i.style.position="absolute",i.style.top="-1000px",document.body.appendChild(i),n.dataTransfer.setDragImage(i,0,0),setTimeout(()=>{document.body.removeChild(i)},0)}}onDragOver(n){if(!this.isDragging()||!this.draggedBlock())return;n.preventDefault(),n.dataTransfer.dropEffect="move";let t=n.currentTarget.getBoundingClientRect(),i=n.clientY-t.top,o=n.clientX-t.left,d=this.rowHeight(),g=Math.max(1,Math.floor(i/d)+1);if(this.dragPreviewRow.set(g),this.currentView()==="week"&&o>60){let x=(t.width-60)/7,k=Math.floor((o-60)/x),S=Math.max(1,Math.min(7,k+1));this.dragPreviewCol.set(S)}}onDragEnter(n){this.isDragging()&&n.preventDefault()}onDragLeave(n){let t=n.currentTarget.getBoundingClientRect(),i=n.clientX,o=n.clientY;if(i<t.left||i>t.right||o<t.top||o>t.bottom){let d=this.draggedBlock();d&&this.dragPreviewRow.set(d.rowStart)}}onDrop(n){return R(this,null,function*(){if(!this.isDragging()||!this.draggedBlock())return;n.preventDefault();let e=this.draggedBlock(),t=this.dragPreviewRow(),i=this.dragStartRow(),o=this.dragPreviewCol(),d=e.col||1,m=(t-i)*5,x=0;if(this.currentView()==="week"&&(x=o-1-(d-1)),m!==0||x!==0){let k=new Date(e.todo.startDateTime),S=new Date(e.todo.endDateTime),P=m+x*24*60,A=new Date(k.getTime()+P*6e4),N=new Date(S.getTime()+P*6e4);try{yield this.todoService.updateTodo(e.todo.id,{startDateTime:A,endDateTime:N})}catch(ne){console.error("Failed to update task schedule:",ne),this.dragPreviewRow.set(i),this.dragPreviewCol.set(d)}}this.onDragEnd(n)})}onDragEnd(n){this.isDragging.set(!1),this.draggedBlock.set(null),this.dragStartY.set(0),this.dragStartRow.set(0),this.dragPreviewRow.set(0),this.dragPreviewCol.set(0)}static \u0275fac=function(e){return new(e||l)};static \u0275cmp=U({type:l,selectors:[["app-timetable"]],viewQuery:function(e,t){if(e&1&&(se(_t,5),se(xt,5)),e&2){let i;le(i=ce())&&(t.taskEditor=i.first),le(i=ce())&&(t.autoPlanDialog=i.first)}},decls:76,vars:49,consts:[["taskEditor",""],["autoPlanDialog",""],[1,"timetable-container"],[1,"timetable-header"],[1,"header-controls"],[1,"view-controls"],[1,"view-btn",3,"click"],[1,"archive-controls"],[1,"archive-toggle-btn",3,"click","title"],[1,"zoom-controls"],[1,"zoom-presets"],["class","zoom-preset-btn",3,"active","title","click",4,"ngFor","ngForOf"],[1,"zoom-fine-controls"],[1,"zoom-btn",3,"click","disabled","title"],["width","16","height","16","viewBox","0 0 16 16","fill","currentColor"],["d","M4 8a.5.5 0 01.5-.5h7a.5.5 0 010 1h-7A.5.5 0 014 8z"],[1,"zoom-level"],["d","M8 4a.5.5 0 01.5.5v3h3a.5.5 0 010 1h-3v3a.5.5 0 01-1 0v-3h-3a.5.5 0 010-1h3v-3A.5.5 0 018 4z"],[1,"zoom-reset-btn",3,"click","title"],[1,"plan-controls"],[1,"auto-plan-btn",3,"click","title"],[1,"remove-auto-plan-btn",3,"click","disabled","title"],[1,"date-header"],[1,"current-date"],[1,"date-navigation"],[1,"nav-btn",3,"click"],["d","M9.707 4.293a1 1 0 010 1.414L7.414 8l2.293 2.293a1 1 0 01-1.414 1.414l-3-3a1 1 0 010-1.414l3-3a1 1 0 011.414 0z"],[1,"nav-btn",3,"click","disabled"],["d","M6.293 4.293a1 1 0 011.414 0l3 3a1 1 0 010 1.414l-3 3a1 1 0 01-1.414-1.414L8.586 8 6.293 5.707a1 1 0 010-1.414z"],[1,"legend"],[1,"legend-item"],[1,"legend-color","priority-high"],[1,"legend-color","priority-medium"],[1,"legend-color","priority-low"],[1,"legend-color","completed"],["class","day-headers",3,"gridTemplateColumns",4,"ngIf"],[1,"timetable-grid",3,"dragover","drop","dragenter","dragleave","ngClass"],[4,"ngFor","ngForOf"],[4,"ngIf"],["class","current-time-indicator",3,"gridRow","gridColumn",4,"ngIf"],["class","task-tooltip floating","role","tooltip",3,"id","left","top",4,"ngIf"],["class","empty-state",4,"ngIf"],[3,"save","close","todo","isSubtask"],[1,"zoom-preset-btn",3,"click","title"],[1,"day-headers"],[1,"time-spacer"],["class","day-header",4,"ngFor","ngForOf"],[1,"day-header"],[1,"time-label"],[1,"grid-line",2,"grid-column","1 / -1","opacity","0.3"],[1,"grid-line","hour-line",2,"grid-column","1 / -1"],["class","day-separator","style","grid-row: 1 / -1",3,"gridColumn",4,"ngIf"],[1,"day-separator",2,"grid-row","1 / -1"],["class","task-block","draggable","true","style","grid-column: 2 / 3",3,"gridRow","width","left","position","class","background","click","dragstart","dragend","mouseenter","mousemove","mouseleave",4,"ngFor","ngForOf"],["draggable","true",1,"task-block",2,"grid-column","2 / 3",3,"click","dragstart","dragend","mouseenter","mousemove","mouseleave"],[1,"task-content-in"],[1,"task-title"],[1,"task-time"],["class","task-block","draggable","true",3,"gridRow","gridColumn","width","left","position","class","background","click","dragstart","dragend","mouseenter","mousemove","mouseleave",4,"ngFor","ngForOf"],["draggable","true",1,"task-block",3,"click","dragstart","dragend","mouseenter","mousemove","mouseleave"],[1,"current-time-indicator"],[1,"time-indicator-dot"],[1,"time-indicator-line"],["role","tooltip",1,"task-tooltip","floating",3,"id"],[1,"tt-header"],[1,"tt-priority-dot"],[1,"tt-title"],["class","tt-completed-badge",4,"ngIf"],[1,"tt-row"],[1,"tt-label"],["class","tt-row",4,"ngIf"],["class","tt-desc",4,"ngIf"],[1,"tt-completed-badge"],[1,"tt-desc"],[1,"empty-state"],[1,"empty-icon"]],template:function(e,t){if(e&1){let i=O();r(0,"div",2)(1,"header",3)(2,"h1"),c(3),s(),r(4,"div",4)(5,"div",5)(6,"button",6),b("click",function(){return h(i),f(t.setView("day"))}),c(7),s(),r(8,"button",6),b("click",function(){return h(i),f(t.setView("week"))}),c(9),s()(),r(10,"div",7)(11,"button",8),b("click",function(){return h(i),f(t.toggleShowArchived())}),c(12),s()(),r(13,"div",9)(14,"div",10),T(15,bt,2,5,"button",11),s(),r(16,"div",12)(17,"button",13),b("click",function(){return h(i),f(t.zoomOut())}),Y(),r(18,"svg",14),y(19,"path",15),s()(),G(),r(20,"span",16),c(21),s(),r(22,"button",13),b("click",function(){return h(i),f(t.zoomIn())}),Y(),r(23,"svg",14),y(24,"path",17),s()(),G(),r(25,"button",18),b("click",function(){return h(i),f(t.resetZoom())}),c(26),s()()(),r(27,"div",19)(28,"button",20),b("click",function(){return h(i),f(t.openAutoPlan())}),c(29),s(),r(30,"button",21),b("click",function(){return h(i),f(t.removeAutoPlannedTasks())}),c(31),s()()()(),r(32,"div",22)(33,"h2",23),oe(34,vt,1,1)(35,kt,1,1),s(),r(36,"div",24)(37,"button",25),b("click",function(){return h(i),f(t.previous())}),Y(),r(38,"svg",14),y(39,"path",26),s()(),G(),r(40,"button",27),b("click",function(){return h(i),f(t.goToToday())}),oe(41,Tt,1,1)(42,wt,1,1),s(),r(43,"button",25),b("click",function(){return h(i),f(t.next())}),Y(),r(44,"svg",14),y(45,"path",28),s()()()(),G(),r(46,"div",29)(47,"span",30),y(48,"span",31),c(49),s(),r(50,"span",30),y(51,"span",32),c(52),s(),r(53,"span",30),y(54,"span",33),c(55),s(),r(56,"span",30)(57,"span",34),c(58,"\u2713"),s(),c(59),s()(),T(60,St,3,3,"div",35),r(61,"div",36),b("dragover",function(d){return h(i),f(t.onDragOver(d))})("drop",function(d){return h(i),f(t.onDrop(d))})("dragenter",function(d){return h(i),f(t.onDragEnter(d))})("dragleave",function(d){return h(i),f(t.onDragLeave(d))}),T(62,Dt,3,3,"ng-container",37)(63,Pt,2,4,"ng-container",37)(64,yt,2,2,"ng-container",37)(65,Et,2,1,"ng-container",38)(66,Vt,2,1,"ng-container",38)(67,At,2,1,"ng-container",38)(68,Ft,3,4,"div",39),s(),T(69,Lt,21,21,"div",40)(70,Ht,7,2,"div",41)(71,Nt,7,2,"div",41),s(),r(72,"app-task-editor",42,0),b("save",function(d){return h(i),f(t.onSave(d))})("close",function(){return h(i),f(t.closeEditor())}),s(),y(74,"app-auto-plan-dialog",null,1)}if(e&2){let i;a(3),v(t.t().timetable),a(3),D("active",t.currentView()==="day"),a(),v(t.t().day),a(),D("active",t.currentView()==="week"),a(),v(t.t().week),a(2),D("active",t.showArchived()),_("title",t.showArchived()?t.t().hide+" "+t.t().archived:t.t().show+" "+t.t().archived),a(),M(" ",t.showArchived()?t.t().hide:t.t().show," ",t.t().archived," "),a(3),_("ngForOf",t.zoomPresets),a(2),_("disabled",t.zoomLevel()<=25)("title",t.t().zoomOut),a(4),u("",t.zoomLevel(),"%"),a(),_("disabled",t.zoomLevel()>=500)("title",t.t().zoomIn),a(3),_("title",t.t().resetZoom),a(),u(" ",t.t().reset," "),a(2),_("title",t.t().autoPlanTooltip),a(),u(" ",t.t().autoPlan," "),a(),_("disabled",t.getAutoPlannedTasksCount()===0)("title",t.t().removeAutoPlanTooltip),a(),M(" \u{1F5D1}\uFE0F ",t.t().removeAutoPlan," (",t.getAutoPlannedTasksCount(),") "),a(3),ae(t.currentView()==="day"?34:35),a(6),_("disabled",t.isToday(t.selectedDate())),a(),ae(t.currentView()==="day"?41:42),a(8),u(" ",t.t().high),a(3),u(" ",t.t().medium),a(3),u(" ",t.t().low),a(4),u(" ",t.t().completed),a(),_("ngIf",t.currentView()==="week"),a(),B("grid-template-rows","repeat(288, "+t.rowHeight()+"px)"),_("ngClass",(t.currentView()==="week"?"grid-week":"grid-day")+(t.isDragging()?" drag-over":"")),a(),_("ngForOf",t.hours),a(),_("ngForOf",t.fiveMinutes),a(),_("ngForOf",t.halfHours),a(),_("ngIf",t.currentView()==="week"),a(),_("ngIf",t.currentView()==="day"),a(),_("ngIf",t.currentView()==="week"),a(),_("ngIf",t.shouldShowCurrentTimeIndicator()),a(),_("ngIf",t.tooltipVisible()&&t.tooltipBlock()),a(),_("ngIf",t.currentView()==="day"&&t.timetableBlocksDay().length===0),a(),_("ngIf",t.currentView()==="week"&&t.timetableBlocksWeek().length===0),a(),_("todo",t.editingTodo())("isSubtask",!!((i=t.editingTodo())!=null&&i.parentId))}},dependencies:[Q,be,q,X,we,Be,te,ke],styles:['.timetable-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.timetable-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:30px;padding-bottom:20px;border-bottom:1px solid #e2e8f0}.timetable-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:2rem;font-weight:700;color:#1f2937}.header-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:24px}.date-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}.date-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.5rem;font-weight:600;color:#1f2937}.view-controls[_ngcontent-%COMP%]{display:flex;gap:8px;background:#f8fafc;padding:4px;border-radius:8px;border:1px solid #e2e8f0}.view-btn[_ngcontent-%COMP%]{padding:8px 16px;border:none;background:transparent;color:#6b7280;font-weight:500;border-radius:6px;cursor:pointer;transition:all .2s ease}.view-btn[_ngcontent-%COMP%]:hover{background:#e2e8f0;color:#374151}.view-btn.active[_ngcontent-%COMP%]{background:#3b82f6;color:#fff;box-shadow:0 1px 3px #3b82f64d}.zoom-controls[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;align-items:center}.zoom-presets[_ngcontent-%COMP%]{display:flex;gap:4px;background:#f8fafc;padding:4px;border-radius:8px;border:1px solid #e2e8f0}.zoom-preset-btn[_ngcontent-%COMP%]{padding:4px 8px;border:none;background:transparent;color:#6b7280;font-weight:500;font-size:.75rem;border-radius:4px;cursor:pointer;transition:all .2s ease;min-width:40px}.zoom-preset-btn[_ngcontent-%COMP%]:hover{background:#e2e8f0;color:#374151}.zoom-preset-btn.active[_ngcontent-%COMP%]{background:#3b82f6;color:#fff;box-shadow:0 1px 2px #3b82f64d}.zoom-fine-controls[_ngcontent-%COMP%]{display:flex;gap:6px;align-items:center;background:#f8fafc;padding:4px 8px;border-radius:8px;border:1px solid #e2e8f0}.zoom-btn[_ngcontent-%COMP%]{padding:4px;border:none;background:transparent;color:#6b7280;border-radius:4px;cursor:pointer;transition:all .2s ease;display:flex;align-items:center;justify-content:center;width:24px;height:24px}.zoom-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#e2e8f0;color:#374151}.zoom-btn[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed}.zoom-level[_ngcontent-%COMP%]{font-size:.75rem;font-weight:600;color:#374151;min-width:40px;text-align:center}.zoom-reset-btn[_ngcontent-%COMP%]{padding:4px 8px;border:none;background:transparent;color:#6b7280;font-weight:500;font-size:.75rem;border-radius:4px;cursor:pointer;transition:all .2s ease}.zoom-reset-btn[_ngcontent-%COMP%]:hover{background:#e2e8f0;color:#374151}.date-navigation[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center}.nav-btn[_ngcontent-%COMP%]{padding:8px 12px;border:1px solid #d1d5db;background:#fff;color:#374151;border-radius:6px;cursor:pointer;transition:all .2s ease;display:flex;align-items:center;gap:4px;font-size:.875rem}.nav-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#f9fafb;border-color:#9ca3af}.nav-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.legend[_ngcontent-%COMP%]{display:flex;gap:16px;align-items:center}.legend-item[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:6px;color:#4b5563}.legend-color[_ngcontent-%COMP%]{width:10px;height:10px;border-radius:50%;display:inline-block}.legend-color.priority-high[_ngcontent-%COMP%]{background:#ef4444}.legend-color.priority-medium[_ngcontent-%COMP%]{background:#f59e0b}.legend-color.priority-low[_ngcontent-%COMP%]{background:#10b981}.legend-color.completed[_ngcontent-%COMP%]{background:#f3f4f6;border:1px solid #d1d5db;color:#10b981;font-size:8px;font-weight:700;display:flex;align-items:center;justify-content:center}.day-headers[_ngcontent-%COMP%]{display:grid;grid-template-columns:60px repeat(7,1fr);gap:8px;align-items:center;margin-bottom:8px}.day-header[_ngcontent-%COMP%]{font-weight:600;color:#374151;text-align:center}.time-spacer[_ngcontent-%COMP%]{height:1px}.timetable-grid[_ngcontent-%COMP%]{position:relative;display:grid;grid-template-columns:60px 1fr;grid-auto-columns:1fr;padding-left:0;border:1px solid #e5e7eb;border-radius:8px;background:#fff}.timetable-grid.grid-day[_ngcontent-%COMP%]{grid-template-columns:60px 1fr}.timetable-grid.grid-week[_ngcontent-%COMP%]{grid-template-columns:60px repeat(7,1fr)}.time-label[_ngcontent-%COMP%]{grid-column:1 / 2;position:relative;justify-self:end;padding-right:8px;color:#6b7280;font-size:12px;align-self:center}.grid-line[_ngcontent-%COMP%]{grid-column:1 / -1;border-top:1px dashed #e5e7eb}.grid-line.hour-line[_ngcontent-%COMP%]{border-top:1px solid #d1d5db}.day-separator[_ngcontent-%COMP%]{border-right:1px solid #e5e7eb;pointer-events:none;z-index:0;justify-self:end}.task-block[_ngcontent-%COMP%]{grid-column:2 / 3;display:block;margin:0;padding:0 8px;border-radius:6px;color:#111827;text-decoration:none;border:1px solid transparent;box-shadow:0 1px 2px #0000000d;position:relative;overflow:hidden;z-index:1}.task-block[_ngcontent-%COMP%]   .task-content-in[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-width:0}.task-block[_ngcontent-%COMP%]   .task-title[_ngcontent-%COMP%]{font-weight:600;font-size:12px;line-height:1.1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.task-block[_ngcontent-%COMP%]   .task-time[_ngcontent-%COMP%]{font-size:11px;line-height:1.1;color:#4b5563;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.task-block.priority-high[_ngcontent-%COMP%]{background:#fee2e2;border-color:#fecaca;border-left:4px solid #ef4444}.task-block.priority-medium[_ngcontent-%COMP%]{background:#fffbeb;border-color:#fde68a;border-left:4px solid #f59e0b}.task-block.priority-low[_ngcontent-%COMP%]{background:#ecfdf5;border-color:#a7f3d0;border-left:4px solid #10b981}.task-block.completed[_ngcontent-%COMP%]{opacity:.6;position:relative}.task-block.completed[_ngcontent-%COMP%]:after{content:"\\2713";position:absolute;top:2px;right:4px;font-size:12px;font-weight:700;color:#10b981;background:#ffffffe6;border-radius:50%;width:16px;height:16px;display:flex;align-items:center;justify-content:center;line-height:1}.task-block.completed[_ngcontent-%COMP%]   .task-title[_ngcontent-%COMP%]{text-decoration:line-through;color:#6b7280}.task-block.completed[_ngcontent-%COMP%]   .task-time[_ngcontent-%COMP%]{text-decoration:line-through;color:#9ca3af}.task-block.completed.priority-high[_ngcontent-%COMP%]{background:#f9f5f5;border-color:#f3e8e8}.task-block.completed.priority-medium[_ngcontent-%COMP%]{background:#fefcf7;border-color:#faf6e8}.task-block.completed.priority-low[_ngcontent-%COMP%]{background:#f7fcf9;border-color:#e8f5ed}.task-block.dragging[_ngcontent-%COMP%]{opacity:.5;transform:rotate(2deg);box-shadow:0 8px 25px #00000026;z-index:1000;transition:none}.task-block[_ngcontent-%COMP%]{cursor:grab;transition:transform .2s ease,box-shadow .2s ease}.task-block[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 12px #0000001a}.task-block[_ngcontent-%COMP%]:active{cursor:grabbing}.timetable-grid[_ngcontent-%COMP%]{transition:background-color .2s ease}.timetable-grid.drag-over[_ngcontent-%COMP%]{background-color:#3b82f60d}.task-tooltip[_ngcontent-%COMP%]{position:absolute;left:100%;top:0;transform:translate(8px);min-width:220px;max-width:320px;background:#111827;color:#f9fafb;border-radius:6px;padding:8px 10px;font-size:12px;line-height:1.3;box-shadow:0 8px 20px #0003;opacity:0;pointer-events:none;transition:opacity .12s ease,transform .12s ease;z-index:20}.task-block[_ngcontent-%COMP%]:hover   .task-tooltip[_ngcontent-%COMP%], .task-block[_ngcontent-%COMP%]:focus-visible   .task-tooltip[_ngcontent-%COMP%], .task-block[_ngcontent-%COMP%]:focus   .task-tooltip[_ngcontent-%COMP%]{opacity:1}.task-tooltip.floating[_ngcontent-%COMP%]{position:fixed;left:0;top:0;transform:none;opacity:1}.tt-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;margin-bottom:6px}.tt-priority-dot[_ngcontent-%COMP%]{width:8px;height:8px;border-radius:50%;display:inline-block}.tt-priority-dot.prio-high[_ngcontent-%COMP%]{background:#ef4444}.tt-priority-dot.prio-medium[_ngcontent-%COMP%]{background:#f59e0b}.tt-priority-dot.prio-low[_ngcontent-%COMP%]{background:#10b981}.tt-title[_ngcontent-%COMP%]{font-weight:700;color:#fff}.tt-title.completed[_ngcontent-%COMP%]{text-decoration:line-through;color:#d1d5db}.tt-completed-badge[_ngcontent-%COMP%]{color:#10b981;font-weight:700;margin-left:6px;background:#10b98133;border-radius:50%;width:16px;height:16px;display:flex;align-items:center;justify-content:center;font-size:10px}.tt-row[_ngcontent-%COMP%]{margin:2px 0;color:#e5e7eb}.tt-label[_ngcontent-%COMP%]{color:#9ca3af;margin-right:6px}.tt-desc[_ngcontent-%COMP%]{margin-top:6px;color:#e5e7eb;white-space:normal}.empty-state[_ngcontent-%COMP%]{margin-top:16px;padding:24px;border-radius:8px;background:#f9fafb;text-align:center;color:#4b5563}.empty-state[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]{font-size:32px;margin-bottom:8px}.current-time-indicator[_ngcontent-%COMP%]{position:relative;z-index:10;pointer-events:none;display:flex;align-items:center}.time-indicator-dot[_ngcontent-%COMP%]{width:8px;height:8px;background:#ef4444;border-radius:50%;position:absolute;left:4px;z-index:11;box-shadow:0 0 4px #ef444480}.time-indicator-line[_ngcontent-%COMP%]{width:100%;height:2px;background:#ef4444;position:absolute;left:0;box-shadow:0 0 2px #ef44444d}.header-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px}.plan-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.auto-plan-btn[_ngcontent-%COMP%]{padding:8px 16px;background:linear-gradient(135deg,#3b82f6,#1d4ed8);color:#fff;border:none;border-radius:6px;font-weight:600;font-size:.875rem;cursor:pointer;transition:all .2s ease;display:flex;align-items:center;gap:6px;box-shadow:0 2px 4px #3b82f633}.auto-plan-btn[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#2563eb,#1e40af);transform:translateY(-1px);box-shadow:0 4px 8px #3b82f64d}.remove-auto-plan-btn[_ngcontent-%COMP%]{padding:8px 16px;background:linear-gradient(135deg,#ef4444,#dc2626);color:#fff;border:none;border-radius:6px;font-weight:600;font-size:.875rem;cursor:pointer;transition:all .2s ease;display:flex;align-items:center;gap:6px;box-shadow:0 2px 4px #ef444433}.remove-auto-plan-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:linear-gradient(135deg,#dc2626,#b91c1c);transform:translateY(-1px);box-shadow:0 4px 8px #ef44444d}.remove-auto-plan-btn[_ngcontent-%COMP%]:disabled{background:#9ca3af;cursor:not-allowed;transform:none;box-shadow:none}.task-block.archived[_ngcontent-%COMP%]{opacity:.6;filter:grayscale(30%)}.task-block.archived[_ngcontent-%COMP%]   .task-title[_ngcontent-%COMP%]{text-decoration:line-through;color:#6b7280}.archive-toggle-btn[_ngcontent-%COMP%]{padding:8px 16px;border:1px solid #d1d5db;border-radius:6px;background:#fff;color:#374151;font-size:14px;cursor:pointer;transition:all .2s ease;margin-left:12px}.archive-toggle-btn[_ngcontent-%COMP%]:hover{background:#f9fafb;border-color:#9ca3af}.archive-toggle-btn.active[_ngcontent-%COMP%]{background:#3b82f6;color:#fff;border-color:#3b82f6}.archive-controls[_ngcontent-%COMP%]{display:flex;align-items:center}']})};export{Ae as TimetableComponent};
