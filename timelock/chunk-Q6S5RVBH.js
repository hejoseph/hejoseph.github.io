import{a as oe}from"./chunk-32SYM46U.js";import{a as ie,b as re,c as se,h as de}from"./chunk-AB7ESRYX.js";import{a as ae}from"./chunk-JFR446LH.js";import{C as ne,h as W,j as Y,k as H,n as G,r as q,s as J,t as K,x as X,y as te}from"./chunk-VOG7M7LN.js";import{$a as I,Ab as v,Bb as f,Ca as s,Cb as R,Fb as M,Gb as j,Hb as D,Na as N,Ra as x,Tb as A,_ as y,a as w,b as P,c as m,cb as g,da as a,db as c,ea as d,eb as l,fa as F,fb as S,ga as E,lc as Q,mb as C,mc as $,na as b,nb as T,ob as r,qc as U,sb as z,tb as B,ub as L,wb as V,xb as h,xc as Z,yc as ee,zb as _}from"./chunk-L2PMUJ2L.js";var le=["taskEditor"];function pe(u,i){if(u&1&&(c(0,"span",32)(1,"strong"),_(2),l(),_(3),l()),u&2){let e=r(2);s(2),v(e.formatTime(e.timeEstimate())),s(),f(" ",e.translations().estimated," ")}}function ue(u,i){if(u&1&&(c(0,"div",30)(1,"div",31)(2,"span",32)(3,"strong"),_(4),l(),_(5),l(),c(6,"span",32)(7,"strong"),_(8),l(),_(9),l(),x(10,pe,4,2,"span",33),l(),c(11,"div",34),S(12,"div",35),l(),c(13,"span",36),_(14),l()()),u&2){let e=r();s(4),v(e.focusService.focusProgress().completed),s(),f(" ",e.translations().completed," "),s(3),v(e.focusService.focusProgress().remaining),s(),f(" ",e.translations().remaining," "),s(),g("ngIf",e.timeEstimate()>0),s(2),V("width",e.focusService.focusProgress().percentage,"%"),s(2),R("",e.focusService.focusProgress().percentage,"% ",e.translations().complete)}}function _e(u,i){if(u&1){let e=C();c(0,"button",37),T("click",function(){a(e);let n=r();return d(n.clearAllFocus())}),_(1),l()}if(u&2){let e=r();g("title",e.translations().clearAllFocusTasks),s(),f(" ",e.translations().clearAll," ")}}function ge(u,i){if(u&1&&(c(0,"div",38)(1,"div",39),_(2,"\u{1F3AF}"),l(),c(3,"h3"),_(4),l(),c(5,"p"),_(6),l()()),u&2){let e=r();s(4),v(e.translations().noFocusTasksYet),s(2),v(e.translations().selectTasksFromAvailable)}}function me(u,i){if(u&1){let e=C();c(0,"div",42),T("dragstart",function(n){let o=a(e).index,p=r(2);return d(p.onFocusTaskDragStart(o,n))})("dragenter",function(n){let o=a(e).index,p=r(2);return d(p.onFocusTaskDragEnter(o,n))})("dragover",function(n){let o=a(e).index,p=r(2);return d(p.onFocusTaskDragOver(o,n))})("dragleave",function(n){let o=a(e).index,p=r(2);return d(p.onFocusTaskDragLeave(o,n))})("drop",function(n){let o=a(e).index,p=r(2);return d(p.onFocusTaskDrop(o,n))})("dragend",function(){a(e);let n=r(2);return d(n.onFocusTaskDragEnd())}),c(1,"div",43),_(2),l(),c(3,"div",44)(4,"app-todo-item",45),T("toggle",function(n){a(e);let o=r(2);return d(o.onToggleTodo(n))})("delete",function(n){a(e);let o=r(2);return d(o.onDeleteTodo(n))})("archive",function(n){a(e);let o=r(2);return d(o.onArchiveTodo(n))})("unarchive",function(n){a(e);let o=r(2);return d(o.onUnarchiveTodo(n))})("update",function(n){a(e);let o=r(2);return d(o.onUpdateTodo(n))})("addSubtaskEvent",function(n){a(e);let o=r(2);return d(o.onAddSubtask(n))})("toggleExpanded",function(n){a(e);let o=r(2);return d(o.onToggleExpanded(n))})("subtaskDrop",function(n){a(e);let o=r(2);return d(o.onSubtaskDrop(n))})("edit",function(){let n=a(e).$implicit,o=r(2);return d(o.openTaskEditorById(n.id))})("editSubtask",function(n){a(e);let o=r(2);return d(o.openTaskEditorById(n))})("focusToggle",function(n){a(e);let o=r(2);return d(o.onFocusToggle(n))})("duplicate",function(n){a(e);let o=r(2);return d(o.onDuplicateTodo(n))}),l()()()}if(u&2){let e=i.$implicit,t=i.index,n=r(2);h("dragging",n.draggingIndex()===t)("drag-over",n.dragOverIndex()===t&&n.draggingIndex()!==t),s(2),v(t+1),s(2),g("todo",e)("highlightedTaskId",(n.editingTodo==null?null:n.editingTodo.id)||null)("showFocusToggle",!0)("hideConversionButtons",!0)}}function ve(u,i){if(u&1&&(c(0,"div",40),x(1,me,5,9,"div",41),l()),u&2){let e=r();s(),g("ngForOf",e.focusService.todaysFocusTasks())}}function fe(u,i){if(u&1){let e=C();c(0,"button",37),T("click",function(){a(e);let n=r();return d(n.clearAllTodayTasks())}),_(1),l()}if(u&2){let e=r();g("title",e.translations().clearAllTodayTasks),s(),f(" ",e.translations().clearAll," ")}}function Te(u,i){if(u&1&&(c(0,"div",38)(1,"div",39),_(2,"\u{1F4CB}"),l(),c(3,"h3"),_(4),l(),c(5,"p"),_(6),l()()),u&2){let e=r();s(4),v(e.translations().noTasksForTodayYet),s(2),v(e.translations().selectTasksForToday)}}function xe(u,i){if(u&1){let e=C();c(0,"div",42),T("dragstart",function(n){let o=a(e).index,p=r(2);return d(p.onTodayTaskDragStart(o,n))})("dragenter",function(n){let o=a(e).index,p=r(2);return d(p.onTodayTaskDragEnter(o,n))})("dragover",function(n){let o=a(e).index,p=r(2);return d(p.onTodayTaskDragOver(o,n))})("dragleave",function(n){let o=a(e).index,p=r(2);return d(p.onTodayTaskDragLeave(o,n))})("drop",function(n){let o=a(e).index,p=r(2);return d(p.onTodayTaskDrop(o,n))})("dragend",function(){a(e);let n=r(2);return d(n.onTodayTaskDragEnd())}),c(1,"div",43),_(2),l(),c(3,"div",44)(4,"app-todo-item",46),T("toggle",function(n){a(e);let o=r(2);return d(o.onToggleTodo(n))})("delete",function(n){a(e);let o=r(2);return d(o.onDeleteTodo(n))})("archive",function(n){a(e);let o=r(2);return d(o.onArchiveTodo(n))})("unarchive",function(n){a(e);let o=r(2);return d(o.onUnarchiveTodo(n))})("update",function(n){a(e);let o=r(2);return d(o.onUpdateTodo(n))})("addSubtaskEvent",function(n){a(e);let o=r(2);return d(o.onAddSubtask(n))})("toggleExpanded",function(n){a(e);let o=r(2);return d(o.onToggleExpanded(n))})("subtaskDrop",function(n){a(e);let o=r(2);return d(o.onSubtaskDrop(n))})("edit",function(){let n=a(e).$implicit,o=r(2);return d(o.openTaskEditorById(n.id))})("editSubtask",function(n){a(e);let o=r(2);return d(o.openTaskEditorById(n))})("focusToggle",function(n){a(e);let o=r(2);return d(o.onFocusToggle(n))})("todayTaskToggle",function(n){a(e);let o=r(2);return d(o.onTodayTaskToggle(n))})("duplicate",function(n){a(e);let o=r(2);return d(o.onDuplicateTodo(n))}),l()()()}if(u&2){let e=i.$implicit,t=i.index,n=r(2);h("dragging",n.draggingTodayTaskIndex()===t)("drag-over",n.dragOverTodayTaskIndex()===t&&n.draggingTodayTaskIndex()!==t),s(2),v(t+1),s(2),g("todo",e)("highlightedTaskId",(n.editingTodo==null?null:n.editingTodo.id)||null)("showFocusToggle",!0)("hideConversionButtons",!0)}}function he(u,i){if(u&1&&(c(0,"div",40),x(1,xe,5,9,"div",41),l()),u&2){let e=r();s(),g("ngForOf",e.focusService.todaysTasks())}}function ke(u,i){if(u&1&&(c(0,"option",47),_(1),l()),u&2){let e=i.$implicit;g("value",e.id),s(),f(" ",e.name," ")}}function be(u,i){if(u&1&&(c(0,"p"),_(1),l()),u&2){let e=r(2);s(),v(e.translations().tryAdjustingFilters)}}function Ce(u,i){if(u&1&&(c(0,"p"),_(1),l()),u&2){let e=r(2);s(),v(e.translations().allTasksInFocusOrCompleted)}}function ye(u,i){if(u&1&&(c(0,"div",38)(1,"div",39),_(2,"\u2705"),l(),c(3,"h3"),_(4),l(),x(5,be,2,1,"p",48)(6,Ce,2,1,"p",48),l()),u&2){let e=r();s(4),v(e.translations().noAvailableTasks),s(),g("ngIf",e.searchQuery||e.selectedProject),s(),g("ngIf",!e.searchQuery&&!e.selectedProject)}}function Se(u,i){if(u&1){let e=C();c(0,"div",55),T("click",function(){a(e);let n=r().$implicit,o=r(2);return d(o.toggleProjectExpansion(n.projectId))}),c(1,"button",56),F(),c(2,"svg",12),S(3,"path",13),l()(),E(),c(4,"span",57),_(5),l(),c(6,"h3",58),_(7),l(),c(8,"span",15),_(9),l()()}if(u&2){let e=r().$implicit,t=r(2);h("expanded",t.isProjectExpanded(e.projectId)),s(),h("expanded",t.isProjectExpanded(e.projectId)),I("aria-expanded",t.isProjectExpanded(e.projectId))("aria-controls","project-tasks-"+e.projectId),s(3),V("color",e.projectColor),s(),f(" ",e.projectIcon," "),s(2),v(e.projectName),s(2),f("(",e.taskCount,")")}}function we(u,i){if(u&1){let e=C();c(0,"div",59)(1,"app-todo-item",46),T("toggle",function(n){a(e);let o=r(3);return d(o.onToggleTodo(n))})("delete",function(n){a(e);let o=r(3);return d(o.onDeleteTodo(n))})("archive",function(n){a(e);let o=r(3);return d(o.onArchiveTodo(n))})("unarchive",function(n){a(e);let o=r(3);return d(o.onUnarchiveTodo(n))})("update",function(n){a(e);let o=r(3);return d(o.onUpdateTodo(n))})("addSubtaskEvent",function(n){a(e);let o=r(3);return d(o.onAddSubtask(n))})("toggleExpanded",function(n){a(e);let o=r(3);return d(o.onToggleExpanded(n))})("subtaskDrop",function(n){a(e);let o=r(3);return d(o.onSubtaskDrop(n))})("edit",function(){a(e);let n=r().$implicit,o=r(2);return d(o.openTaskEditorById(n.task.id))})("editSubtask",function(n){a(e);let o=r(3);return d(o.openTaskEditorById(n))})("focusToggle",function(n){a(e);let o=r(3);return d(o.onFocusToggle(n))})("todayTaskToggle",function(n){a(e);let o=r(3);return d(o.onTodayTaskToggle(n))})("duplicate",function(n){a(e);let o=r(3);return d(o.onDuplicateTodo(n))}),l()()}if(u&2){let e=r().$implicit,t=r(2);s(),g("todo",e.task)("highlightedTaskId",(t.editingTodo==null?null:t.editingTodo.id)||null)("showFocusToggle",!0)("hideConversionButtons",!0)}}function Pe(u,i){if(u&1&&(c(0,"div",52),x(1,Se,10,11,"div",53)(2,we,2,4,"div",54),l()),u&2){let e=i.$implicit;s(),g("ngIf",e.type==="header"),s(),g("ngIf",e.type==="task")}}function Fe(u,i){if(u&1&&(c(0,"div",49)(1,"cdk-virtual-scroll-viewport",50),x(2,Pe,3,2,"div",51),l()()),u&2){let e=r();s(),V("height",400,"px"),s(),g("cdkVirtualForOf",e.virtualScrollItems())}}var ce=class u{focusService=y(oe);todoService=y(ne);projectService=y(Z);confirmationService=y(te);translationService=y(ee);taskEditor;translations=A(()=>({todaysFocus:this.translationService.translate("focus.todaysFocus"),planAndTrackTasks:this.translationService.translate("focus.planAndTrackTasks"),completed:this.translationService.translate("focus.completed"),remaining:this.translationService.translate("focus.remaining"),estimated:this.translationService.translate("focus.estimated"),complete:this.translationService.translate("focus.complete"),focusTasks:this.translationService.translate("focus.focusTasks"),clearAll:this.translationService.translate("focus.clearAll"),clearAllFocusTasks:this.translationService.translate("focus.clearAllFocusTasks"),collapseFocusTasks:this.translationService.translate("focus.collapseFocusTasks"),expandFocusTasks:this.translationService.translate("focus.expandFocusTasks"),noFocusTasksYet:this.translationService.translate("focus.noFocusTasksYet"),selectTasksFromAvailable:this.translationService.translate("focus.selectTasksFromAvailable"),todaysTasks:this.translationService.translate("focus.todaysTasks"),clearAllTodayTasks:this.translationService.translate("focus.clearAllTodayTasks"),collapseTodayTasks:this.translationService.translate("focus.collapseTodayTasks"),expandTodayTasks:this.translationService.translate("focus.expandTodayTasks"),noTasksForTodayYet:this.translationService.translate("focus.noTasksForTodayYet"),selectTasksForToday:this.translationService.translate("focus.selectTasksForToday"),availableTasks:this.translationService.translate("focus.availableTasks"),collapseAvailableTasks:this.translationService.translate("focus.collapseAvailableTasks"),expandAvailableTasks:this.translationService.translate("focus.expandAvailableTasks"),searchTasks:this.translationService.translate("focus.searchTasks"),noAvailableTasks:this.translationService.translate("focus.noAvailableTasks"),tryAdjustingFilters:this.translationService.translate("focus.tryAdjustingFilters"),allTasksInFocusOrCompleted:this.translationService.translate("focus.allTasksInFocusOrCompleted"),allProjects:this.translationService.translate("common.allProjects"),noProject:this.translationService.translate("common.noProject"),unknownProject:this.translationService.translate("common.unknownProject"),clearAllFocusConfirm:this.translationService.translate("focus.clearAllFocusConfirm"),clearAllTodayTasksConfirm:this.translationService.translate("focus.clearAllTodayTasksConfirm"),deleteTaskConfirm:this.translationService.translate("searchPage.deleteTaskConfirm"),deleteTaskSubtext:this.translationService.translate("searchPage.deleteTaskSubtext"),deleteAction:this.translationService.translate("actions.delete"),cancelAction:this.translationService.translate("actions.cancel")}));editingTodo=null;searchQuery="";selectedProject="";expandedProjects=b(new Set);hasUserInteracted=!1;focusPanelExpanded=b(!0);availableTasksPanelExpanded=b(!0);todayTasksPanelExpanded=b(!0);draggingIndex=b(null);dragOverIndex=b(null);draggingTodayTaskIndex=b(null);dragOverTodayTaskIndex=b(null);timeEstimate=()=>this.focusService.getFocusTimeEstimate();filteredAvailableTasks=()=>{let i=this.focusService.availableTasks(),e=new Set(this.getAllTaskIds(this.focusService.todaysFocusTasks())),t=new Set(this.getAllTaskIds(this.focusService.todaysTasks())),n=new Set([...e,...t]),o=this.processTasksWithSmartSubtaskFiltering(i,n),p=o;if(this.searchQuery){let k=this.searchQuery.toLowerCase();p=this.filterTasksRecursively(o,O=>O.title.toLowerCase().includes(k)||(O.description?.toLowerCase().includes(k)??!1)||(O.category?.toLowerCase().includes(k)??!1))}return this.selectedProject&&(p=p.filter(k=>k.projectId===this.selectedProject)),p};virtualScrollItems=A(()=>{let i=this.filteredAvailableTasks();if(this.selectedProject)return i.map(o=>({type:"task",task:o,projectId:this.selectedProject}));let e=new Map;for(let o of i){let p=o.projectId||"no-project";e.has(p)||e.set(p,[]),e.get(p).push(o)}let t=[],n=Array.from(e.entries()).sort(([o],[p])=>o==="no-project"?1:p==="no-project"?-1:this.getProjectName(o).localeCompare(this.getProjectName(p)));for(let[o,p]of n)if(t.push({type:"header",projectId:o,projectName:o==="no-project"?this.translations().noProject:this.getProjectName(o),projectIcon:this.getProjectIcon(o),projectColor:this.getProjectColor(o),taskCount:p.length}),this.isProjectExpanded(o))for(let k of p)t.push({type:"task",task:k,projectId:o});return t});groupedAvailableTasks=()=>{let i=this.filteredAvailableTasks();if(this.selectedProject)return[{projectId:this.selectedProject,projectName:this.getProjectName(this.selectedProject),tasks:i}];let e=new Map;for(let n of i){let o=n.projectId||"no-project",p=n.projectId?this.getProjectName(n.projectId):this.translations().noProject;e.has(o)||e.set(o,{projectId:o,projectName:p,tasks:[]}),e.get(o).tasks.push(n)}return Array.from(e.values()).sort((n,o)=>n.projectId==="no-project"?1:o.projectId==="no-project"?-1:n.projectName.localeCompare(o.projectName))};getAllTaskIds(i){let e=[];for(let t of i)e.push(t.id),t.subtasks.length>0&&e.push(...this.getAllTaskIds(t.subtasks));return e}processTasksWithSmartSubtaskFiltering(i,e){let t=[];for(let n of i)if(!e.has(n.id))if(n.completed){let o=this.getOrphanedSubtasks(n.subtasks,e);t.push(...o)}else{let o=this.filterSubtasksRecursively(n.subtasks,e),p=P(w({},n),{subtasks:o});t.push(p)}return t}getOrphanedSubtasks(i,e){let t=[];for(let n of i)if(!e.has(n.id))if(n.completed)n.subtasks.length>0&&t.push(...this.getOrphanedSubtasks(n.subtasks,e));else{let o=this.filterSubtasksRecursively(n.subtasks,e),p=P(w({},n),{subtasks:o});t.push(p)}return t}filterSubtasksRecursively(i,e){let t=[];for(let n of i){if(e.has(n.id)||n.completed)continue;let o=this.filterSubtasksRecursively(n.subtasks,e),p=P(w({},n),{subtasks:o});t.push(p)}return t}filterTasksRecursively(i,e){let t=[];for(let n of i){let o=e(n),p=this.filterTasksRecursively(n.subtasks,e);if(o||p.length>0){let k=P(w({},n),{subtasks:p});t.push(k)}}return t}getProjectName(i){return this.projectService.activeProjects().find(t=>t.id===i)?.name||this.translations().unknownProject}getProjectIcon(i){return i==="no-project"?"\u{1F4CB}":this.projectService.activeProjects().find(t=>t.id===i)?.icon||"\u{1F4CB}"}getProjectColor(i){return i==="no-project"?"#6b7280":this.projectService.activeProjects().find(t=>t.id===i)?.color||"#6b7280"}addFocus(i){return m(this,null,function*(){yield this.focusService.addToTodaysFocus(i)})}removeFocus(i){return m(this,null,function*(){yield this.focusService.removeFromTodaysFocus(i)})}onFocusToggle(i){return m(this,null,function*(){console.log("FocusComponent: Received focusToggle event for task:",i);let e=window.pageYOffset||document.documentElement.scrollTop;try{yield this.focusService.toggleTodaysFocus(i),console.log("FocusComponent: Successfully toggled focus for task:",i)}catch(t){console.error("FocusComponent: Error toggling focus for task:",i,t)}setTimeout(()=>{window.scrollTo(0,e)},0)})}onTodayTaskToggle(i){return m(this,null,function*(){console.log("FocusComponent: Received todayTaskToggle event for task:",i);let e=window.pageYOffset||document.documentElement.scrollTop;try{yield this.focusService.toggleTodaysTasks(i),console.log("FocusComponent: Successfully toggled today task for task:",i)}catch(t){console.error("FocusComponent: Error toggling today task for task:",i,t)}setTimeout(()=>{window.scrollTo(0,e)},0)})}clearAllFocus(){return m(this,null,function*(){confirm(this.translations().clearAllFocusConfirm)&&(yield this.focusService.clearTodaysFocus())})}clearAllTodayTasks(){return m(this,null,function*(){confirm(this.translations().clearAllTodayTasksConfirm)&&(yield this.focusService.clearTodaysTasks())})}updateSearch(i){let e=i.target;this.searchQuery=e.value}updateProjectFilter(){}toggleFocusPanelExpansion(){this.focusPanelExpanded.set(!this.focusPanelExpanded())}toggleAvailableTasksPanelExpansion(){this.availableTasksPanelExpanded.set(!this.availableTasksPanelExpanded())}toggleTodayTasksPanelExpansion(){this.todayTasksPanelExpanded.set(!this.todayTasksPanelExpanded())}toggleProjectExpansion(i){let e=this.expandedProjects(),t=new Set(e);if(e.size===0&&!this.hasUserInteracted){let n=this.groupedAvailableTasks().map(o=>o.projectId);t=new Set(n)}this.hasUserInteracted=!0,t.has(i)?t.delete(i):t.add(i),this.expandedProjects.set(t)}isProjectExpanded(i){let e=this.expandedProjects();return e.size===0&&!this.hasUserInteracted?!0:e.has(i)}onFocusTaskDragStart(i,e){this.draggingIndex.set(i),this.dragOverIndex.set(i);try{e.dataTransfer?.setData("text/plain",String(i)),e.dataTransfer?.setDragImage(new Image,0,0),e.dataTransfer.effectAllowed="move"}catch{}}onFocusTaskDragEnter(i,e){e.preventDefault(),this.draggingIndex()!==null&&this.draggingIndex()!==i&&this.dragOverIndex.set(i)}onFocusTaskDragOver(i,e){e.preventDefault(),this.draggingIndex()!==null&&(e.dataTransfer.dropEffect="move",this.dragOverIndex.set(i))}onFocusTaskDragLeave(i,e){e.preventDefault(),this.dragOverIndex()===i&&this.dragOverIndex.set(null)}onFocusTaskDrop(i,e){return m(this,null,function*(){e.preventDefault();let t=this.draggingIndex();t===null||t===i||(yield this.focusService.reorderFocusTasks(t,i),this.draggingIndex.set(null),this.dragOverIndex.set(null))})}onFocusTaskDragEnd(){this.draggingIndex.set(null),this.dragOverIndex.set(null)}onTodayTaskDragStart(i,e){this.draggingTodayTaskIndex.set(i),this.dragOverTodayTaskIndex.set(i);try{e.dataTransfer?.setData("text/plain",String(i)),e.dataTransfer?.setDragImage(new Image,0,0),e.dataTransfer.effectAllowed="move"}catch{}}onTodayTaskDragEnter(i,e){e.preventDefault(),this.draggingTodayTaskIndex()!==null&&this.draggingTodayTaskIndex()!==i&&this.dragOverTodayTaskIndex.set(i)}onTodayTaskDragOver(i,e){e.preventDefault(),this.draggingTodayTaskIndex()!==null&&(e.dataTransfer.dropEffect="move",this.dragOverTodayTaskIndex.set(i))}onTodayTaskDragLeave(i,e){e.preventDefault(),this.dragOverTodayTaskIndex()===i&&this.dragOverTodayTaskIndex.set(null)}onTodayTaskDrop(i,e){return m(this,null,function*(){e.preventDefault();let t=this.draggingTodayTaskIndex();t===null||t===i||(yield this.focusService.reorderTodaysTasks(t,i),this.draggingTodayTaskIndex.set(null),this.dragOverTodayTaskIndex.set(null))})}onTodayTaskDragEnd(){this.draggingTodayTaskIndex.set(null),this.dragOverTodayTaskIndex.set(null)}onToggleTodo(i){return m(this,null,function*(){yield this.todoService.toggleTodo(i)})}onDeleteTodo(i){return m(this,null,function*(){let e=this.findTodoById(i);if(!e)return;(yield this.confirmationService.open(this.translations().deleteTaskConfirm,`${this.translations().deleteTaskConfirm} "${e.title}"? ${this.translations().deleteTaskSubtext}`,this.translations().deleteAction,this.translations().cancelAction,!1))==="confirm"&&(yield this.todoService.deleteTodo(i))})}onDuplicateTodo(i){return m(this,null,function*(){try{yield this.todoService.duplicateTodo(i)}catch(e){console.error("Failed to duplicate todo:",e)}})}onArchiveTodo(i){return m(this,null,function*(){this.todoService.archiveTodo(i)})}onUnarchiveTodo(i){return m(this,null,function*(){this.todoService.unarchiveTodo(i)})}onUpdateTodo(i){return m(this,null,function*(){yield this.todoService.updateTodo(i.id,i.updates)})}onAddSubtask(i){return m(this,null,function*(){this.todoService.addSubtask(i.parentId,i.subtaskData)})}onToggleExpanded(i){this.todoService.toggleExpanded(i)}onSubtaskDrop(i){return m(this,null,function*(){console.log("Subtask drop not implemented yet:",i)})}openTaskEditorById(i){let e=this.todoService.getTodoById(i);e&&(this.editingTodo=e,this.taskEditor.open())}onSaveTask(i){return m(this,null,function*(){this.editingTodo&&(yield this.todoService.updateTodo(this.editingTodo.id,i),this.editingTodo=null,this.taskEditor.onClose())})}onCancelEdit(){this.editingTodo=null}findTodoById(i){let e=this.focusService.todaysFocusTasks(),t=this.findTodoByIdRecursive(e,i);if(t)return t;let n=this.focusService.availableTasks();return this.findTodoByIdRecursive(n,i)}findTodoByIdRecursive(i,e){for(let t of i){if(t.id===e)return t;if(t.subtasks.length>0){let n=this.findTodoByIdRecursive(t.subtasks,e);if(n)return n}}}formatTime(i){if(i<60)return`${i}m`;let e=Math.floor(i/60),t=i%60;return t>0?`${e}h ${t}m`:`${e}h`}static \u0275fac=function(e){return new(e||u)};static \u0275cmp=N({type:u,selectors:[["app-focus"]],viewQuery:function(e,t){if(e&1&&z(le,5),e&2){let n;B(n=L())&&(t.taskEditor=n.first)}},decls:68,vars:44,consts:[["taskEditor",""],[1,"focus-container"],[1,"focus-header"],[1,"header-content"],[1,"focus-icon"],[1,"focus-subtitle"],["class","focus-progress",4,"ngIf"],[1,"focus-content"],[1,"focus-section"],[1,"section-header"],[1,"section-title"],[1,"expand-toggle",3,"click","title"],["width","16","height","16","viewBox","0 0 20 20","fill","currentColor",1,"chevron"],["fill-rule","evenodd","d","M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707A1 1 0 118.707 5.293l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule","evenodd"],[1,"section-icon"],[1,"task-count"],[1,"section-actions"],["class","btn btn-secondary btn-sm",3,"title","click",4,"ngIf"],["id","focus-tasks-content"],["class","empty-state",4,"ngIf"],["class","focus-tasks-list",4,"ngIf"],["id","today-tasks-content"],[1,"available-section"],["type","text",1,"search-input",3,"ngModelChange","input","placeholder","ngModel"],[1,"filter-select",3,"ngModelChange","change","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["id","available-tasks-content"],["class","available-tasks-virtual-container",4,"ngIf"],[3,"save","cancel","todo"],[1,"focus-progress"],[1,"progress-stats"],[1,"stat"],["class","stat",4,"ngIf"],[1,"progress-bar"],[1,"progress-fill"],[1,"progress-text"],[1,"btn","btn-secondary","btn-sm",3,"click","title"],[1,"empty-state"],[1,"empty-icon"],[1,"focus-tasks-list"],["class","focus-task-item","draggable","true",3,"dragging","drag-over","dragstart","dragenter","dragover","dragleave","drop","dragend",4,"ngFor","ngForOf"],["draggable","true",1,"focus-task-item",3,"dragstart","dragenter","dragover","dragleave","drop","dragend"],[1,"task-order"],[1,"task-content"],[3,"toggle","delete","archive","unarchive","update","addSubtaskEvent","toggleExpanded","subtaskDrop","edit","editSubtask","focusToggle","duplicate","todo","highlightedTaskId","showFocusToggle","hideConversionButtons"],[3,"toggle","delete","archive","unarchive","update","addSubtaskEvent","toggleExpanded","subtaskDrop","edit","editSubtask","focusToggle","todayTaskToggle","duplicate","todo","highlightedTaskId","showFocusToggle","hideConversionButtons"],[3,"value"],[4,"ngIf"],[1,"available-tasks-virtual-container"],["itemSize","80",1,"virtual-scroll-viewport"],["class","virtual-scroll-item",4,"cdkVirtualFor","cdkVirtualForOf"],[1,"virtual-scroll-item"],["class","project-header virtual-project-header",3,"expanded","click",4,"ngIf"],["class","virtual-task-item",4,"ngIf"],[1,"project-header","virtual-project-header",3,"click"],[1,"expand-toggle"],[1,"project-icon"],[1,"project-name"],[1,"virtual-task-item"]],template:function(e,t){if(e&1){let n=C();c(0,"div",1)(1,"div",2)(2,"div",3)(3,"h1")(4,"span",4),_(5,"\u{1F3AF}"),l(),_(6),l(),c(7,"p",5),_(8),l()(),x(9,ue,15,9,"div",6),l(),c(10,"div",7)(11,"div",8)(12,"div",9)(13,"div",10)(14,"button",11),T("click",function(){return a(n),d(t.toggleFocusPanelExpansion())}),F(),c(15,"svg",12),S(16,"path",13),l()(),E(),c(17,"h2")(18,"span",14),_(19,"\u2B50"),l(),_(20),c(21,"span",15),_(22),l()()(),c(23,"div",16),x(24,_e,2,2,"button",17),l()(),c(25,"div",18),x(26,ge,7,2,"div",19)(27,ve,2,1,"div",20),l()(),c(28,"div",8)(29,"div",9)(30,"div",10)(31,"button",11),T("click",function(){return a(n),d(t.toggleTodayTasksPanelExpansion())}),F(),c(32,"svg",12),S(33,"path",13),l()(),E(),c(34,"h2")(35,"span",14),_(36,"\u{1F4CB}"),l(),_(37),c(38,"span",15),_(39),l()()(),c(40,"div",16),x(41,fe,2,2,"button",17),l()(),c(42,"div",21),x(43,Te,7,2,"div",19)(44,he,2,1,"div",20),l()(),c(45,"div",22)(46,"div",9)(47,"div",10)(48,"button",11),T("click",function(){return a(n),d(t.toggleAvailableTasksPanelExpansion())}),F(),c(49,"svg",12),S(50,"path",13),l()(),E(),c(51,"h2")(52,"span",14),_(53,"\u{1F4CB}"),l(),_(54),c(55,"span",15),_(56),l()()(),c(57,"div",16)(58,"input",23),D("ngModelChange",function(p){return a(n),j(t.searchQuery,p)||(t.searchQuery=p),d(p)}),T("input",function(p){return a(n),d(t.updateSearch(p))}),l(),c(59,"select",24),D("ngModelChange",function(p){return a(n),j(t.selectedProject,p)||(t.selectedProject=p),d(p)}),T("change",function(){return a(n),d(t.updateProjectFilter())}),c(60,"option",25),_(61),l(),x(62,ke,2,2,"option",26),l()()(),c(63,"div",27),x(64,ye,7,3,"div",19)(65,Fe,3,3,"div",28),l()()(),c(66,"app-task-editor",29,0),T("save",function(p){return a(n),d(t.onSaveTask(p))})("cancel",function(){return a(n),d(t.onCancelEdit())}),l()()}e&2&&(s(6),f(" ",t.translations().todaysFocus," "),s(2),v(t.translations().planAndTrackTasks),s(),g("ngIf",t.focusService.focusProgress().total>0),s(5),h("expanded",t.focusPanelExpanded()),g("title",t.focusPanelExpanded()?t.translations().collapseFocusTasks:t.translations().expandFocusTasks),I("aria-expanded",t.focusPanelExpanded())("aria-controls","focus-tasks-content"),s(6),f(" ",t.translations().focusTasks," "),s(2),f("(",t.focusService.todaysFocusTasks().length,")"),s(2),g("ngIf",t.focusService.todaysFocusTasks().length>0),s(),h("collapsed",!t.focusPanelExpanded()),s(),g("ngIf",t.focusService.todaysFocusTasks().length===0),s(),g("ngIf",t.focusService.todaysFocusTasks().length>0),s(4),h("expanded",t.todayTasksPanelExpanded()),g("title",t.todayTasksPanelExpanded()?t.translations().collapseTodayTasks:t.translations().expandTodayTasks),I("aria-expanded",t.todayTasksPanelExpanded())("aria-controls","today-tasks-content"),s(6),f(" ",t.translations().todaysTasks," "),s(2),f("(",t.focusService.todaysTasks().length,")"),s(2),g("ngIf",t.focusService.todaysTasks().length>0),s(),h("collapsed",!t.todayTasksPanelExpanded()),s(),g("ngIf",t.focusService.todaysTasks().length===0),s(),g("ngIf",t.focusService.todaysTasks().length>0),s(4),h("expanded",t.availableTasksPanelExpanded()),g("title",t.availableTasksPanelExpanded()?t.translations().collapseAvailableTasks:t.translations().expandAvailableTasks),I("aria-expanded",t.availableTasksPanelExpanded())("aria-controls","available-tasks-content"),s(6),f(" ",t.translations().availableTasks," "),s(2),f("(",t.filteredAvailableTasks().length,")"),s(2),g("placeholder",t.translations().searchTasks),M("ngModel",t.searchQuery),s(),M("ngModel",t.selectedProject),s(2),v(t.translations().allProjects),s(),g("ngForOf",t.projectService.activeProjects()),s(),h("collapsed",!t.availableTasksPanelExpanded()),s(),g("ngIf",t.virtualScrollItems().length===0),s(),g("ngIf",t.virtualScrollItems().length>0),s(),g("todo",t.editingTodo))},dependencies:[U,Q,$,W,X,J,K,Y,q,H,G,re,ie,se,de,ae],styles:[".focus-container[_ngcontent-%COMP%]{padding:2rem;max-width:1200px;margin:0 auto;min-height:100vh;overflow-anchor:none}.focus-header[_ngcontent-%COMP%]{margin-bottom:2rem;padding-bottom:1.5rem;border-bottom:1px solid #e5e7eb}.header-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;margin:0 0 .5rem;font-size:2.5rem;font-weight:700;color:#1f2937}.focus-icon[_ngcontent-%COMP%]{font-size:2.5rem}.focus-subtitle[_ngcontent-%COMP%]{margin:0;color:#6b7280;font-size:1.125rem}.focus-progress[_ngcontent-%COMP%]{margin-top:1.5rem;padding:1.5rem;background:linear-gradient(135deg,#f3f4f6,#e5e7eb);border-radius:12px;border:1px solid #d1d5db}.progress-stats[_ngcontent-%COMP%]{display:flex;gap:2rem;margin-bottom:1rem;flex-wrap:wrap}.stat[_ngcontent-%COMP%]{color:#374151;font-size:.875rem}.stat[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#1f2937;font-size:1.125rem}.progress-bar[_ngcontent-%COMP%]{width:100%;height:8px;background:#e5e7eb;border-radius:4px;overflow:hidden;margin-bottom:.5rem}.progress-fill[_ngcontent-%COMP%]{height:100%;background:linear-gradient(90deg,#10b981,#059669);border-radius:4px;transition:width .3s ease}.progress-text[_ngcontent-%COMP%]{font-size:.875rem;color:#6b7280;font-weight:500}.focus-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem}.focus-section[_ngcontent-%COMP%], .available-section[_ngcontent-%COMP%]{background:#fff;border-radius:12px;border:1px solid #e5e7eb;overflow:visible;position:relative}.section-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1.5rem;background:#f9fafb;border-bottom:1px solid #e5e7eb;position:sticky;top:0;z-index:10;border-radius:12px 12px 0 0}.focus-section[_ngcontent-%COMP%]:nth-of-type(1)   .section-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#dbeafe,#bfdbfe);border-bottom:1px solid #93c5fd}.focus-section[_ngcontent-%COMP%]:nth-of-type(1){border-color:#3b82f6;box-shadow:0 0 0 1px #3b82f61a}.focus-section[_ngcontent-%COMP%]:nth-of-type(2)   .section-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#dcfce7,#bbf7d0);border-bottom:1px solid #86efac}.focus-section[_ngcontent-%COMP%]:nth-of-type(2){border-color:#10b981;box-shadow:0 0 0 1px #10b9811a}.available-section[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f3e8ff,#e9d5ff);border-bottom:1px solid #c4b5fd}.available-section[_ngcontent-%COMP%]{border-color:#8b5cf6;box-shadow:0 0 0 1px #8b5cf61a}.section-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.section-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin:0;font-size:1.25rem;font-weight:600;color:#1f2937}.section-icon[_ngcontent-%COMP%]{font-size:1.25rem}.task-count[_ngcontent-%COMP%]{color:#6b7280;font-weight:400;font-size:1rem}.section-actions[_ngcontent-%COMP%]{display:flex;gap:.75rem;align-items:center}.search-input[_ngcontent-%COMP%]{padding:.5rem .75rem;border:1px solid #d1d5db;border-radius:6px;font-size:.875rem;width:200px}.search-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.filter-select[_ngcontent-%COMP%]{padding:.5rem .75rem;border:1px solid #d1d5db;border-radius:6px;font-size:.875rem;background:#fff;min-width:150px}.filter-select[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.btn[_ngcontent-%COMP%]{padding:.5rem 1rem;border:none;border-radius:6px;font-size:.875rem;font-weight:500;cursor:pointer;transition:all .2s ease;display:inline-flex;align-items:center;gap:.5rem}.btn-sm[_ngcontent-%COMP%]{padding:.375rem .75rem;font-size:.8125rem}.btn-secondary[_ngcontent-%COMP%]{background:#f3f4f6;color:#374151;border:1px solid #d1d5db}.btn-secondary[_ngcontent-%COMP%]:hover{background:#e5e7eb;border-color:#9ca3af}.expand-toggle[_ngcontent-%COMP%]{background:none;border:none;padding:.25rem;cursor:pointer;border-radius:4px;color:#6b7280;transition:all .2s ease;display:flex;align-items:center;justify-content:center}.expand-toggle[_ngcontent-%COMP%]:hover{background:#e5e7eb;color:#374151}.expand-toggle[_ngcontent-%COMP%]   .chevron[_ngcontent-%COMP%]{transition:transform .2s ease;transform:rotate(0)}.collapsed[_ngcontent-%COMP%]{display:none}.empty-state[_ngcontent-%COMP%]{padding:3rem 2rem;text-align:center;color:#6b7280}.empty-icon[_ngcontent-%COMP%]{font-size:3rem;margin-bottom:1rem}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 .5rem;color:#374151;font-size:1.25rem;font-weight:600}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.875rem}.focus-tasks-list[_ngcontent-%COMP%]{padding:1rem;overflow-anchor:none}.focus-task-item[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:1rem;padding:1rem;margin-bottom:.75rem;background:#f8fafc;border:1px solid #e2e8f0;border-radius:8px;cursor:move;transition:all .2s ease}.focus-task-item[_ngcontent-%COMP%]:hover{background:#f1f5f9;border-color:#cbd5e1}.focus-task-item.dragging[_ngcontent-%COMP%]{opacity:.5;transform:rotate(2deg)}.focus-task-item.drag-over[_ngcontent-%COMP%]{border-color:#3b82f6;background:#eff6ff}.task-order[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:2rem;height:2rem;background:#3b82f6;color:#fff;border-radius:50%;font-weight:600;font-size:.875rem;flex-shrink:0;margin-top:.25rem}.task-content[_ngcontent-%COMP%]{flex:1;min-width:0}.available-tasks-list[_ngcontent-%COMP%]{padding:1rem;overflow-anchor:none}.project-group[_ngcontent-%COMP%]{margin-bottom:1.5rem}.project-group[_ngcontent-%COMP%]:last-child{margin-bottom:0}.project-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.75rem 1rem;margin-bottom:.75rem;background:#f8fafc;border:1px solid #e2e8f0;border-radius:8px;font-weight:500;cursor:pointer;transition:all .2s ease;-webkit-user-select:none;user-select:none}.project-header[_ngcontent-%COMP%]:hover{background:#f1f5f9;border-color:#cbd5e1}.expand-toggle[_ngcontent-%COMP%]{background:none;border:none;color:#6b7280;cursor:pointer;padding:0;display:flex;align-items:center;justify-content:center;transition:transform .2s ease}.expand-toggle[_ngcontent-%COMP%]   .chevron[_ngcontent-%COMP%]{transition:transform .2s ease}.expand-toggle.expanded[_ngcontent-%COMP%]   .chevron[_ngcontent-%COMP%]{transform:rotate(90deg)}.project-icon[_ngcontent-%COMP%]{font-size:1.125rem}.project-name[_ngcontent-%COMP%]{margin:0;font-size:1rem;font-weight:600;color:#374151}.project-tasks[_ngcontent-%COMP%]{margin-left:.5rem;border-left:2px solid #f1f5f9;padding-left:1rem;transition:all .3s ease;overflow:visible}.project-tasks.collapsed[_ngcontent-%COMP%]{max-height:0;opacity:0;margin-bottom:0;padding-top:0;padding-bottom:0}@media (max-width: 768px){.focus-container[_ngcontent-%COMP%]{padding:1rem}.header-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], .focus-icon[_ngcontent-%COMP%]{font-size:2rem}.section-header[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch;gap:1rem}.section-actions[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.search-input[_ngcontent-%COMP%], .filter-select[_ngcontent-%COMP%]{width:100%}.progress-stats[_ngcontent-%COMP%]{gap:1rem}.focus-task-item[_ngcontent-%COMP%], .available-task-item[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch;gap:.75rem}.task-order[_ngcontent-%COMP%], .remove-focus-btn[_ngcontent-%COMP%], .add-focus-btn[_ngcontent-%COMP%]{align-self:flex-start}}.available-tasks-virtual-container[_ngcontent-%COMP%]{height:400px;border:1px solid var(--border-color, #e5e7eb);border-radius:8px;overflow:hidden;background:#fff}.virtual-scroll-viewport[_ngcontent-%COMP%]{height:100%!important;width:100%}.virtual-scroll-item[_ngcontent-%COMP%]{min-height:80px;border-bottom:1px solid var(--border-color, #f3f4f6);display:flex;flex-direction:column}.virtual-scroll-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.virtual-project-header[_ngcontent-%COMP%]{background:var(--background-secondary, #f9fafb);border-bottom:1px solid var(--border-color, #e5e7eb);padding:12px 16px;cursor:pointer;transition:background-color .2s ease;min-height:48px;display:flex;align-items:center;gap:8px;flex-shrink:0}.virtual-project-header[_ngcontent-%COMP%]:hover{background:var(--background-hover, #f3f4f6)}.virtual-task-item[_ngcontent-%COMP%]{padding:4px 8px;min-height:76px;flex:1;display:flex;align-items:center}.virtual-task-item[_ngcontent-%COMP%]   app-todo-item[_ngcontent-%COMP%]{display:block;width:100%}@media (max-width: 768px){.available-tasks-virtual-container[_ngcontent-%COMP%]{height:300px}}@media (min-width: 1200px){.available-tasks-virtual-container[_ngcontent-%COMP%]{height:500px}}"]})};export{ce as FocusComponent};
