import{C as f}from"./chunk-222UGSVR.js";import{Hb as d,R as u,W as n,c as a,ja as T}from"./chunk-7QHQU2NT.js";var l=class i{todoService=n(f);focusDateSignal=T(new Date);todaysFocusTasks=d(()=>{let s=this.todoService.todos();return this.flattenTodos(s).filter(e=>e.focusToday&&!e.archived).sort((e,t)=>(e.focusOrder||0)-(t.focusOrder||0))});availableTasks=d(()=>this.todoService.todos().filter(o=>!o.archived));focusProgress=d(()=>{let s=this.todaysFocusTasks(),o=s.filter(c=>c.completed),e=s.filter(c=>!c.completed),t=s.length,r=o.length;return{total:t,completed:r,remaining:e.length,percentage:t>0?Math.round(r/t*100):0}});addToTodaysFocus(s){return a(this,null,function*(){let o=this.todaysFocusTasks(),e=Math.max(0,...o.map(t=>t.focusOrder||0));yield this.todoService.updateTodo(s,{focusToday:!0,focusOrder:e+1})})}removeFromTodaysFocus(s){return a(this,null,function*(){yield this.todoService.updateTodo(s,{focusToday:!1,focusOrder:void 0})})}toggleTodaysFocus(s){return a(this,null,function*(){let o=this.todoService.getTodoById(s);o&&(o.focusToday?yield this.removeFromTodaysFocus(s):yield this.addToTodaysFocus(s))})}reorderFocusTasks(s,o){return a(this,null,function*(){let e=this.todaysFocusTasks();if(s<0||s>=e.length||o<0||o>=e.length)return;let t=[...e],[r]=t.splice(s,1);t.splice(o,0,r);let c=t.map((m,v)=>this.todoService.updateTodo(m.id,{focusOrder:v+1}));yield Promise.all(c)})}clearTodaysFocus(){return a(this,null,function*(){let o=this.todaysFocusTasks().map(e=>this.todoService.updateTodo(e.id,{focusToday:!1,focusOrder:void 0}));yield Promise.all(o)})}getFocusTimeEstimate(){return this.todaysFocusTasks().reduce((o,e)=>o+(e.duration||0),0)}flattenTodos(s){let o=[];for(let e of s)o.push(e),e.subtasks&&e.subtasks.length>0&&o.push(...this.flattenTodos(e.subtasks));return o}get focusDate(){return this.focusDateSignal()}setFocusDate(s){this.focusDateSignal.set(s)}static \u0275fac=function(o){return new(o||i)};static \u0275prov=u({token:i,factory:i.\u0275fac,providedIn:"root"})};export{l as a};
